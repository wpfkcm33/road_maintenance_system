# í”„ë¡œì íŠ¸ ì½”ë“œ ìˆ˜ì§‘ ê²°ê³¼

**í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬:** .
**ìˆ˜ì§‘ëœ íŒŒì¼ ìˆ˜:** 81
**ìƒì„± ì¼ì‹œ:** 2025. 07. 27. (ì¼) 17:55:50 KST

## ğŸ“‹ íŒŒì¼ ëª©ë¡

1. **index.tsx** - `frontend/src/index.tsx` (404 chars)
2. **App.tsx** - `frontend/src/App.tsx` (3,362 chars)
3. **main.py** - `backend/app/main.py` (5,474 chars)
4. **docker-compose.yml** - `docker-compose.yml` (787 chars)
5. **package.json** - `frontend/package.json` (1,533 chars)
6. **videoService.ts** - `frontend/src/services/videoService.ts` (1,355 chars)
7. **markerService.ts** - `frontend/src/services/markerService.ts` (1,186 chars)
8. **dashboardService.ts** - `frontend/src/services/dashboardService.ts` (739 chars)
9. **api.ts** - `frontend/src/services/api.ts` (807 chars)
10. **analysisService.ts** - `frontend/src/services/analysisService.ts` (674 chars)
11. **marker_service.py** - `backend/app/services/marker_service.py` (7,814 chars)
12. **ai_service.py** - `backend/app/services/ai_service.py` (6,530 chars)
13. **__init__.py** - `backend/app/services/__init__.py` (210 chars)
14. **video_service.py** - `backend/app/services/video_service.py` (2,275 chars)
15. **debug.py** - `backend/app/api/debug.py` (3,110 chars)
16. **markers.py** - `backend/app/api/markers.py` (10,740 chars)
17. **analysis.py** - `backend/app/api/analysis.py` (10,471 chars)
18. **dashboard.py** - `backend/app/api/dashboard.py` (2,692 chars)
19. **__init__.py** - `backend/app/api/__init__.py` (32 chars)
20. **videos.py** - `backend/app/api/videos.py` (23,145 chars)
21. **code_collector.py** - `code_collector.py` (6,472 chars)
22. **postcss.config.js** - `frontend/postcss.config.js` (82 chars)
23. **tailwind.config.js** - `frontend/tailwind.config.js` (1,356 chars)
24. **setupTests.ts** - `frontend/src/setupTests.ts` (241 chars)
25. **react-app-env.d.ts** - `frontend/src/react-app-env.d.ts` (40 chars)
26. **reportWebVitals.ts** - `frontend/src/reportWebVitals.ts` (388 chars)
27. **App.test.tsx** - `frontend/src/App.test.tsx` (241 chars)
28. **helpers.ts** - `frontend/src/utils/helpers.ts` (3,530 chars)
29. **constants.ts** - `frontend/src/utils/constants.ts` (1,483 chars)
30. **analysis.ts** - `frontend/src/types/analysis.ts` (1,194 chars)
31. **dashboard.ts** - `frontend/src/types/dashboard.ts` (427 chars)
32. **naver-maps.d.ts** - `frontend/src/types/naver-maps.d.ts` (4,882 chars)
33. **video.ts** - `frontend/src/types/video.ts` (468 chars)
34. **marker.ts** - `frontend/src/types/marker.ts` (1,232 chars)
35. **VideoComparisonPlayer.tsx** - `frontend/src/components/video/VideoComparisonPlayer.tsx` (13,640 chars)
36. **AIAnalysisResult.tsx** - `frontend/src/components/video/AIAnalysisResult.tsx` (10,248 chars)
37. **VideoPlayer.tsx** - `frontend/src/components/video/VideoPlayer.tsx` (1,277 chars)
38. **VideoUpload.tsx** - `frontend/src/components/video/VideoUpload.tsx` (2,538 chars)
39. **Dashboard.tsx** - `frontend/src/components/dashboard/Dashboard.tsx` (307 chars)
40. **ActivityList.tsx** - `frontend/src/components/dashboard/ActivityList.tsx` (3,081 chars)
41. **StatCard.tsx** - `frontend/src/components/dashboard/StatCard.tsx` (2,531 chars)
42. **NaverMap.tsx** - `frontend/src/components/map/NaverMap.tsx` (18,440 chars)
43. **MarkerPopup.tsx** - `frontend/src/components/map/MarkerPopup.tsx` (883 chars)
44. **MarkerAddPopup.tsx** - `frontend/src/components/map/MarkerAddPopup.tsx` (16,309 chars)
45. **Modal.tsx** - `frontend/src/components/common/Modal.tsx` (2,214 chars)
46. **Sidebar.tsx** - `frontend/src/components/common/Sidebar.tsx` (2,736 chars)
47. **Header.tsx** - `frontend/src/components/common/Header.tsx` (2,066 chars)
48. **LoadingSpinner.tsx** - `frontend/src/components/common/LoadingSpinner.tsx` (706 chars)
49. **MarkerList.tsx** - `frontend/src/components/markers/MarkerList.tsx` (2,035 chars)
50. **MarkerDetail.tsx** - `frontend/src/components/markers/MarkerDetail.tsx` (10,557 chars)
51. **MarkerForm.tsx** - `frontend/src/components/markers/MarkerForm.tsx` (3,384 chars)
52. **useVideo.ts** - `frontend/src/hooks/useVideo.ts` (1,738 chars)
53. **useMarkers.ts** - `frontend/src/hooks/useMarkers.ts` (2,853 chars)
54. **useAIAnalysis.ts** - `frontend/src/hooks/useAIAnalysis.ts` (2,146 chars)
55. **AnalyticsPage.tsx** - `frontend/src/pages/AnalyticsPage.tsx` (728 chars)
56. **MarkersPage.tsx** - `frontend/src/pages/MarkersPage.tsx` (19,525 chars)
57. **SettingsPage.tsx** - `frontend/src/pages/SettingsPage.tsx` (719 chars)
58. **DashboardPage.tsx** - `frontend/src/pages/DashboardPage.tsx` (15,055 chars)
59. **__init__.py** - `backend/app/__init__.py` (0 chars)
60. **config.py** - `backend/app/core/config.py` (1,274 chars)
61. **__init__.py** - `backend/app/core/__init__.py` (0 chars)
62. **database.py** - `backend/app/core/database.py` (699 chars)
63. **__init__.py** - `backend/app/utils/__init__.py` (0 chars)
64. **video_utils.py** - `backend/app/utils/video_utils.py` (9,642 chars)
65. **file_utils.py** - `backend/app/utils/file_utils.py` (1,453 chars)
66. **model_loader.py** - `backend/app/ai_model/model_loader.py` (2,249 chars)
67. **__init__.py** - `backend/app/ai_model/__init__.py` (1,298 chars)
68. **inference.py** - `backend/app/ai_model/inference.py` (13,846 chars)
69. **analysis.py** - `backend/app/models/analysis.py` (1,690 chars)
70. **video.py** - `backend/app/models/video.py` (1,098 chars)
71. **marker.py** - `backend/app/models/marker.py` (1,738 chars)
72. **__init__.py** - `backend/app/models/__init__.py` (335 chars)
73. **analysis.py** - `backend/app/schemas/analysis.py` (2,121 chars)
74. **video.py** - `backend/app/schemas/video.py` (788 chars)
75. **marker.py** - `backend/app/schemas/marker.py` (2,031 chars)
76. **__init__.py** - `backend/app/schemas/__init__.py` (345 chars)
77. **tsconfig.json** - `frontend/tsconfig.json` (627 chars)
78. **sample_data.sql** - `database/sample_data.sql` (0 chars)
79. **init.sql** - `database/init.sql` (0 chars)
80. **README.md** - `README.md` (865 chars)
81. **README.md** - `frontend/README.md` (2,103 chars)

---

## ğŸ“ íŒŒì¼ ìƒì„¸ ë‚´ìš©

### 1. index.tsx

- **ê²½ë¡œ:** `frontend/src/index.tsx`
- **í¬ê¸°:** 404 characters
- **íƒ€ì…:** .tsx

```tsx
// frontend/src/index.tsx
import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';
import App from './App';
import reportWebVitals from './reportWebVitals';

const root = ReactDOM.createRoot(
  document.getElementById('root') as HTMLElement
);

root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);

// Performance measuring (optional)
reportWebVitals();
```

---

### 2. App.tsx

- **ê²½ë¡œ:** `frontend/src/App.tsx`
- **í¬ê¸°:** 3,362 characters
- **íƒ€ì…:** .tsx

```tsx
// frontend/src/App.tsx
import React, { useState } from 'react';
import { BrowserRouter as Router, Routes, Route } from 'react-router-dom';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { Toaster } from 'react-hot-toast';

// Components
import Header from './components/common/Header';
import Sidebar from './components/common/Sidebar';

// Pages
import DashboardPage from './pages/DashboardPage';
import MarkersPage from './pages/MarkersPage';
import AnalyticsPage from './pages/AnalyticsPage';
import SettingsPage from './pages/SettingsPage';

// Create a client
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      refetchOnWindowFocus: false,
      retry: 1,
      staleTime: 5 * 60 * 1000, // 5 minutes
    },
  },
});

const App: React.FC = () => {
  const [sidebarOpen, setSidebarOpen] = useState(false);

  const toggleSidebar = () => {
    setSidebarOpen(!sidebarOpen);
  };

  const closeSidebar = () => {
    setSidebarOpen(false);
  };

  return (
    <QueryClientProvider client={queryClient}>
      <Router>
        <div className="min-h-screen bg-gray-50">
          {/* Header */}
          <Header onToggleSidebar={toggleSidebar} />
          
          {/* Sidebar */}
          <Sidebar isOpen={sidebarOpen} onClose={closeSidebar} />
          
          {/* Main Content */}
          <main className={`
            pt-16 transition-all duration-300 ease-in-out
            ${sidebarOpen ? 'md:ml-64' : 'ml-0'}
          `}>
            <div className="container mx-auto px-4 py-6">
              <Routes>
                <Route path="/" element={<DashboardPage />} />
                <Route path="/markers" element={<MarkersPage />} />
                <Route path="/analytics" element={<AnalyticsPage />} />
                <Route path="/settings" element={<SettingsPage />} />
                <Route path="*" element={<NotFoundPage />} />
              </Routes>
            </div>
          </main>
          
          {/* Toast Notifications */}
          <Toaster
            position="top-right"
            toastOptions={{
              duration: 4000,
              style: {
                background: '#363636',
                color: '#fff',
              },
              success: {
                duration: 3000,
                iconTheme: {
                  primary: '#4ade80',
                  secondary: '#fff',
                },
              },
              error: {
                duration: 5000,
                iconTheme: {
                  primary: '#ef4444',
                  secondary: '#fff',
                },
              },
            }}
          />
        </div>
      </Router>
    </QueryClientProvider>
  );
};

// 404 í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸
const NotFoundPage: React.FC = () => {
  return (
    <div className="flex flex-col items-center justify-center min-h-[60vh] text-center">
      <div className="text-6xl mb-4">ğŸš§</div>
      <h1 className="text-2xl font-bold text-gray-900 mb-2">í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</h1>
      <p className="text-gray-600 mb-6">
        ìš”ì²­í•˜ì‹  í˜ì´ì§€ê°€ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜ ì´ë™ë˜ì—ˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </p>
      <button
        onClick={() => window.history.back()}
        className="bg-primary-500 hover:bg-primary-600 text-white px-6 py-2 rounded-lg transition-colors"
      >
        ì´ì „ í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°
      </button>
    </div>
  );
};

export default App;
```

---

### 3. main.py

- **ê²½ë¡œ:** `backend/app/main.py`
- **í¬ê¸°:** 5,474 characters
- **íƒ€ì…:** .py

```python
# backend/app/main.py (ìµœì¢… ìˆ˜ì • ë²„ì „)
from fastapi import FastAPI, Depends
from fastapi.middleware.cors import CORSMiddleware
from fastapi.staticfiles import StaticFiles
from fastapi.responses import JSONResponse
import os
import uvicorn
import logging

from .core.config import settings
from .core.database import engine, create_tables
from .api import markers, videos, analysis, dashboard
try:
    from .api import debug
    debug_available = True
except ImportError:
    debug_available = False

# ë¡œê¹… ì„¤ì •
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# AI ëª¨ë¸ ì‚¬ì „ ë¡œë“œ ì‹œë„
def try_preload_ai_model():
    """AI ëª¨ë¸ ì‚¬ì „ ë¡œë“œ ì‹œë„ (ì—¬ëŸ¬ ê²½ë¡œ)"""
    ai_status = "not_available"
    
    try:
        # ë°©ë²• 1: app íŒ¨í‚¤ì§€ ë‚´ë¶€ì—ì„œ ë¡œë“œ
        from .ai_model.model_loader import preload_model
        preload_model()
        ai_status = "loaded_from_app"
        logger.info("âœ… AI ëª¨ë¸ì„ app íŒ¨í‚¤ì§€ì—ì„œ ì‚¬ì „ ë¡œë“œ ì™„ë£Œ")
    except ImportError:
        try:
            # ë°©ë²• 2: backend ë ˆë²¨ì—ì„œ ë¡œë“œ
            import sys
            backend_path = os.path.dirname(os.path.dirname(__file__))
            if backend_path not in sys.path:
                sys.path.insert(0, backend_path)
            
            from ai_model.model_loader import preload_model
            preload_model()
            ai_status = "loaded_from_backend"
            logger.info("âœ… AI ëª¨ë¸ì„ backend ë ˆë²¨ì—ì„œ ì‚¬ì „ ë¡œë“œ ì™„ë£Œ")
        except ImportError:
            ai_status = "not_found"
            logger.warning("âš ï¸  AI ëª¨ë¸ ë¡œë”ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. AI ê¸°ëŠ¥ì´ ì‹œë®¬ë ˆì´ì…˜ ëª¨ë“œë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.")
        except Exception as e:
            ai_status = "load_error"
            logger.error(f"âŒ AI ëª¨ë¸ ë¡œë“œ ì¤‘ ì˜¤ë¥˜: {e}")
    except Exception as e:
        ai_status = "load_error"
        logger.error(f"âŒ AI ëª¨ë¸ ì‚¬ì „ ë¡œë“œ ì‹¤íŒ¨: {e}")
    
    return ai_status

# AI ëª¨ë¸ ë¡œë“œ ì‹œë„
ai_load_status = try_preload_ai_model()

# í…Œì´ë¸” ìƒì„±
try:
    create_tables()
    logger.info("âœ… ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ìƒì„±/í™•ì¸ ì™„ë£Œ")
except Exception as e:
    logger.error(f"âŒ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ìƒì„± ì‹¤íŒ¨: {e}")

# FastAPI ì•± ìƒì„±
app = FastAPI(
    title=settings.PROJECT_NAME,
    description=settings.DESCRIPTION + f" (AI ìƒíƒœ: {ai_load_status})",
    version=settings.VERSION,
    docs_url="/docs",
    redoc_url="/redoc"
)

# CORS ë¯¸ë“¤ì›¨ì–´ ì„¤ì •
app.add_middleware(
    CORSMiddleware,
    allow_origins=settings.CORS_ORIGINS,
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# ì—…ë¡œë“œëœ íŒŒì¼ ì •ì  ì„œë¹™
if not os.path.exists(settings.UPLOAD_FOLDER):
    os.makedirs(settings.UPLOAD_FOLDER, exist_ok=True)
    os.makedirs(os.path.join(settings.UPLOAD_FOLDER, "videos"), exist_ok=True)
    os.makedirs(os.path.join(settings.UPLOAD_FOLDER, "analysis_results"), exist_ok=True)

app.mount("/uploads", StaticFiles(directory=settings.UPLOAD_FOLDER), name="uploads")

# API ë¼ìš°í„° ë“±ë¡
app.include_router(dashboard.router, prefix="/api/dashboard", tags=["Dashboard"])
app.include_router(markers.router, prefix="/api/markers", tags=["Markers"])
app.include_router(videos.router, prefix="/api/videos", tags=["Videos"])
app.include_router(analysis.router, prefix="/api/analysis", tags=["Analysis"])

# ë””ë²„ê·¸ ë¼ìš°í„° (ê°œë°œ í™˜ê²½ì—ì„œë§Œ)
if debug_available:
    app.include_router(debug.router, prefix="/api/debug", tags=["Debug"])

# ë£¨íŠ¸ ì—”ë“œí¬ì¸íŠ¸
@app.get("/")
async def root():
    return {
        "message": "ğŸ¤– ë„ë¡œ ìœ ì§€ë³´ìˆ˜ ê´€ë¦¬ ì‹œìŠ¤í…œ API",
        "version": settings.VERSION,
        "ai_status": ai_load_status,
        "docs": "/docs",
        "features": [
            "ë§ˆì»¤ ê´€ë¦¬",
            "ë¹„ë””ì˜¤ ì—…ë¡œë“œ", 
            "AI ê· ì—´ ê²€ì¶œ",
            "ë¶„ì„ ê²°ê³¼ ì‹œê°í™”"
        ]
    }

# í—¬ìŠ¤ì²´í¬ ì—”ë“œí¬ì¸íŠ¸
@app.get("/health")
async def health_check():
    # AI ëª¨ë¸ ìƒíƒœ í™•ì¸
    model_status = "unknown"
    try:
        # ë°©ë²• 1: app ë‚´ë¶€
        from .ai_model.model_loader import get_model_loader
        model_info = get_model_loader().get_model_info()
        model_status = "ready" if model_info.get("loaded") else "not_loaded"
    except ImportError:
        try:
            # ë°©ë²• 2: backend ë ˆë²¨
            import sys
            backend_path = os.path.dirname(os.path.dirname(__file__))
            if backend_path not in sys.path:
                sys.path.insert(0, backend_path)
            from ai_model.model_loader import get_model_loader
            model_info = get_model_loader().get_model_info()
            model_status = "ready" if model_info.get("loaded") else "not_loaded"
        except:
            model_status = "not_available"
    except:
        model_status = "error"
    
    return {
        "status": "healthy",
        "timestamp": "2024-01-01T00:00:00Z",
        "ai_model": model_status,
        "ai_load_status": ai_load_status,
        "database": "connected",
        "upload_folder": os.path.exists(settings.UPLOAD_FOLDER)
    }

# ì „ì—­ ì˜ˆì™¸ í•¸ë“¤ëŸ¬
@app.exception_handler(404)
async def not_found_handler(request, exc):
    return JSONResponse(
        status_code=404,
        content={"message": "ìš”ì²­ëœ ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."}
    )

@app.exception_handler(500)
async def internal_error_handler(request, exc):
    logger.error(f"ë‚´ë¶€ ì„œë²„ ì˜¤ë¥˜: {exc}")
    return JSONResponse(
        status_code=500,
        content={"message": "ë‚´ë¶€ ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."}
    )

# ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ì´ë²¤íŠ¸
@app.on_event("startup")
async def startup_event():
    logger.info("ğŸš€ ë„ë¡œ ìœ ì§€ë³´ìˆ˜ ê´€ë¦¬ ì‹œìŠ¤í…œ ì‹œì‘")
    logger.info(f"ğŸ“ API ë¬¸ì„œ: http://localhost:8000/docs")
    logger.info(f"ğŸ¤– AI ìƒíƒœ: {ai_load_status}")
    logger.info(f"ğŸ“ ì—…ë¡œë“œ í´ë”: {settings.UPLOAD_FOLDER}")

if __name__ == "__main__":
    uvicorn.run(
        "app.main:app",
        host="0.0.0.0",
        port=8000,
        reload=True
    )
```

---

### 4. docker-compose.yml

- **ê²½ë¡œ:** `docker-compose.yml`
- **í¬ê¸°:** 787 characters
- **íƒ€ì…:** .yml

```yaml
version: '3.8'

services:
  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: road_maintenance
      POSTGRES_USER: admin
      POSTGRES_PASSWORD: password
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./database/init.sql:/docker-entrypoint-initdb.d/init.sql

  backend:
    build: ./backend
    ports:
      - "8000:8000"
    depends_on:
      - postgres
    environment:
      DATABASE_URL: postgresql://admin:password@postgres:5432/road_maintenance
    volumes:
      - ./backend/uploads:/app/uploads
      - ./backend/ai_model:/app/ai_model

  frontend:
    build: ./frontend
    ports:
      - "3000:3000"
    depends_on:
      - backend
    volumes:
      - ./frontend/src:/app/src

volumes:
  postgres_data:

```

---

### 5. package.json

- **ê²½ë¡œ:** `frontend/package.json`
- **í¬ê¸°:** 1,533 characters
- **íƒ€ì…:** .json

```json
{
  "name": "frontend",
  "version": "0.1.0",
  "private": true,
  "dependencies": {
    "@headlessui/react": "^2.2.4",
    "@heroicons/react": "^2.2.0",
    "@tanstack/react-query": "^5.83.0",
    "@testing-library/dom": "^10.4.0",
    "@testing-library/jest-dom": "^6.6.3",
    "@testing-library/react": "^16.3.0",
    "@testing-library/user-event": "^13.5.0",
    "@types/jest": "^27.5.2",
    "@types/node": "^18.19.120",
    "@types/react": "^19.1.8",
    "@types/react-dom": "^19.1.6",
    "axios": "^1.10.0",
    "chart.js": "^4.5.0",
    "date-fns": "^2.30.0",
    "react": "^19.1.0",
    "react-chartjs-2": "^5.3.0",
    "react-dom": "^19.1.0",
    "react-dropzone": "^14.3.8",
    "react-hot-toast": "^2.5.2",
    "react-router-dom": "^6.30.1",
    "react-scripts": "5.0.1",
    "recharts": "^2.15.4",
    "typescript": "^4.9.5",
    "web-vitals": "^2.1.4",
    "zustand": "^5.0.6"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test",
    "eject": "react-scripts eject"
  },
  "eslintConfig": {
    "extends": [
      "react-app",
      "react-app/jest"
    ]
  },
  "browserslist": {
    "production": [
      ">0.2%",
      "not dead",
      "not op_mini all"
    ],
    "development": [
      "last 1 chrome version",
      "last 1 firefox version",
      "last 1 safari version"
    ]
  },
  "devDependencies": {
    "@types/react-router-dom": "^5.3.3",
    "autoprefixer": "^10.4.21",
    "postcss": "^8.5.6",
    "tailwindcss": "^3.4.17"
  }
}

```

---

### 6. videoService.ts

- **ê²½ë¡œ:** `frontend/src/services/videoService.ts`
- **í¬ê¸°:** 1,355 characters
- **íƒ€ì…:** .ts

```typescript
// frontend/src/services/videoService.ts
import api from './api';
import { Video, VideoUpload } from '../types/video';

export const videoService = {
  // ë§ˆì»¤ë³„ ë¹„ë””ì˜¤ ëª©ë¡ ì¡°íšŒ
  async getMarkerVideos(markerId: number): Promise<Video[]> {
    const response = await api.get(`/api/videos/marker/${markerId}`);
    return response.data;
  },

  // íŠ¹ì • ë¹„ë””ì˜¤ ì¡°íšŒ
  async getVideo(id: number): Promise<Video> {
    const response = await api.get(`/api/videos/${id}`);
    return response.data;
  },

  // ë¹„ë””ì˜¤ ì—…ë¡œë“œ
  async uploadVideo(markerId: number, upload: VideoUpload): Promise<Video> {
    const formData = new FormData();
    formData.append('file', upload.file);
    formData.append('uploaded_by', upload.uploaded_by);
    if (upload.description) {
      formData.append('description', upload.description);
    }

    const response = await api.post(`/api/videos/upload/${markerId}`, formData, {
      headers: {
        'Content-Type': 'multipart/form-data',
      },
      onUploadProgress: (progressEvent) => {
        if (progressEvent.total) {
          const progress = Math.round((progressEvent.loaded * 100) / progressEvent.total);
          console.log(`Upload progress: ${progress}%`);
        }
      }
    });
    return response.data;
  },

  // ë¹„ë””ì˜¤ ì‚­ì œ
  async deleteVideo(id: number): Promise<void> {
    await api.delete(`/api/videos/${id}`);
  }
};

```

---

### 7. markerService.ts

- **ê²½ë¡œ:** `frontend/src/services/markerService.ts`
- **í¬ê¸°:** 1,186 characters
- **íƒ€ì…:** .ts

```typescript
// frontend/src/services/markerService.ts
import api from './api';
import { Marker, MarkerCreate, MarkerUpdate, MarkerStatus, MarkerPriority, IssueType } from '../types/marker';

export interface MarkerQueryParams {
  skip?: number;
  limit?: number;
  status?: MarkerStatus;
  priority?: MarkerPriority;
  issue_type?: IssueType;
  search?: string;
}

export const markerService = {
  // ë§ˆì»¤ ëª©ë¡ ì¡°íšŒ
  async getMarkers(params: MarkerQueryParams = {}): Promise<Marker[]> {
    const response = await api.get('/api/markers/', { params });
    return response.data;
  },

  // íŠ¹ì • ë§ˆì»¤ ì¡°íšŒ
  async getMarker(id: number): Promise<Marker> {
    const response = await api.get(`/api/markers/${id}`);
    return response.data;
  },

  // ë§ˆì»¤ ìƒì„±
  async createMarker(marker: MarkerCreate): Promise<Marker> {
    const response = await api.post('/api/markers/', marker);
    return response.data;
  },

  // ë§ˆì»¤ ìˆ˜ì •
  async updateMarker(id: number, updates: MarkerUpdate): Promise<Marker> {
    const response = await api.patch(`/api/markers/${id}`, updates);
    return response.data;
  },

  // ë§ˆì»¤ ì‚­ì œ
  async deleteMarker(id: number): Promise<void> {
    await api.delete(`/api/markers/${id}`);
  }
};

```

---

### 8. dashboardService.ts

- **ê²½ë¡œ:** `frontend/src/services/dashboardService.ts`
- **í¬ê¸°:** 739 characters
- **íƒ€ì…:** .ts

```typescript
// frontend/src/services/dashboardService.ts
import api from './api';
import { DashboardStats, Activity, RegionStat } from '../types/dashboard';

export const dashboardService = {
  // ëŒ€ì‹œë³´ë“œ í†µê³„ ì¡°íšŒ
  async getStats(): Promise<DashboardStats> {
    const response = await api.get('/api/dashboard/stats');
    return response.data;
  },

  // ìµœê·¼ í™œë™ ì¡°íšŒ
  async getRecentActivities(limit: number = 10): Promise<Activity[]> {
    const response = await api.get('/api/dashboard/recent-activities', {
      params: { limit }
    });
    return response.data.activities;
  },

  // ì§€ì—­ë³„ í†µê³„ ì¡°íšŒ
  async getRegionStats(): Promise<RegionStat[]> {
    const response = await api.get('/api/dashboard/region-stats');
    return response.data.regions;
  }
};
```

---

### 9. api.ts

- **ê²½ë¡œ:** `frontend/src/services/api.ts`
- **í¬ê¸°:** 807 characters
- **íƒ€ì…:** .ts

```typescript
// frontend/src/services/api.ts
import axios from 'axios';

const API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8000';

export const api = axios.create({
  baseURL: API_BASE_URL,
  timeout: 10000,
  headers: {
    'Content-Type': 'application/json',
  },
});

// ìš”ì²­ ì¸í„°ì…‰í„°
api.interceptors.request.use(
  (config) => {
    console.log(`API Request: ${config.method?.toUpperCase()} ${config.url}`);
    return config;
  },
  (error) => {
    return Promise.reject(error);
  }
);

// ì‘ë‹µ ì¸í„°ì…‰í„°
api.interceptors.response.use(
  (response) => {
    console.log(`API Response: ${response.status} ${response.config.url}`);
    return response;
  },
  (error) => {
    console.error('API Error:', error.response?.data || error.message);
    return Promise.reject(error);
  }
);

export default api;
```

---

### 10. analysisService.ts

- **ê²½ë¡œ:** `frontend/src/services/analysisService.ts`
- **í¬ê¸°:** 674 characters
- **íƒ€ì…:** .ts

```typescript

// frontend/src/services/analysisService.ts
import api from './api';
import { Analysis } from '../types/analysis';

export const analysisService = {
  // ë¹„ë””ì˜¤ë³„ ë¶„ì„ ê²°ê³¼ ì¡°íšŒ
  async getVideoAnalyses(videoId: number): Promise<Analysis[]> {
    const response = await api.get(`/api/analysis/video/${videoId}`);
    return response.data;
  },

  // íŠ¹ì • ë¶„ì„ ê²°ê³¼ ì¡°íšŒ
  async getAnalysis(id: number): Promise<Analysis> {
    const response = await api.get(`/api/analysis/${id}`);
    return response.data;
  },

  // AI ë¶„ì„ ì‹œì‘
  async startAnalysis(videoId: number): Promise<Analysis> {
    const response = await api.post(`/api/analysis/start/${videoId}`);
    return response.data;
  }
};
```

---

### 11. marker_service.py

- **ê²½ë¡œ:** `backend/app/services/marker_service.py`
- **í¬ê¸°:** 7,814 characters
- **íƒ€ì…:** .py

```python
# backend/app/services/marker_service.py
from sqlalchemy.orm import Session
from sqlalchemy import and_, or_, func
from typing import List, Optional, Dict, Any
from datetime import datetime, timedelta

from ..models.marker import Marker, MarkerStatus, MarkerPriority, IssueType
from ..models.video import Video
from ..models.analysis import Analysis
from ..schemas.marker import MarkerCreate, MarkerUpdate


class MarkerService:
    """ë§ˆì»¤ ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•˜ëŠ” ì„œë¹„ìŠ¤ í´ë˜ìŠ¤"""
    
    def __init__(self, db: Session):
        self.db = db
    
    def get_marker_with_stats(self, marker_id: int) -> Optional[Dict[str, Any]]:
        """í†µê³„ ì •ë³´ê°€ í¬í•¨ëœ ë§ˆì»¤ ì¡°íšŒ"""
        
        marker = self.db.query(Marker).filter(Marker.id == marker_id).first()
        if not marker:
            return None
        
        # ë¹„ë””ì˜¤ í†µê³„
        video_stats = self.db.query(
            func.count(Video.id).label('total_videos'),
            func.sum(Video.file_size).label('total_size'),
            func.avg(Video.duration).label('avg_duration')
        ).filter(Video.marker_id == marker_id).first()
        
        # ë¶„ì„ í†µê³„
        analysis_stats = self.db.query(
            func.count(Analysis.id).label('total_analyses'),
            func.avg(Analysis.confidence_score).label('avg_confidence'),
            func.sum(Analysis.total_cracks_detected).label('total_cracks')
        ).filter(Analysis.marker_id == marker_id).first()
        
        return {
            "marker": marker,
            "video_stats": {
                "count": video_stats.total_videos or 0,
                "total_size_mb": round((video_stats.total_size or 0) / (1024 * 1024), 2),
                "avg_duration_seconds": round(video_stats.avg_duration or 0, 1)
            },
            "analysis_stats": {
                "count": analysis_stats.total_analyses or 0,
                "avg_confidence": round((analysis_stats.avg_confidence or 0) * 100, 1),
                "total_cracks": analysis_stats.total_cracks or 0
            }
        }
    
    def get_markers_by_status_priority(
        self, 
        status: Optional[MarkerStatus] = None,
        priority: Optional[MarkerPriority] = None,
        limit: int = 10
    ) -> List[Marker]:
        """ìƒíƒœì™€ ìš°ì„ ìˆœìœ„ë¡œ ë§ˆì»¤ ì¡°íšŒ"""
        
        query = self.db.query(Marker)
        
        if status:
            query = query.filter(Marker.status == status)
        
        if priority:
            query = query.filter(Marker.priority == priority)
        
        return query.order_by(Marker.created_at.desc()).limit(limit).all()
    
    def get_urgent_markers(self, days: int = 7) -> List[Marker]:
        """ì§€ì •ëœ ê¸°ê°„ ë‚´ ê¸´ê¸‰ ë§ˆì»¤ ì¡°íšŒ"""
        
        cutoff_date = datetime.now() - timedelta(days=days)
        
        return self.db.query(Marker).filter(
            and_(
                Marker.priority == MarkerPriority.URGENT,
                Marker.status != MarkerStatus.COMPLETED,
                Marker.created_at >= cutoff_date
            )
        ).order_by(Marker.created_at.desc()).all()
    
    def get_completion_rate(self, days: int = 30) -> Dict[str, Any]:
        """ì™„ë£Œìœ¨ í†µê³„"""
        
        cutoff_date = datetime.now() - timedelta(days=days)
        
        total_markers = self.db.query(Marker).filter(
            Marker.created_at >= cutoff_date
        ).count()
        
        completed_markers = self.db.query(Marker).filter(
            and_(
                Marker.created_at >= cutoff_date,
                Marker.status == MarkerStatus.COMPLETED
            )
        ).count()
        
        completion_rate = (completed_markers / total_markers * 100) if total_markers > 0 else 0
        
        return {
            "period_days": days,
            "total_markers": total_markers,
            "completed_markers": completed_markers,
            "completion_rate": round(completion_rate, 2)
        }
    
    def assign_marker_automatically(self, marker_id: int) -> Optional[str]:
        """ë§ˆì»¤ ìë™ ë°°ì • ë¡œì§ (ì˜ˆì‹œ)"""
        
        marker = self.db.query(Marker).filter(Marker.id == marker_id).first()
        if not marker:
            return None
        
        # ê°„ë‹¨í•œ ìë™ ë°°ì • ë¡œì§ (ì‹¤ì œë¡œëŠ” ë” ë³µì¡í•œ ë¡œì§ êµ¬í˜„)
        if marker.priority == MarkerPriority.URGENT:
            assigned_to = "ê¸´ê¸‰ëŒ€ì‘íŒ€"
        elif marker.issue_type == IssueType.POTHOLE:
            assigned_to = "ë„ë¡œë³´ìˆ˜íŒ€"
        elif marker.issue_type == IssueType.SIGN_DAMAGE:
            assigned_to = "í‘œì§€íŒê´€ë¦¬íŒ€"
        else:
            assigned_to = "ì¼ë°˜ê´€ë¦¬íŒ€"
        
        marker.assigned_to = assigned_to
        marker.updated_at = datetime.now()
        
        try:
            self.db.commit()
            return assigned_to
        except Exception:
            self.db.rollback()
            return None
    
    def get_markers_needing_attention(self) -> List[Marker]:
        """ì£¼ì˜ê°€ í•„ìš”í•œ ë§ˆì»¤ë“¤ ì¡°íšŒ"""
        
        # ê¸´ê¸‰ ë§ˆì»¤ ì¤‘ 3ì¼ ì´ìƒ ì²˜ë¦¬ë˜ì§€ ì•Šì€ ê²ƒë“¤
        three_days_ago = datetime.now() - timedelta(days=3)
        
        urgent_old = self.db.query(Marker).filter(
            and_(
                Marker.priority == MarkerPriority.URGENT,
                Marker.status == MarkerStatus.PENDING,
                Marker.created_at <= three_days_ago
            )
        ).all()
        
        # ë‹´ë‹¹ìê°€ ë°°ì •ë˜ì§€ ì•Šì€ ë§ˆì»¤ë“¤
        unassigned = self.db.query(Marker).filter(
            and_(
                Marker.assigned_to.is_(None),
                Marker.status != MarkerStatus.COMPLETED
            )
        ).limit(10).all()
        
        return urgent_old + unassigned


# backend/app/services/video_service.py
from sqlalchemy.orm import Session
from typing import List, Optional, Dict, Any
import os

from ..models.video import Video
from ..models.marker import Marker
from ..core.config import settings


class VideoService:
    """ë¹„ë””ì˜¤ ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•˜ëŠ” ì„œë¹„ìŠ¤ í´ë˜ìŠ¤"""
    
    def __init__(self, db: Session):
        self.db = db
    
    def get_storage_usage(self) -> Dict[str, Any]:
        """ì €ì¥ì†Œ ì‚¬ìš©ëŸ‰ ì¡°íšŒ"""
        
        total_size = self.db.query(func.sum(Video.file_size)).scalar() or 0
        total_videos = self.db.query(Video).count()
        
        # í‰ê·  íŒŒì¼ í¬ê¸°
        avg_size = total_size / total_videos if total_videos > 0 else 0
        
        return {
            "total_videos": total_videos,
            "total_size_bytes": total_size,
            "total_size_mb": round(total_size / (1024 * 1024), 2),
            "total_size_gb": round(total_size / (1024 * 1024 * 1024), 2),
            "average_size_mb": round(avg_size / (1024 * 1024), 2)
        }
    
    def cleanup_orphaned_videos(self) -> int:
        """ë§ˆì»¤ê°€ ì‚­ì œëœ ê³ ì•„ ë¹„ë””ì˜¤ë“¤ ì •ë¦¬"""
        
        orphaned_videos = self.db.query(Video).filter(
            ~Video.marker_id.in_(
                self.db.query(Marker.id)
            )
        ).all()
        
        deleted_count = 0
        for video in orphaned_videos:
            try:
                # íŒŒì¼ ì‹œìŠ¤í…œì—ì„œ íŒŒì¼ ì‚­ì œ
                if os.path.exists(video.file_path):
                    os.remove(video.file_path)
                
                # ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‚­ì œ
                self.db.delete(video)
                deleted_count += 1
                
            except Exception as e:
                print(f"ê³ ì•„ ë¹„ë””ì˜¤ ì‚­ì œ ì‹¤íŒ¨: {video.id} - {e}")
        
        try:
            self.db.commit()
        except Exception:
            self.db.rollback()
            deleted_count = 0
        
        return deleted_count
    
    def get_videos_without_analysis(self, limit: int = 10) -> List[Video]:
        """ë¶„ì„ë˜ì§€ ì•Šì€ ë¹„ë””ì˜¤ë“¤ ì¡°íšŒ"""
        
        return self.db.query(Video).filter(
            ~Video.id.in_(
                self.db.query(Analysis.video_id).filter(
                    Analysis.status.in_([AnalysisStatus.COMPLETED, AnalysisStatus.PROCESSING])
                )
            )
        ).order_by(Video.created_at.desc()).limit(limit).all()
```

---

### 12. ai_service.py

- **ê²½ë¡œ:** `backend/app/services/ai_service.py`
- **í¬ê¸°:** 6,530 characters
- **íƒ€ì…:** .py

```python
# backend/app/services/ai_service.py (ìˆ˜ì •ëœ ë²„ì „)
import asyncio
import os
import sys
from sqlalchemy.orm import Session
from datetime import datetime
from typing import Dict, List, Any
import uuid
from pathlib import Path

# AI ëª¨ë“ˆ import ê²½ë¡œ ìˆ˜ì •
try:
    # app ë‚´ë¶€ë¡œ ì´ë™í•œ ê²½ìš°
    from ..ai_model.inference import CrackDetector
    from ..ai_model.model_loader import get_model_loader
except ImportError:
    try:
        # ìƒìœ„ ë””ë ‰í† ë¦¬ì— ìˆëŠ” ê²½ìš° (ì ˆëŒ€ import)
        sys.path.append(os.path.join(os.path.dirname(__file__), '../../'))
        from ai_model.inference import CrackDetector
        from ai_model.model_loader import get_model_loader
    except ImportError as e:
        print(f"AI ëª¨ë“ˆ import ì‹¤íŒ¨: {e}")
        # ë”ë¯¸ í´ë˜ìŠ¤ë¡œ ëŒ€ì²´ (AI ê¸°ëŠ¥ ì—†ì´ ì‹¤í–‰)
        class CrackDetector:
            def analyze_video(self, *args, **kwargs):
                raise Exception("AI ëª¨ë¸ì´ ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
        
        def get_model_loader():
            class DummyLoader:
                def get_model_info(self):
                    return {"loaded": False, "error": "AI ëª¨ë¸ ì—†ìŒ"}
            return DummyLoader()

from ..core.database import SessionLocal
from ..models.analysis import Analysis, AnalysisStatus
from ..core.config import settings
import logging

logger = logging.getLogger(__name__)

async def start_video_analysis(analysis_id: int, video_path: str):
    """ë¹„ë””ì˜¤ AI ë¶„ì„ì„ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰"""
    
    db = SessionLocal()
    try:
        # ë¶„ì„ ìƒíƒœë¥¼ ì²˜ë¦¬ ì¤‘ìœ¼ë¡œ ë³€ê²½
        analysis = db.query(Analysis).filter(Analysis.id == analysis_id).first()
        if not analysis:
            logger.error(f"ë¶„ì„ ID {analysis_id}ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
            return
        
        analysis.status = AnalysisStatus.PROCESSING
        analysis.started_at = datetime.now()
        analysis.progress = 5
        db.commit()
        
        logger.info(f"AI ë¶„ì„ ì‹œì‘: {analysis_id}")
        
        # ì¶œë ¥ ë¹„ë””ì˜¤ ê²½ë¡œ ìƒì„±
        result_dir = os.path.join(settings.UPLOAD_FOLDER, "analysis_results")
        os.makedirs(result_dir, exist_ok=True)
        
        # ê³ ìœ í•œ íŒŒì¼ëª… ìƒì„±
        video_filename = f"analysis_{analysis_id}_{uuid.uuid4().hex[:8]}.mp4"
        output_video_path = os.path.join(result_dir, video_filename)
        
        logger.info(f"ğŸ“ ë¶„ì„ ê²°ê³¼ ì €ì¥ ê²½ë¡œ: {output_video_path}")
        
        # ì›ë³¸ ë¹„ë””ì˜¤ íŒŒì¼ ì¡´ì¬ í™•ì¸
        if not os.path.exists(video_path):
            raise Exception(f"ì›ë³¸ ë¹„ë””ì˜¤ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: {video_path}")
        
        logger.info(f"ğŸ“¹ ì›ë³¸ ë¹„ë””ì˜¤ í™•ì¸ë¨: {video_path} ({os.path.getsize(video_path)} bytes)")
        
        # ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ ì½œë°±
        def progress_callback(progress: float):
            try:
                # 10-90% ë²”ìœ„ë¡œ ë§¤í•‘ (ì „í›„ ì²˜ë¦¬ìš© ì—¬ìœ  ê³µê°„)
                mapped_progress = 10 + (progress * 0.8)
                analysis.progress = min(mapped_progress, 90)
                db.commit()
                logger.debug(f"ë¶„ì„ ì§„í–‰ë¥ : {mapped_progress:.1f}%")
            except Exception as e:
                logger.warning(f"ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {e}")
        
        # ì‹¤ì œ AI ë¶„ì„ ì‹¤í–‰
        try:
            detector = CrackDetector()
            result = await asyncio.get_event_loop().run_in_executor(
                None, 
                detector.analyze_video,
                video_path,
                output_video_path,
                progress_callback
            )
        except Exception as ai_error:
            logger.error(f"AI ë¶„ì„ ì—”ì§„ ì˜¤ë¥˜: {ai_error}")
            # AI ë¶„ì„ ì‹¤íŒ¨ ì‹œ ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ ëŒ€ì²´
            result = await simulate_ai_analysis(analysis_id, video_path, db)
        
        if result["success"]:
            # ë¶„ì„ ì™„ë£Œ
            analysis.status = AnalysisStatus.COMPLETED
            analysis.progress = 100
            analysis.total_cracks_detected = result["total_cracks"]
            analysis.total_crack_area = result["total_area"]
            analysis.confidence_score = result["confidence"]
            analysis.crack_details = result["crack_details"]
            analysis.material_estimation = result["material_estimation"]
            analysis.severity_analysis = result["severity_analysis"]
            analysis.result_video_path = output_video_path
            analysis.completed_at = datetime.now()
            
            logger.info(f"AI ë¶„ì„ ì™„ë£Œ: {analysis_id} - {result['total_cracks']}ê°œ ê· ì—´ ê²€ì¶œ")
        else:
            # ë¶„ì„ ì‹¤íŒ¨
            analysis.status = AnalysisStatus.FAILED
            analysis.error_message = result.get("error", "ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜")
            logger.error(f"AI ë¶„ì„ ì‹¤íŒ¨: {analysis_id}")
        
        db.commit()
        
    except Exception as e:
        logger.error(f"ë¶„ì„ ì¤‘ ì˜ˆì™¸ ë°œìƒ: {analysis_id} - {str(e)}")
        # ì˜ˆì™¸ ë°œìƒ ì‹œ ì‹¤íŒ¨ ìƒíƒœë¡œ ë³€ê²½
        try:
            analysis.status = AnalysisStatus.FAILED
            analysis.error_message = f"ë¶„ì„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {str(e)}"
            analysis.progress = 0
            db.commit()
        except:
            pass
    
    finally:
        db.close()


async def simulate_ai_analysis(analysis_id: int, video_path: str, db: Session) -> Dict[str, Any]:
    """AI ë¶„ì„ ì‹œë®¬ë ˆì´ì…˜ (ê°œë°œ/í…ŒìŠ¤íŠ¸ìš©)"""
    
    try:
        # ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ ì‹œë®¬ë ˆì´ì…˜
        for progress in [20, 40, 60, 80, 95]:
            await asyncio.sleep(1)  # 1ì´ˆ ëŒ€ê¸°
            analysis = db.query(Analysis).filter(Analysis.id == analysis_id).first()
            if analysis:
                analysis.progress = progress
                db.commit()
        
        # ìƒ˜í”Œ ë¶„ì„ ê²°ê³¼ ìƒì„±
        crack_details = [
            {
                "crack_id": "001",
                "crack_type": "íš¡ë°©í–¥ ê· ì—´",
                "length": 2.3,
                "width": 15,
                "area": 0.345,
                "severity": "ìœ„í—˜",
                "confidence": 0.92
            }
        ]
        
        material_estimation = {
            "asphalt_concrete": 2.1,  # í†¤
            "sealer": 45,             # ë¦¬í„°
            "primer": 12,             # ë¦¬í„°
            "mesh": None,
            "total_cost": 1240000     # ì›
        }
        
        severity_analysis = {
            "overall_severity": "ìœ„í—˜",
            "risk_score": 78.5,
            "urgent_repairs_needed": True,
            "estimated_repair_time": "2-3ì¼"
        }
        
        return {
            "success": True,
            "total_cracks": len(crack_details),
            "total_area": sum(crack["area"] for crack in crack_details),
            "confidence": 0.90,
            "crack_details": crack_details,
            "material_estimation": material_estimation,
            "severity_analysis": severity_analysis
        }
        
    except Exception as e:
        return {
            "success": False,
            "error": str(e)
        }
```

---

### 13. __init__.py

- **ê²½ë¡œ:** `backend/app/services/__init__.py`
- **í¬ê¸°:** 210 characters
- **íƒ€ì…:** .py

```python
from .ai_service import start_video_analysis
from .marker_service import MarkerService
from .video_service import VideoService

__all__ = [
    "start_video_analysis",
    "MarkerService",
    "VideoService"
]

```

---

### 14. video_service.py

- **ê²½ë¡œ:** `backend/app/services/video_service.py`
- **í¬ê¸°:** 2,275 characters
- **íƒ€ì…:** .py

```python
# backend/app/services/video_service.py
from sqlalchemy.orm import Session
from sqlalchemy import func
from typing import List, Optional, Dict, Any
import os

from ..models.video import Video
from ..models.marker import Marker
from ..core.config import settings


class VideoService:
    """ë¹„ë””ì˜¤ ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•˜ëŠ” ì„œë¹„ìŠ¤ í´ë˜ìŠ¤"""
    
    def __init__(self, db: Session):
        self.db = db
    
    def get_storage_usage(self) -> Dict[str, Any]:
        """ì €ì¥ì†Œ ì‚¬ìš©ëŸ‰ ì¡°íšŒ"""
        
        total_size = self.db.query(func.sum(Video.file_size)).scalar() or 0
        total_videos = self.db.query(Video).count()
        
        # í‰ê·  íŒŒì¼ í¬ê¸°
        avg_size = total_size / total_videos if total_videos > 0 else 0
        
        return {
            "total_videos": total_videos,
            "total_size_bytes": total_size,
            "total_size_mb": round(total_size / (1024 * 1024), 2),
            "total_size_gb": round(total_size / (1024 * 1024 * 1024), 2),
            "average_size_mb": round(avg_size / (1024 * 1024), 2)
        }
    
    def cleanup_orphaned_videos(self) -> int:
        """ë§ˆì»¤ê°€ ì‚­ì œëœ ê³ ì•„ ë¹„ë””ì˜¤ë“¤ ì •ë¦¬"""
        
        orphaned_videos = self.db.query(Video).filter(
            ~Video.marker_id.in_(
                self.db.query(Marker.id)
            )
        ).all()
        
        deleted_count = 0
        for video in orphaned_videos:
            try:
                # íŒŒì¼ ì‹œìŠ¤í…œì—ì„œ íŒŒì¼ ì‚­ì œ
                if os.path.exists(video.file_path):
                    os.remove(video.file_path)
                
                # ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‚­ì œ
                self.db.delete(video)
                deleted_count += 1
                
            except Exception as e:
                print(f"ê³ ì•„ ë¹„ë””ì˜¤ ì‚­ì œ ì‹¤íŒ¨: {video.id} - {e}")
        
        try:
            self.db.commit()
        except Exception:
            self.db.rollback()
            deleted_count = 0
        
        return deleted_count
    
    def get_videos_without_analysis(self, limit: int = 10) -> List[Video]:
        """ë¶„ì„ë˜ì§€ ì•Šì€ ë¹„ë””ì˜¤ë“¤ ì¡°íšŒ"""
        from ..models.analysis import Analysis
        
        return self.db.query(Video).filter(
            ~Video.id.in_(
                self.db.query(Analysis.video_id)
            )
        ).order_by(Video.created_at.desc()).limit(limit).all()
```

---

### 15. debug.py

- **ê²½ë¡œ:** `backend/app/api/debug.py`
- **í¬ê¸°:** 3,110 characters
- **íƒ€ì…:** .py

```python
# backend/app/api/debug.py (ìƒˆ íŒŒì¼)
from fastapi import APIRouter, Depends
from sqlalchemy.orm import Session
import os
import logging

from ..core.database import get_db
from ..core.config import settings
from ..models.video import Video
from ..models.analysis import Analysis

logger = logging.getLogger(__name__)
router = APIRouter()

@router.get("/videos")
async def debug_videos(db: Session = Depends(get_db)):
    """ë¹„ë””ì˜¤ ë””ë²„ê¹… ì •ë³´"""
    
    videos = db.query(Video).all()
    
    result = []
    for video in videos:
        file_exists = os.path.exists(video.file_path) if video.file_path else False
        file_size_actual = os.path.getsize(video.file_path) if file_exists else 0
        
        result.append({
            "id": video.id,
            "filename": video.filename,
            "original_filename": video.original_filename,
            "file_path": video.file_path,
            "file_exists": file_exists,
            "file_size_db": video.file_size,
            "file_size_actual": file_size_actual,
            "marker_id": video.marker_id,
            "created_at": video.created_at.isoformat(),
            "stream_url": f"/api/videos/{video.id}/stream"
        })
    
    return {
        "total_videos": len(videos),
        "upload_folder": settings.UPLOAD_FOLDER,
        "upload_folder_exists": os.path.exists(settings.UPLOAD_FOLDER),
        "videos": result
    }

@router.get("/analyses")
async def debug_analyses(db: Session = Depends(get_db)):
    """ë¶„ì„ ê²°ê³¼ ë””ë²„ê¹… ì •ë³´"""
    
    analyses = db.query(Analysis).all()
    
    result = []
    for analysis in analyses:
        result_file_exists = False
        if analysis.result_video_path:
            result_file_exists = os.path.exists(analysis.result_video_path)
        
        result.append({
            "id": analysis.id,
            "video_id": analysis.video_id,
            "marker_id": analysis.marker_id,
            "status": analysis.status,
            "progress": analysis.progress,
            "result_video_path": analysis.result_video_path,
            "result_file_exists": result_file_exists,
            "total_cracks": analysis.total_cracks_detected,
            "created_at": analysis.created_at.isoformat(),
            "completed_at": analysis.completed_at.isoformat() if analysis.completed_at else None
        })
    
    return {
        "total_analyses": len(analyses),
        "analyses": result
    }

@router.get("/system")
async def debug_system():
    """ì‹œìŠ¤í…œ ë””ë²„ê¹… ì •ë³´"""
    
    return {
        "upload_folder": settings.UPLOAD_FOLDER,
        "upload_folder_exists": os.path.exists(settings.UPLOAD_FOLDER),
        "videos_folder": os.path.join(settings.UPLOAD_FOLDER, "videos"),
        "videos_folder_exists": os.path.exists(os.path.join(settings.UPLOAD_FOLDER, "videos")),
        "analysis_results_folder": os.path.join(settings.UPLOAD_FOLDER, "analysis_results"),
        "analysis_results_folder_exists": os.path.exists(os.path.join(settings.UPLOAD_FOLDER, "analysis_results")),
        "max_upload_size": settings.MAX_UPLOAD_SIZE,
        "cors_origins": settings.CORS_ORIGINS
    }
```

---

### 16. markers.py

- **ê²½ë¡œ:** `backend/app/api/markers.py`
- **í¬ê¸°:** 10,740 characters
- **íƒ€ì…:** .py

```python
# backend/app/api/markers.py (ì™„ì „í•œ CRUD í¬í•¨)
from fastapi import APIRouter, Depends, HTTPException, Query
from sqlalchemy.orm import Session
from sqlalchemy import and_, or_, func
from typing import List, Optional
from datetime import datetime

from ..core.database import get_db
from ..models.marker import Marker, MarkerStatus, MarkerPriority, IssueType
from ..models.video import Video
from ..models.analysis import Analysis
from ..schemas.marker import MarkerCreate, MarkerUpdate, MarkerResponse

router = APIRouter()


@router.get("/", response_model=List[MarkerResponse])
async def get_markers(
    skip: int = Query(0, ge=0),
    limit: int = Query(50, ge=1, le=100),
    status: Optional[MarkerStatus] = None,
    priority: Optional[MarkerPriority] = None,
    issue_type: Optional[IssueType] = None,
    search: Optional[str] = None,
    db: Session = Depends(get_db)
):
    """ë§ˆì»¤ ëª©ë¡ ì¡°íšŒ (í•„í„°ë§ ë° ê²€ìƒ‰ ì§€ì›)"""
    
    query = db.query(Marker)
    
    # í•„í„° ì ìš©
    if status:
        query = query.filter(Marker.status == status)
    if priority:
        query = query.filter(Marker.priority == priority)
    if issue_type:
        query = query.filter(Marker.issue_type == issue_type)
    if search:
        query = query.filter(
            or_(
                Marker.title.ilike(f"%{search}%"),
                Marker.road_name.ilike(f"%{search}%"),
                Marker.address.ilike(f"%{search}%"),
                Marker.assigned_to.ilike(f"%{search}%")
            )
        )
    
    # ì •ë ¬ ë° í˜ì´ì§•
    markers = query.order_by(Marker.created_at.desc()).offset(skip).limit(limit).all()
    
    # ë§ˆì»¤ë³„ ë¹„ë””ì˜¤ ë° ë¶„ì„ ìˆ˜ ê³„ì‚°
    result = []
    for marker in markers:
        marker_data = MarkerResponse.from_orm(marker)
        marker_data.video_count = len(marker.videos)
        marker_data.analysis_count = len(marker.analyses)
        result.append(marker_data)
    
    return result


@router.get("/{marker_id}", response_model=MarkerResponse)
async def get_marker(marker_id: int, db: Session = Depends(get_db)):
    """íŠ¹ì • ë§ˆì»¤ ìƒì„¸ ì¡°íšŒ"""
    
    marker = db.query(Marker).filter(Marker.id == marker_id).first()
    if not marker:
        raise HTTPException(status_code=404, detail="ë§ˆì»¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    marker_data = MarkerResponse.from_orm(marker)
    marker_data.video_count = len(marker.videos)
    marker_data.analysis_count = len(marker.analyses)
    
    return marker_data


@router.post("/", response_model=MarkerResponse)
async def create_marker(marker: MarkerCreate, db: Session = Depends(get_db)):
    """ìƒˆ ë§ˆì»¤ ìƒì„±"""
    
    db_marker = Marker(**marker.dict())
    db.add(db_marker)
    db.commit()
    db.refresh(db_marker)
    
    marker_data = MarkerResponse.from_orm(db_marker)
    marker_data.video_count = 0
    marker_data.analysis_count = 0
    
    return marker_data


@router.patch("/{marker_id}", response_model=MarkerResponse)
async def update_marker(
    marker_id: int, 
    marker_update: MarkerUpdate, 
    db: Session = Depends(get_db)
):
    """ë§ˆì»¤ ì •ë³´ ìˆ˜ì •"""
    
    # ë§ˆì»¤ ì¡´ì¬ í™•ì¸
    marker = db.query(Marker).filter(Marker.id == marker_id).first()
    if not marker:
        raise HTTPException(status_code=404, detail="ë§ˆì»¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    # ì—…ë°ì´íŠ¸í•  í•„ë“œë§Œ ìˆ˜ì •
    update_data = marker_update.dict(exclude_unset=True)
    
    # ë¹ˆ ë¬¸ìì—´ì„ Noneìœ¼ë¡œ ë³€í™˜ (ì„ íƒì‚¬í•­)
    for field, value in update_data.items():
        if isinstance(value, str) and value.strip() == "":
            update_data[field] = None
    
    # í•„ë“œ ì—…ë°ì´íŠ¸
    for field, value in update_data.items():
        if hasattr(marker, field):
            setattr(marker, field, value)
    
    # ìˆ˜ì • ì‹œê°„ ì—…ë°ì´íŠ¸
    marker.updated_at = datetime.now()
    
    try:
        db.commit()
        db.refresh(marker)
        
        # ì‘ë‹µ ë°ì´í„° ìƒì„±
        marker_data = MarkerResponse.from_orm(marker)
        marker_data.video_count = len(marker.videos)
        marker_data.analysis_count = len(marker.analyses)
        
        return marker_data
        
    except Exception as e:
        db.rollback()
        raise HTTPException(status_code=400, detail=f"ë§ˆì»¤ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}")


@router.delete("/{marker_id}")
async def delete_marker(marker_id: int, db: Session = Depends(get_db)):
    """ë§ˆì»¤ ì‚­ì œ"""
    
    # ë§ˆì»¤ ì¡´ì¬ í™•ì¸
    marker = db.query(Marker).filter(Marker.id == marker_id).first()
    if not marker:
        raise HTTPException(status_code=404, detail="ë§ˆì»¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    try:
        # ê´€ë ¨ëœ ë¹„ë””ì˜¤ ìˆ˜ í™•ì¸
        video_count = db.query(Video).filter(Video.marker_id == marker_id).count()
        
        # ê´€ë ¨ëœ ë¶„ì„ ìˆ˜ í™•ì¸
        analysis_count = db.query(Analysis).filter(Analysis.marker_id == marker_id).count()
        
        # ë§ˆì»¤ ì‚­ì œ (CASCADEë¡œ ì¸í•´ ê´€ë ¨ ë°ì´í„°ë„ ìë™ ì‚­ì œë¨)
        db.delete(marker)
        db.commit()
        
        return {
            "message": "ë§ˆì»¤ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.",
            "deleted_marker_id": marker_id,
            "deleted_videos": video_count,
            "deleted_analyses": analysis_count
        }
        
    except Exception as e:
        db.rollback()
        raise HTTPException(status_code=400, detail=f"ë§ˆì»¤ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}")


@router.get("/{marker_id}/statistics")
async def get_marker_statistics(marker_id: int, db: Session = Depends(get_db)):
    """íŠ¹ì • ë§ˆì»¤ì˜ í†µê³„ ì •ë³´ ì¡°íšŒ"""
    
    # ë§ˆì»¤ ì¡´ì¬ í™•ì¸
    marker = db.query(Marker).filter(Marker.id == marker_id).first()
    if not marker:
        raise HTTPException(status_code=404, detail="ë§ˆì»¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    # ë¹„ë””ì˜¤ í†µê³„
    video_stats = db.query(
        func.count(Video.id).label('total_videos'),
        func.sum(Video.file_size).label('total_size'),
        func.avg(Video.duration).label('avg_duration')
    ).filter(Video.marker_id == marker_id).first()
    
    # ë¶„ì„ í†µê³„
    analysis_stats = db.query(
        func.count(Analysis.id).label('total_analyses'),
        func.avg(Analysis.confidence_score).label('avg_confidence'),
        func.sum(Analysis.total_cracks_detected).label('total_cracks'),
        func.sum(Analysis.total_crack_area).label('total_area')
    ).filter(Analysis.marker_id == marker_id).first()
    
    return {
        "marker_id": marker_id,
        "marker_title": marker.title,
        "video_statistics": {
            "total_videos": video_stats.total_videos or 0,
            "total_size_bytes": int(video_stats.total_size or 0),
            "average_duration_seconds": float(video_stats.avg_duration or 0)
        },
        "analysis_statistics": {
            "total_analyses": analysis_stats.total_analyses or 0,
            "average_confidence": float(analysis_stats.avg_confidence or 0),
            "total_cracks_detected": int(analysis_stats.total_cracks or 0),
            "total_crack_area": float(analysis_stats.total_area or 0)
        },
        "created_at": marker.created_at,
        "updated_at": marker.updated_at
    }


@router.patch("/{marker_id}/status")
async def update_marker_status(
    marker_id: int, 
    status: MarkerStatus,
    db: Session = Depends(get_db)
):
    """ë§ˆì»¤ ìƒíƒœë§Œ ë¹ ë¥´ê²Œ ì—…ë°ì´íŠ¸"""
    
    marker = db.query(Marker).filter(Marker.id == marker_id).first()
    if not marker:
        raise HTTPException(status_code=404, detail="ë§ˆì»¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    old_status = marker.status
    marker.status = status
    marker.updated_at = datetime.now()
    
    try:
        db.commit()
        db.refresh(marker)
        
        return {
            "message": "ë§ˆì»¤ ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.",
            "marker_id": marker_id,
            "old_status": old_status,
            "new_status": status,
            "updated_at": marker.updated_at
        }
        
    except Exception as e:
        db.rollback()
        raise HTTPException(status_code=400, detail=f"ìƒíƒœ ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}")


@router.patch("/{marker_id}/assign")
async def assign_marker(
    marker_id: int, 
    assigned_to: str,
    db: Session = Depends(get_db)
):
    """ë§ˆì»¤ ë‹´ë‹¹ì ë°°ì •"""
    
    marker = db.query(Marker).filter(Marker.id == marker_id).first()
    if not marker:
        raise HTTPException(status_code=404, detail="ë§ˆì»¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    old_assigned_to = marker.assigned_to
    marker.assigned_to = assigned_to.strip() if assigned_to.strip() else None
    marker.updated_at = datetime.now()
    
    try:
        db.commit()
        db.refresh(marker)
        
        return {
            "message": "ë‹´ë‹¹ìê°€ ë°°ì •ë˜ì—ˆìŠµë‹ˆë‹¤.",
            "marker_id": marker_id,
            "old_assigned_to": old_assigned_to,
            "new_assigned_to": marker.assigned_to,
            "updated_at": marker.updated_at
        }
        
    except Exception as e:
        db.rollback()
        raise HTTPException(status_code=400, detail=f"ë‹´ë‹¹ì ë°°ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}")


@router.get("/search/nearby")
async def search_nearby_markers(
    lat: float = Query(..., description="ìœ„ë„"),
    lng: float = Query(..., description="ê²½ë„"),
    radius_km: float = Query(1.0, description="ê²€ìƒ‰ ë°˜ê²½ (í‚¬ë¡œë¯¸í„°)"),
    limit: int = Query(10, ge=1, le=50),
    db: Session = Depends(get_db)
):
    """íŠ¹ì • ì¢Œí‘œ ì£¼ë³€ì˜ ë§ˆì»¤ ê²€ìƒ‰"""
    
    # ê°„ë‹¨í•œ ê±°ë¦¬ ê³„ì‚° (ì •í™•í•˜ì§€ ì•Šì§€ë§Œ ë°ëª¨ìš©)
    # ì‹¤ì œë¡œëŠ” PostGISë‚˜ ë‹¤ë¥¸ ê³µê°„ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ
    lat_range = radius_km / 111.0  # ëŒ€ëµì ì¸ ìœ„ë„ 1ë„ = 111km
    lng_range = radius_km / (111.0 * abs(lat))  # ê²½ë„ëŠ” ìœ„ë„ì— ë”°ë¼ ë‹¬ë¼ì§
    
    markers = db.query(Marker).filter(
        and_(
            Marker.latitude.between(lat - lat_range, lat + lat_range),
            Marker.longitude.between(lng - lng_range, lng + lng_range)
        )
    ).limit(limit).all()
    
    # ê±°ë¦¬ ê³„ì‚° ë° ì •ë ¬ (ì‹¤ì œ ê±°ë¦¬ ê³„ì‚°)
    import math
    
    def calculate_distance(lat1, lng1, lat2, lng2):
        # Haversine ê³µì‹ì„ ì‚¬ìš©í•œ ê±°ë¦¬ ê³„ì‚°
        R = 6371  # ì§€êµ¬ ë°˜ì§€ë¦„ (km)
        
        lat1_rad = math.radians(lat1)
        lat2_rad = math.radians(lat2)
        delta_lat = math.radians(lat2 - lat1)
        delta_lng = math.radians(lng2 - lng1)
        
        a = (math.sin(delta_lat/2) * math.sin(delta_lat/2) + 
             math.cos(lat1_rad) * math.cos(lat2_rad) * 
             math.sin(delta_lng/2) * math.sin(delta_lng/2))
        c = 2 * math.atan2(math.sqrt(a), math.sqrt(1-a))
        
        return R * c
    
    # ê±°ë¦¬ ì •ë³´ í¬í•¨í•œ ê²°ê³¼ ìƒì„±
    results = []
    for marker in markers:
        distance = calculate_distance(lat, lng, marker.latitude, marker.longitude)
        if distance <= radius_km:
            marker_data = MarkerResponse.from_orm(marker)
            marker_data.video_count = len(marker.videos)
            marker_data.analysis_count = len(marker.analyses)
            
            results.append({
                "marker": marker_data,
                "distance_km": round(distance, 3)
            })
    
    # ê±°ë¦¬ìˆœìœ¼ë¡œ ì •ë ¬
    results.sort(key=lambda x: x["distance_km"])
    
    return {
        "search_center": {"lat": lat, "lng": lng},
        "radius_km": radius_km,
        "total_found": len(results),
        "results": results
    }
```

---

### 17. analysis.py

- **ê²½ë¡œ:** `backend/app/api/analysis.py`
- **í¬ê¸°:** 10,471 characters
- **íƒ€ì…:** .py

```python
# backend/app/api/analysis.py (ì™„ì „í•œ êµ¬í˜„)
from fastapi import APIRouter, Depends, HTTPException, BackgroundTasks
from fastapi.responses import FileResponse, StreamingResponse
from sqlalchemy.orm import Session
from typing import List
import os
import logging

from ..core.database import get_db
from ..models.video import Video
from ..models.analysis import Analysis, AnalysisStatus
from ..schemas.analysis import AnalysisCreate, AnalysisResponse, AnalysisUpdate
from ..services.ai_service import start_video_analysis

logger = logging.getLogger(__name__)
router = APIRouter()

@router.get("/video/{video_id}", response_model=List[AnalysisResponse])
async def get_video_analyses(video_id: int, db: Session = Depends(get_db)):
    """íŠ¹ì • ë¹„ë””ì˜¤ì˜ ë¶„ì„ ê²°ê³¼ ëª©ë¡ ì¡°íšŒ"""
    
    # ë¹„ë””ì˜¤ ì¡´ì¬ í™•ì¸
    video = db.query(Video).filter(Video.id == video_id).first()
    if not video:
        raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    analyses = db.query(Analysis).filter(Analysis.video_id == video_id).order_by(Analysis.created_at.desc()).all()
    
    return [AnalysisResponse.from_orm(analysis) for analysis in analyses]

@router.get("/{analysis_id}", response_model=AnalysisResponse)
async def get_analysis(analysis_id: int, db: Session = Depends(get_db)):
    """íŠ¹ì • ë¶„ì„ ê²°ê³¼ ìƒì„¸ ì¡°íšŒ"""
    
    analysis = db.query(Analysis).filter(Analysis.id == analysis_id).first()
    if not analysis:
        raise HTTPException(status_code=404, detail="ë¶„ì„ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    return AnalysisResponse.from_orm(analysis)

@router.post("/start/{video_id}", response_model=AnalysisResponse)
async def start_analysis(
    video_id: int, 
    background_tasks: BackgroundTasks,
    db: Session = Depends(get_db)
):
    """ë¹„ë””ì˜¤ AI ë¶„ì„ ì‹œì‘"""
    
    # ë¹„ë””ì˜¤ ì¡´ì¬ í™•ì¸
    video = db.query(Video).filter(Video.id == video_id).first()
    if not video:
        raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    # ì´ë¯¸ ì§„í–‰ ì¤‘ì¸ ë¶„ì„ì´ ìˆëŠ”ì§€ í™•ì¸
    existing_analysis = db.query(Analysis).filter(
        Analysis.video_id == video_id,
        Analysis.status.in_([AnalysisStatus.PENDING, AnalysisStatus.PROCESSING])
    ).first()
    
    if existing_analysis:
        logger.info(f"ê¸°ì¡´ ì§„í–‰ ì¤‘ì¸ ë¶„ì„ ë°˜í™˜: {existing_analysis.id}")
        return AnalysisResponse.from_orm(existing_analysis)
    
    # ìƒˆ ë¶„ì„ ìƒì„±
    analysis_data = AnalysisCreate(
        marker_id=video.marker_id,
        video_id=video_id
    )
    
    db_analysis = Analysis(**analysis_data.dict())
    db_analysis.status = AnalysisStatus.PENDING
    db.add(db_analysis)
    db.commit()
    db.refresh(db_analysis)
    
    logger.info(f"ìƒˆ ë¶„ì„ ì‹œì‘: {db_analysis.id} for video {video_id}")
    
    # ë°±ê·¸ë¼ìš´ë“œì—ì„œ AI ë¶„ì„ ì‹œì‘
    background_tasks.add_task(start_video_analysis, db_analysis.id, video.file_path)
    
    return AnalysisResponse.from_orm(db_analysis)

@router.get("/{analysis_id}/result-video")
async def get_analysis_result_video(analysis_id: int, db: Session = Depends(get_db)):
    """ë¶„ì„ ê²°ê³¼ ë¹„ë””ì˜¤ ìŠ¤íŠ¸ë¦¬ë°"""
    
    analysis = db.query(Analysis).filter(Analysis.id == analysis_id).first()
    if not analysis:
        raise HTTPException(status_code=404, detail="ë¶„ì„ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    if analysis.status != AnalysisStatus.COMPLETED:
        raise HTTPException(status_code=400, detail="ë¶„ì„ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
    
    if not analysis.result_video_path or not os.path.exists(analysis.result_video_path):
        raise HTTPException(status_code=404, detail="ë¶„ì„ ê²°ê³¼ ë¹„ë””ì˜¤ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    # Range Request ì§€ì›í•˜ëŠ” ìŠ¤íŠ¸ë¦¬ë°
    def iter_file():
        with open(analysis.result_video_path, 'rb') as f:
            while chunk := f.read(8192):
                yield chunk
    
    file_size = os.path.getsize(analysis.result_video_path)
    headers = {
        'Content-Length': str(file_size),
        'Content-Type': 'video/mp4',
        'Accept-Ranges': 'bytes',
        'Cache-Control': 'public, max-age=3600'
    }
    
    return StreamingResponse(iter_file(), headers=headers)

@router.get("/{analysis_id}/comparison")
async def get_video_comparison_data(analysis_id: int, db: Session = Depends(get_db)):
    """ì›ë³¸ ë¹„ë””ì˜¤ì™€ ë¶„ì„ ê²°ê³¼ ë¹„ë””ì˜¤ ë¹„êµ ì •ë³´"""
    
    try:
        analysis = db.query(Analysis).filter(Analysis.id == analysis_id).first()
        if not analysis:
            logger.error(f"ë¶„ì„ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ: {analysis_id}")
            raise HTTPException(status_code=404, detail="ë¶„ì„ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
        
        # ì›ë³¸ ë¹„ë””ì˜¤ ì •ë³´
        original_video = analysis.video
        if not original_video:
            logger.error(f"ì›ë³¸ ë¹„ë””ì˜¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ: analysis_id={analysis_id}")
            raise HTTPException(status_code=404, detail="ì›ë³¸ ë¹„ë””ì˜¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
        
        # ê²°ê³¼ ë¹„ë””ì˜¤ ê²½ë¡œ í™•ì¸
        has_result_video = (
            analysis.status == AnalysisStatus.COMPLETED and 
            analysis.result_video_path and 
            os.path.exists(analysis.result_video_path)
        )
        
        logger.info(f"ë¹„êµ ë°ì´í„° ìƒì„± - analysis_id: {analysis_id}, status: {analysis.status}, has_result: {has_result_video}")
        
        response_data = {
            "analysis_id": analysis_id,
            "status": analysis.status.value if hasattr(analysis.status, 'value') else str(analysis.status),
            "progress": analysis.progress or 0,
            "original_video": {
                "id": original_video.id,
                "filename": original_video.original_filename,
                "stream_url": f"/api/videos/{original_video.id}/stream",
                "duration": original_video.duration,
                "size": original_video.file_size
            },
            "result_video": {
                "available": has_result_video,
                "stream_url": f"/api/analysis/{analysis_id}/result-video" if has_result_video else None
            }
        }
        
        # ë¶„ì„ ì™„ë£Œì‹œ ìš”ì•½ ì •ë³´ ì¶”ê°€
        if analysis.status == AnalysisStatus.COMPLETED:
            response_data["analysis_summary"] = {
                "total_cracks": analysis.total_cracks_detected or 0,
                "total_area": analysis.total_crack_area or 0,
                "confidence": analysis.confidence_score or 0,
                "severity": None
            }
            
            # severity_analysisê°€ dictì¸ ê²½ìš° ì²˜ë¦¬
            if analysis.severity_analysis:
                if isinstance(analysis.severity_analysis, dict):
                    response_data["analysis_summary"]["severity"] = analysis.severity_analysis.get("overall_severity")
                else:
                    # JSON ë¬¸ìì—´ì¸ ê²½ìš°
                    try:
                        import json
                        severity_data = json.loads(analysis.severity_analysis)
                        response_data["analysis_summary"]["severity"] = severity_data.get("overall_severity")
                    except:
                        pass
        
        logger.info(f"ì‘ë‹µ ë°ì´í„°: {response_data}")
        return response_data
        
    except HTTPException:
        raise
    except Exception as e:
        logger.error(f"ë¹„êµ ë°ì´í„° ìƒì„± ì¤‘ ì˜¤ë¥˜: {e}")
        raise HTTPException(status_code=500, detail=f"ë¹„êµ ë°ì´í„° ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}")

@router.patch("/{analysis_id}", response_model=AnalysisResponse)
async def update_analysis(
    analysis_id: int,
    analysis_update: AnalysisUpdate,
    db: Session = Depends(get_db)
):
    """ë¶„ì„ ê²°ê³¼ ì—…ë°ì´íŠ¸ (AI ì„œë¹„ìŠ¤ì—ì„œ ì‚¬ìš©)"""
    
    analysis = db.query(Analysis).filter(Analysis.id == analysis_id).first()
    if not analysis:
        raise HTTPException(status_code=404, detail="ë¶„ì„ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    # ì—…ë°ì´íŠ¸í•  í•„ë“œë§Œ ìˆ˜ì •
    update_data = analysis_update.dict(exclude_unset=True)
    for field, value in update_data.items():
        if field in ["crack_details", "material_estimation", "severity_analysis"] and value is not None:
            # Pydantic ëª¨ë¸ì„ dictë¡œ ë³€í™˜
            if hasattr(value, 'dict'):
                value = value.dict()
            elif isinstance(value, list) and value and hasattr(value[0], 'dict'):
                value = [item.dict() for item in value]
        setattr(analysis, field, value)
    
    # ì™„ë£Œ ì‹œê°„ ì„¤ì •
    if update_data.get("status") == AnalysisStatus.COMPLETED:
        from datetime import datetime
        analysis.completed_at = datetime.now()
    
    try:
        db.commit()
        db.refresh(analysis)
        return AnalysisResponse.from_orm(analysis)
    except Exception as e:
        db.rollback()
        raise HTTPException(status_code=400, detail=f"ë¶„ì„ ê²°ê³¼ ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}")

@router.delete("/{analysis_id}")
async def delete_analysis(analysis_id: int, db: Session = Depends(get_db)):
    """ë¶„ì„ ê²°ê³¼ ì‚­ì œ"""
    
    analysis = db.query(Analysis).filter(Analysis.id == analysis_id).first()
    if not analysis:
        raise HTTPException(status_code=404, detail="ë¶„ì„ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    # ê²°ê³¼ íŒŒì¼ë„ ì‚­ì œ
    if analysis.result_video_path and os.path.exists(analysis.result_video_path):
        try:
            os.remove(analysis.result_video_path)
            logger.info(f"ë¶„ì„ ê²°ê³¼ íŒŒì¼ ì‚­ì œ: {analysis.result_video_path}")
        except Exception as e:
            logger.warning(f"ë¶„ì„ ê²°ê³¼ íŒŒì¼ ì‚­ì œ ì‹¤íŒ¨: {e}")
    
    try:
        db.delete(analysis)
        db.commit()
        
        return {
            "message": "ë¶„ì„ ê²°ê³¼ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.",
            "deleted_analysis_id": analysis_id
        }
        
    except Exception as e:
        db.rollback()
        raise HTTPException(status_code=400, detail=f"ë¶„ì„ ê²°ê³¼ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}")

@router.get("/")
async def list_analyses(
    skip: int = 0,
    limit: int = 50,
    status: str = None,
    marker_id: int = None,
    db: Session = Depends(get_db)
):
    """ëª¨ë“  ë¶„ì„ ê²°ê³¼ ëª©ë¡ ì¡°íšŒ (ê´€ë¦¬ììš©)"""
    
    query = db.query(Analysis)
    
    if status:
        try:
            status_enum = AnalysisStatus(status)
            query = query.filter(Analysis.status == status_enum)
        except ValueError:
            raise HTTPException(status_code=400, detail=f"ìœ íš¨í•˜ì§€ ì•Šì€ ìƒíƒœ: {status}")
    
    if marker_id:
        query = query.filter(Analysis.marker_id == marker_id)
    
    analyses = query.order_by(Analysis.created_at.desc()).offset(skip).limit(limit).all()
    
    result = []
    for analysis in analyses:
        analysis_data = AnalysisResponse.from_orm(analysis)
        result.append({
            "analysis": analysis_data,
            "marker_title": analysis.marker.title if analysis.marker else None,
            "video_filename": analysis.video.original_filename if analysis.video else None
        })
    
    return {
        "total": query.count(),
        "analyses": result
    }
```

---

### 18. dashboard.py

- **ê²½ë¡œ:** `backend/app/api/dashboard.py`
- **í¬ê¸°:** 2,692 characters
- **íƒ€ì…:** .py

```python
# backend/app/api/dashboard.py
from fastapi import APIRouter, Depends
from sqlalchemy.orm import Session
from sqlalchemy import func
from datetime import datetime, timedelta
from typing import Dict, Any, List

from ..core.database import get_db
from ..models.marker import Marker, MarkerStatus, MarkerPriority
from ..models.video import Video
from ..models.analysis import Analysis

router = APIRouter()


@router.get("/stats")
async def get_dashboard_stats(db: Session = Depends(get_db)):
    """ëŒ€ì‹œë³´ë“œ í†µê³„ ë°ì´í„° ì¡°íšŒ"""
    
    # ì „ì²´ ë§ˆì»¤ ìˆ˜
    total_markers = db.query(Marker).count()
    
    # ê¸´ê¸‰ ì´ìŠˆ ìˆ˜
    urgent_issues = db.query(Marker).filter(
        Marker.priority == MarkerPriority.URGENT,
        Marker.status != MarkerStatus.COMPLETED
    ).count()
    
    # ì£¼ê°„ ì™„ë£Œ ìˆ˜ (ì§€ë‚œ 7ì¼)
    week_ago = datetime.now() - timedelta(days=7)
    weekly_completed = db.query(Marker).filter(
        Marker.status == MarkerStatus.COMPLETED,
        Marker.updated_at >= week_ago
    ).count()
    
    # ëŒ€ê¸° ì¤‘ì¸ ë§ˆì»¤ ìˆ˜
    pending_markers = db.query(Marker).filter(
        Marker.status == MarkerStatus.PENDING
    ).count()
    
    # í™œì„± ë§ˆì»¤ ìˆ˜ (ì˜ˆì‹œë¡œ ì§„í–‰ ì¤‘ì¸ ë§ˆì»¤)
    active_markers = db.query(Marker).filter(
        Marker.status == MarkerStatus.PROGRESS
    ).count()
    
    return {
        "total_markers": total_markers,
        "urgent_issues": urgent_issues,
        "weekly_completed": weekly_completed,
        "pending_markers": pending_markers,
        "active_markers": active_markers
    }


@router.get("/recent-activities")
async def get_recent_activities(limit: int = 10, db: Session = Depends(get_db)):
    """ìµœê·¼ í™œë™ ì¡°íšŒ"""
    
    # ìµœê·¼ ë§ˆì»¤ë“¤ì„ ìƒì„±ì¼ ê¸°ì¤€ìœ¼ë¡œ ì¡°íšŒ
    recent_markers = db.query(Marker).order_by(
        Marker.created_at.desc()
    ).limit(limit).all()
    
    activities = []
    for marker in recent_markers:
        activities.append({
            "id": marker.id,
            "type": "marker_created",
            "message": f"{marker.created_by}ê°€ {marker.road_name or 'ë„ë¡œ'}ì—ì„œ {marker.issue_type}ì„ ë“±ë¡í–ˆìŠµë‹ˆë‹¤.",
            "user": marker.created_by,
            "location": marker.road_name or marker.address,
            "timestamp": marker.created_at,
            "marker_id": marker.id
        })
    
    return {"activities": activities}


@router.get("/region-stats")
async def get_region_stats(db: Session = Depends(get_db)):
    """ì§€ì—­ë³„ í†µê³„"""
    
    # ê°„ë‹¨í•œ ì§€ì—­ë³„ ì§‘ê³„ (ì‹¤ì œë¡œëŠ” ì£¼ì†Œë¥¼ íŒŒì‹±í•´ì„œ ì‹œ/ë„ë³„ë¡œ ì§‘ê³„)
    regions = [
        {"name": "ì„œìš¸", "count": 234},
        {"name": "ê²½ê¸°", "count": 189}, 
        {"name": "ë¶€ì‚°", "count": 156},
        {"name": "ì¸ì²œ", "count": 98},
        {"name": "ëŒ€êµ¬", "count": 87},
        {"name": "ê¸°íƒ€", "count": 123}
    ]
    
    return {"regions": regions}



```

---

### 19. __init__.py

- **ê²½ë¡œ:** `backend/app/api/__init__.py`
- **í¬ê¸°:** 32 characters
- **íƒ€ì…:** .py

```python
# API ë¼ìš°í„°ë“¤ì€ main.pyì—ì„œ ì§ì ‘ import

```

---

### 20. videos.py

- **ê²½ë¡œ:** `backend/app/api/videos.py`
- **í¬ê¸°:** 23,145 characters
- **íƒ€ì…:** .py

```python
# backend/app/api/videos.py (ì™„ì „í•œ ë²„ì „)
from fastapi import APIRouter, Depends, HTTPException, UploadFile, File, Form, Request
from fastapi.responses import StreamingResponse, FileResponse
from sqlalchemy.orm import Session
from typing import List
import os
import uuid
import aiofiles
from datetime import datetime
import mimetypes

from ..core.database import get_db
from ..core.config import settings
from ..models.marker import Marker
from ..models.video import Video
from ..schemas.video import VideoCreate, VideoResponse
from ..utils.file_utils import validate_video_file, get_video_metadata
from ..utils.video_utils import video_processor
import logging

logger = logging.getLogger(__name__)
router = APIRouter()

@router.post("/upload/{marker_id}", response_model=VideoResponse)
async def upload_video(
    marker_id: int,
    file: UploadFile = File(...),
    description: str = Form(None),
    uploaded_by: str = Form(...),
    db: Session = Depends(get_db)
):
    """ë¹„ë””ì˜¤ íŒŒì¼ ì—…ë¡œë“œ ë° ì›¹ í˜¸í™˜ì„± ë³€í™˜"""
    
    # ë§ˆì»¤ ì¡´ì¬ í™•ì¸
    marker = db.query(Marker).filter(Marker.id == marker_id).first()
    if not marker:
        raise HTTPException(status_code=404, detail="ë§ˆì»¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    # íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬
    if not validate_video_file(file):
        raise HTTPException(status_code=400, detail="ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¹„ë””ì˜¤ í˜•ì‹ì…ë‹ˆë‹¤.")
    
    # íŒŒì¼ í¬ê¸° ì²´í¬
    if file.size and file.size > settings.MAX_UPLOAD_SIZE:
        raise HTTPException(status_code=400, detail=f"íŒŒì¼ í¬ê¸°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤. ìµœëŒ€ {settings.MAX_UPLOAD_SIZE // (1024*1024)}MB")
    
    # ê³ ìœ  íŒŒì¼ëª… ìƒì„±
    file_extension = os.path.splitext(file.filename or "")[1]
    unique_id = uuid.uuid4()
    original_filename = f"original_{unique_id}{file_extension}"
    web_filename = f"web_{unique_id}.mp4"
    
    # ì €ì¥ ê²½ë¡œ ì„¤ì •
    upload_dir = os.path.join(settings.UPLOAD_FOLDER, "videos")
    os.makedirs(upload_dir, exist_ok=True)
    
    original_path = os.path.join(upload_dir, original_filename)
    web_compatible_path = os.path.join(upload_dir, web_filename)
    
    try:
        # 1. ì›ë³¸ íŒŒì¼ ì €ì¥
        logger.info(f"ğŸ“¥ ë¹„ë””ì˜¤ ì—…ë¡œë“œ ì‹œì‘: {file.filename}")
        
        async with aiofiles.open(original_path, 'wb') as f:
            content = await file.read()
            await f.write(content)
        
        file_size = len(content)
        logger.info(f"âœ… ì›ë³¸ íŒŒì¼ ì €ì¥ ì™„ë£Œ: {original_path}")
        
        # 2. ì›¹ í˜¸í™˜ì„± ê²€ì‚¬
        compatibility = video_processor.validate_web_compatibility(original_path)
        logger.info(f"ğŸ” ì›¹ í˜¸í™˜ì„± ê²€ì‚¬: {compatibility}")
        
        # 3. ì›¹ í˜¸í™˜ í˜•ì‹ìœ¼ë¡œ ë³€í™˜ (í•„ìš”í•œ ê²½ìš°)
        final_video_path = original_path
        web_converted = False
        
        if not compatibility.get("compatible", False):
            logger.info("ğŸ”„ ì›¹ í˜¸í™˜ í˜•ì‹ìœ¼ë¡œ ë³€í™˜ ì‹œì‘...")
            
            conversion_result = video_processor.convert_to_web_compatible(
                original_path, 
                web_compatible_path
            )
            
            if conversion_result["success"]:
                final_video_path = web_compatible_path
                web_converted = True
                file_size = conversion_result["file_size"]
                logger.info("âœ… ì›¹ í˜¸í™˜ ë³€í™˜ ì™„ë£Œ")
            else:
                logger.warning(f"âš ï¸ ì›¹ í˜¸í™˜ ë³€í™˜ ì‹¤íŒ¨, ì›ë³¸ ì‚¬ìš©: {conversion_result.get('error')}")
        else:
            logger.info("âœ… ì´ë¯¸ ì›¹ í˜¸í™˜ í˜•ì‹")
        
        # 4. ë¹„ë””ì˜¤ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ
        try:
            metadata = get_video_metadata(final_video_path)
        except Exception as e:
            logger.warning(f"ë©”íƒ€ë°ì´í„° ì¶”ì¶œ ì‹¤íŒ¨: {e}")
            metadata = {}
        
        # 5. ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥
        video_data = VideoCreate(
            filename=web_filename if web_converted else original_filename,
            original_filename=file.filename or "unknown.mp4",
            file_path=final_video_path,
            file_size=file_size,
            marker_id=marker_id,
            uploaded_by=uploaded_by,
            description=description,
            duration=metadata.get("duration"),
            width=metadata.get("width"),
            height=metadata.get("height"),
            fps=metadata.get("fps")
        )
        
        db_video = Video(**video_data.dict())
        db.add(db_video)
        db.commit()
        db.refresh(db_video)
        
        # 6. ë¶ˆí•„ìš”í•œ íŒŒì¼ ì •ë¦¬
        if web_converted and os.path.exists(original_path):
            try:
                os.remove(original_path)
                logger.info("ğŸ—‘ï¸ ì›ë³¸ íŒŒì¼ ì‚­ì œ (ì›¹ í˜¸í™˜ ë²„ì „ ìƒì„±ë¨)")
            except:
                pass
        
        video_response = VideoResponse.from_orm(db_video)
        video_response.has_analysis = False
        
        logger.info(f"ğŸ‰ ë¹„ë””ì˜¤ ì—…ë¡œë“œ ë° ì²˜ë¦¬ ì™„ë£Œ: ID={db_video.id}")
        
        return video_response
        
    except Exception as e:
        # ì‹¤íŒ¨ ì‹œ íŒŒì¼ ì •ë¦¬
        for path in [original_path, web_compatible_path]:
            if os.path.exists(path):
                try:
                    os.remove(path)
                except:
                    pass
        
        if 'db_video' in locals():
            try:
                db.rollback()
            except:
                pass
        
        logger.error(f"ğŸ’¥ ë¹„ë””ì˜¤ ì—…ë¡œë“œ ì‹¤íŒ¨: {e}")
        raise HTTPException(status_code=500, detail=f"ë¹„ë””ì˜¤ ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜: {str(e)}")

@router.get("/{video_id}/stream")
async def stream_video(request: Request, video_id: int, db: Session = Depends(get_db)):
    """ì›¹ í˜¸í™˜ ë¹„ë””ì˜¤ ìŠ¤íŠ¸ë¦¬ë° (Range Request ì§€ì›)"""
    
    video = db.query(Video).filter(Video.id == video_id).first()
    if not video:
        raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    if not os.path.exists(video.file_path):
        raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    # Range Request ì§€ì› (ë¹„ë””ì˜¤ ìŠ¤íŠ¸ë¦¬ë°)
    file_size = os.path.getsize(video.file_path)
    range_header = request.headers.get('range')
    
    if range_header:
        # Range Request ì²˜ë¦¬
        range_match = range_header.replace('bytes=', '').split('-')
        start = int(range_match[0]) if range_match[0] else 0
        end = int(range_match[1]) if range_match[1] else file_size - 1
        end = min(end, file_size - 1)
        
        content_length = end - start + 1
        
        def iter_file_range():
            with open(video.file_path, 'rb') as f:
                f.seek(start)
                remaining = content_length
                while remaining:
                    chunk_size = min(8192, remaining)
                    chunk = f.read(chunk_size)
                    if not chunk:
                        break
                    remaining -= len(chunk)
                    yield chunk
        
        headers = {
            'Content-Range': f'bytes {start}-{end}/{file_size}',
            'Accept-Ranges': 'bytes',
            'Content-Length': str(content_length),
            'Content-Type': 'video/mp4',
            'Cache-Control': 'public, max-age=3600'
        }
        
        return StreamingResponse(
            iter_file_range(), 
            status_code=206,
            headers=headers
        )
    else:
        # ì „ì²´ íŒŒì¼ ìŠ¤íŠ¸ë¦¬ë°
        def iter_file():
            with open(video.file_path, 'rb') as f:
                while chunk := f.read(8192):
                    yield chunk
        
        headers = {
            'Content-Length': str(file_size),
            'Content-Type': 'video/mp4',
            'Accept-Ranges': 'bytes',
            'Cache-Control': 'public, max-age=3600'
        }
        
        return StreamingResponse(iter_file(), headers=headers)

@router.get("/{video_id}/download")
async def download_video(video_id: int, db: Session = Depends(get_db)):
    """ë¹„ë””ì˜¤ ë‹¤ìš´ë¡œë“œ"""
    
    video = db.query(Video).filter(Video.id == video_id).first()
    if not video:
        raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    if not os.path.exists(video.file_path):
        raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    return FileResponse(
        video.file_path,
        media_type="video/mp4",
        filename=video.original_filename,
        headers={"Content-Disposition": f"attachment; filename={video.original_filename}"}
    )

@router.get("/{video_id}/info")
async def get_video_info(video_id: int, db: Session = Depends(get_db)):
    """ë¹„ë””ì˜¤ ìƒì„¸ ì •ë³´ ë° ì›¹ í˜¸í™˜ì„± ì²´í¬"""
    
    video = db.query(Video).filter(Video.id == video_id).first()
    if not video:
        raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    if not os.path.exists(video.file_path):
        raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    # ì›¹ í˜¸í™˜ì„± ê²€ì‚¬
    compatibility = video_processor.validate_web_compatibility(video.file_path)
    
    # íŒŒì¼ ì •ë³´
    file_stats = os.stat(video.file_path)
    
    return {
        "video_id": video_id,
        "filename": video.original_filename,
        "file_size": video.file_size,
        "duration": video.duration,
        "resolution": f"{video.width}x{video.height}" if video.width and video.height else None,
        "fps": video.fps,
        "uploaded_by": video.uploaded_by,
        "created_at": video.created_at,
        "web_compatibility": compatibility,
        "file_exists": True,
        "last_modified": file_stats.st_mtime
    }

@router.get("/marker/{marker_id}", response_model=List[VideoResponse])
async def get_marker_videos(marker_id: int, db: Session = Depends(get_db)):
    """íŠ¹ì • ë§ˆì»¤ì˜ ë¹„ë””ì˜¤ ëª©ë¡ ì¡°íšŒ"""
    
    marker = db.query(Marker).filter(Marker.id == marker_id).first()
    if not marker:
        raise HTTPException(status_code=404, detail="ë§ˆì»¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    videos = db.query(Video).filter(Video.marker_id == marker_id).order_by(Video.created_at.desc()).all()
    
    result = []
    for video in videos:
        video_data = VideoResponse.from_orm(video)
        video_data.has_analysis = len(video.analyses) > 0
        result.append(video_data)
    
    return result


@router.get("/{video_id}", response_model=VideoResponse)
async def get_video(video_id: int, db: Session = Depends(get_db)):
    """íŠ¹ì • ë¹„ë””ì˜¤ ìƒì„¸ ì¡°íšŒ"""
    
    video = db.query(Video).filter(Video.id == video_id).first()
    if not video:
        raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    video_data = VideoResponse.from_orm(video)
    video_data.has_analysis = len(video.analyses) > 0
    
    return video_data


@router.post("/upload/{marker_id}", response_model=VideoResponse)
async def upload_video(
    marker_id: int,
    file: UploadFile = File(...),
    description: str = Form(None),
    uploaded_by: str = Form(...),
    db: Session = Depends(get_db)
):
    """ë¹„ë””ì˜¤ íŒŒì¼ ì—…ë¡œë“œ"""
    
    # ë§ˆì»¤ ì¡´ì¬ í™•ì¸
    marker = db.query(Marker).filter(Marker.id == marker_id).first()
    if not marker:
        raise HTTPException(status_code=404, detail="ë§ˆì»¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    # íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬
    if not validate_video_file(file):
        raise HTTPException(status_code=400, detail="ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¹„ë””ì˜¤ í˜•ì‹ì…ë‹ˆë‹¤.")
    
    # íŒŒì¼ í¬ê¸° ì²´í¬
    if file.size and file.size > settings.MAX_UPLOAD_SIZE:
        raise HTTPException(status_code=400, detail=f"íŒŒì¼ í¬ê¸°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤. ìµœëŒ€ {settings.MAX_UPLOAD_SIZE // (1024*1024)}MB")
    
    # ê³ ìœ  íŒŒì¼ëª… ìƒì„±
    file_extension = os.path.splitext(file.filename or "")[1]
    if not file_extension:
        file_extension = ".mp4"  # ê¸°ë³¸ í™•ì¥ì
    
    unique_filename = f"{uuid.uuid4()}{file_extension}"
    
    # ì €ì¥ ê²½ë¡œ ì„¤ì •
    upload_dir = os.path.join(settings.UPLOAD_FOLDER, "videos")
    os.makedirs(upload_dir, exist_ok=True)
    file_path = os.path.join(upload_dir, unique_filename)
    
    # íŒŒì¼ ì €ì¥
    try:
        async with aiofiles.open(file_path, 'wb') as f:
            content = await file.read()
            await f.write(content)
        
        file_size = len(content)
        
    except Exception as e:
        # íŒŒì¼ ì €ì¥ ì‹¤íŒ¨ ì‹œ ì •ë¦¬
        if os.path.exists(file_path):
            try:
                os.remove(file_path)
            except:
                pass
        raise HTTPException(status_code=500, detail=f"íŒŒì¼ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}")
    
    # ë¹„ë””ì˜¤ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ
    try:
        metadata = get_video_metadata(file_path)
    except Exception as e:
        print(f"ë©”íƒ€ë°ì´í„° ì¶”ì¶œ ì‹¤íŒ¨: {e}")
        metadata = {}
    
    # ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥
    try:
        video_data = VideoCreate(
            filename=unique_filename,
            original_filename=file.filename or "unknown.mp4",
            file_path=file_path,
            file_size=file_size,
            marker_id=marker_id,
            uploaded_by=uploaded_by,
            description=description,
            duration=metadata.get("duration"),
            width=metadata.get("width"),
            height=metadata.get("height"),
            fps=metadata.get("fps")
        )
        
        db_video = Video(**video_data.dict())
        db.add(db_video)
        db.commit()
        db.refresh(db_video)
        
        video_response = VideoResponse.from_orm(db_video)
        video_response.has_analysis = False
        
        return video_response
        
    except Exception as e:
        # DB ì €ì¥ ì‹¤íŒ¨ ì‹œ íŒŒì¼ ì •ë¦¬
        if os.path.exists(file_path):
            try:
                os.remove(file_path)
            except:
                pass
        db.rollback()
        raise HTTPException(status_code=500, detail=f"ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}")


@router.get("/{video_id}/stream")
async def stream_video(request: Request, video_id: int, db: Session = Depends(get_db)):
    """ì›¹ í˜¸í™˜ ë¹„ë””ì˜¤ ìŠ¤íŠ¸ë¦¬ë° (Range Request ì§€ì›)"""
    
    try:
        video = db.query(Video).filter(Video.id == video_id).first()
        if not video:
            logger.error(f"ë¹„ë””ì˜¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ: {video_id}")
            raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
        
        if not os.path.exists(video.file_path):
            logger.error(f"ë¹„ë””ì˜¤ íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ: {video.file_path}")
            raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
        
        logger.info(f"ë¹„ë””ì˜¤ ìŠ¤íŠ¸ë¦¬ë° ìš”ì²­: {video_id} -> {video.file_path}")
        
        # Range Request ì§€ì› (ë¹„ë””ì˜¤ ìŠ¤íŠ¸ë¦¬ë°)
        file_size = os.path.getsize(video.file_path)
        range_header = request.headers.get('range')
        
        if range_header:
            # Range Request ì²˜ë¦¬
            try:
                range_match = range_header.replace('bytes=', '').split('-')
                start = int(range_match[0]) if range_match[0] else 0
                end = int(range_match[1]) if range_match[1] else file_size - 1
                end = min(end, file_size - 1)
                
                content_length = end - start + 1
                
                def iter_file_range():
                    with open(video.file_path, 'rb') as f:
                        f.seek(start)
                        remaining = content_length
                        while remaining:
                            chunk_size = min(8192, remaining)
                            chunk = f.read(chunk_size)
                            if not chunk:
                                break
                            remaining -= len(chunk)
                            yield chunk
                
                headers = {
                    'Content-Range': f'bytes {start}-{end}/{file_size}',
                    'Accept-Ranges': 'bytes',
                    'Content-Length': str(content_length),
                    'Content-Type': 'video/mp4',
                    'Cache-Control': 'public, max-age=3600'
                }
                
                logger.info(f"Range Request: {start}-{end}/{file_size}")
                
                return StreamingResponse(
                    iter_file_range(), 
                    status_code=206,
                    headers=headers
                )
            except Exception as e:
                logger.error(f"Range Request ì²˜ë¦¬ ì‹¤íŒ¨: {e}")
                # Range ìš”ì²­ ì‹¤íŒ¨ì‹œ ì „ì²´ íŒŒì¼ë¡œ fallback
        
        # ì „ì²´ íŒŒì¼ ìŠ¤íŠ¸ë¦¬ë°
        def iter_file():
            try:
                with open(video.file_path, 'rb') as f:
                    while chunk := f.read(8192):
                        yield chunk
            except Exception as e:
                logger.error(f"íŒŒì¼ ì½ê¸° ì˜¤ë¥˜: {e}")
                raise
        
        headers = {
            'Content-Length': str(file_size),
            'Content-Type': 'video/mp4',
            'Accept-Ranges': 'bytes',
            'Cache-Control': 'public, max-age=3600'
        }
        
        logger.info(f"ì „ì²´ íŒŒì¼ ìŠ¤íŠ¸ë¦¬ë°: {file_size} bytes")
        
        return StreamingResponse(iter_file(), headers=headers)
        
    except HTTPException:
        raise
    except Exception as e:
        logger.error(f"ë¹„ë””ì˜¤ ìŠ¤íŠ¸ë¦¬ë° ì¤‘ ì˜¤ë¥˜: {e}")
        raise HTTPException(status_code=500, detail=f"ë¹„ë””ì˜¤ ìŠ¤íŠ¸ë¦¬ë° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}")


@router.get("/{video_id}/download")
async def download_video(video_id: int, db: Session = Depends(get_db)):
    """ë¹„ë””ì˜¤ ë‹¤ìš´ë¡œë“œ"""
    
    video = db.query(Video).filter(Video.id == video_id).first()
    if not video:
        raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    if not os.path.exists(video.file_path):
        raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    return FileResponse(
        video.file_path,
        media_type="application/octet-stream",
        filename=video.original_filename,
        headers={"Content-Disposition": f"attachment; filename={video.original_filename}"}
    )


@router.get("/{video_id}/thumbnail")
async def get_video_thumbnail(video_id: int, db: Session = Depends(get_db)):
    """ë¹„ë””ì˜¤ ì¸ë„¤ì¼ ìƒì„±/ë°˜í™˜"""
    
    video = db.query(Video).filter(Video.id == video_id).first()
    if not video:
        raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    if not os.path.exists(video.file_path):
        raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    # ì¸ë„¤ì¼ ìƒì„± (ê°„ë‹¨í•œ êµ¬í˜„)
    thumbnail_dir = os.path.join(settings.UPLOAD_FOLDER, "thumbnails")
    os.makedirs(thumbnail_dir, exist_ok=True)
    thumbnail_path = os.path.join(thumbnail_dir, f"{video.id}.jpg")
    
    # ì¸ë„¤ì¼ì´ ì´ë¯¸ ìˆìœ¼ë©´ ë°˜í™˜
    if os.path.exists(thumbnail_path):
        return FileResponse(thumbnail_path, media_type="image/jpeg")
    
    try:
        # OpenCVë¥¼ ì‚¬ìš©í•œ ì¸ë„¤ì¼ ìƒì„±
        import cv2
        cap = cv2.VideoCapture(video.file_path)
        
        if cap.isOpened():
            # ì¤‘ê°„ í”„ë ˆì„ìœ¼ë¡œ ì´ë™
            frame_count = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))
            middle_frame = frame_count // 2
            cap.set(cv2.CAP_PROP_POS_FRAMES, middle_frame)
            
            ret, frame = cap.read()
            if ret:
                # ì¸ë„¤ì¼ í¬ê¸° ì¡°ì •
                height, width = frame.shape[:2]
                if width > 320:
                    ratio = 320 / width
                    new_width = 320
                    new_height = int(height * ratio)
                    frame = cv2.resize(frame, (new_width, new_height))
                
                # ì¸ë„¤ì¼ ì €ì¥
                cv2.imwrite(thumbnail_path, frame)
                cap.release()
                
                return FileResponse(thumbnail_path, media_type="image/jpeg")
            
        cap.release()
        
    except Exception as e:
        print(f"ì¸ë„¤ì¼ ìƒì„± ì‹¤íŒ¨: {e}")
    
    # ì¸ë„¤ì¼ ìƒì„± ì‹¤íŒ¨ ì‹œ ê¸°ë³¸ ì´ë¯¸ì§€ ë°˜í™˜ (ì„ íƒì‚¬í•­)
    raise HTTPException(status_code=404, detail="ì¸ë„¤ì¼ì„ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")


@router.patch("/{video_id}", response_model=VideoResponse)
async def update_video(
    video_id: int,
    description: str = Form(None),
    db: Session = Depends(get_db)
):
    """ë¹„ë””ì˜¤ ì •ë³´ ìˆ˜ì •"""
    
    video = db.query(Video).filter(Video.id == video_id).first()
    if not video:
        raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    if description is not None:
        video.description = description.strip() if description.strip() else None
    
    try:
        db.commit()
        db.refresh(video)
        
        video_response = VideoResponse.from_orm(video)
        video_response.has_analysis = len(video.analyses) > 0
        
        return video_response
        
    except Exception as e:
        db.rollback()
        raise HTTPException(status_code=400, detail=f"ë¹„ë””ì˜¤ ì •ë³´ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}")


@router.delete("/{video_id}")
async def delete_video(video_id: int, db: Session = Depends(get_db)):
    """ë¹„ë””ì˜¤ ì‚­ì œ"""
    
    video = db.query(Video).filter(Video.id == video_id).first()
    if not video:
        raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    file_path = video.file_path
    original_filename = video.original_filename
    
    try:
        # ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‚­ì œ
        db.delete(video)
        db.commit()
        
        # íŒŒì¼ ì‹œìŠ¤í…œì—ì„œ íŒŒì¼ ì‚­ì œ
        if os.path.exists(file_path):
            try:
                os.remove(file_path)
            except Exception as e:
                print(f"íŒŒì¼ ì‚­ì œ ì‹¤íŒ¨ (ë¬´ì‹œë¨): {e}")
        
        # ì¸ë„¤ì¼ ì‚­ì œ
        thumbnail_path = os.path.join(settings.UPLOAD_FOLDER, "thumbnails", f"{video_id}.jpg")
        if os.path.exists(thumbnail_path):
            try:
                os.remove(thumbnail_path)
            except Exception as e:
                print(f"ì¸ë„¤ì¼ ì‚­ì œ ì‹¤íŒ¨ (ë¬´ì‹œë¨): {e}")
        
        return {
            "message": "ë¹„ë””ì˜¤ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.",
            "deleted_video_id": video_id,
            "filename": original_filename
        }
        
    except Exception as e:
        db.rollback()
        raise HTTPException(status_code=400, detail=f"ë¹„ë””ì˜¤ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}")


@router.get("/")
async def list_all_videos(
    skip: int = 0,
    limit: int = 50,
    marker_id: int = None,
    uploaded_by: str = None,
    db: Session = Depends(get_db)
):
    """ëª¨ë“  ë¹„ë””ì˜¤ ëª©ë¡ ì¡°íšŒ (ê´€ë¦¬ììš©)"""
    
    query = db.query(Video)
    
    if marker_id:
        query = query.filter(Video.marker_id == marker_id)
    
    if uploaded_by:
        query = query.filter(Video.uploaded_by.ilike(f"%{uploaded_by}%"))
    
    videos = query.order_by(Video.created_at.desc()).offset(skip).limit(limit).all()
    
    result = []
    for video in videos:
        video_data = VideoResponse.from_orm(video)
        video_data.has_analysis = len(video.analyses) > 0
        result.append({
            "video": video_data,
            "marker_title": video.marker.title if video.marker else None
        })
    
    return {
        "total": query.count(),
        "videos": result
    }
@router.get("/{video_id}")
async def get_video_info(video_id: int, db: Session = Depends(get_db)):
    """ë¹„ë””ì˜¤ ì •ë³´ ì¡°íšŒ (ë””ë²„ê¹…ìš©)"""
    
    video = db.query(Video).filter(Video.id == video_id).first()
    if not video:
        raise HTTPException(status_code=404, detail="ë¹„ë””ì˜¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    file_exists = os.path.exists(video.file_path) if video.file_path else False
    
    return {
        "id": video.id,
        "filename": video.filename,
        "original_filename": video.original_filename,
        "file_path": video.file_path,
        "file_exists": file_exists,
        "file_size": video.file_size,
        "duration": video.duration,
        "width": video.width,
        "height": video.height,
        "fps": video.fps,
        "marker_id": video.marker_id,
        "uploaded_by": video.uploaded_by,
        "created_at": video.created_at,
        "has_analysis": len(video.analyses) > 0,
        "stream_url": f"/api/videos/{video.id}/stream"
    }
```

---

### 21. code_collector.py

- **ê²½ë¡œ:** `code_collector.py`
- **í¬ê¸°:** 6,472 characters
- **íƒ€ì…:** .py

```python
#!/usr/bin/env python3
import os
import pathlib
from typing import List, Dict, Optional

def collect_project_code(
    project_dir: str,
    output_file: str = "collected_code.md",
    include_extensions: List[str] = None,
    exclude_dirs: List[str] = None,
    max_file_size: int = 100000  # 100KB
) -> None:
    """
    í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ì˜ ì½”ë“œë¥¼ ìˆ˜ì§‘í•˜ì—¬ LLM ì…ë ¥ìš© ë§ˆí¬ë‹¤ìš´ íŒŒì¼ë¡œ ìƒì„±
    
    Args:
        project_dir: í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬
        output_file: ì¶œë ¥ íŒŒì¼ëª…
        include_extensions: í¬í•¨í•  íŒŒì¼ í™•ì¥ì (Noneì´ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©)
        exclude_dirs: ì œì™¸í•  ë””ë ‰í† ë¦¬ ëª©ë¡
        max_file_size: ìµœëŒ€ íŒŒì¼ í¬ê¸° (ë°”ì´íŠ¸)
    """
    
    if include_extensions is None:
        include_extensions = [
            '.py', '.ts', '.tsx', '.js', '.jsx',  # ì£¼ìš” ì†ŒìŠ¤ì½”ë“œ
            '.sql', '.json', '.yml', '.yaml',     # ì„¤ì • ë° ë°ì´í„°
            '.md', '.txt'                         # ë¬¸ì„œ
        ]
    
    if exclude_dirs is None:
        exclude_dirs = [
            'node_modules', 'venv', '__pycache__', '.git',
            'uploads', 'analysis_results', 'videos', 'public',
            '.next', 'dist', 'build'
        ]
    
    collected_files = []
    
    # íŒŒì¼ ìˆ˜ì§‘
    for root, dirs, files in os.walk(project_dir):
        # ì œì™¸ ë””ë ‰í† ë¦¬ í•„í„°ë§
        dirs[:] = [d for d in dirs if d not in exclude_dirs]
        
        for file in files:
            if any(file.endswith(ext) for ext in include_extensions):
                file_path = os.path.join(root, file)
                rel_path = os.path.relpath(file_path, project_dir)
                
                try:
                    # íŒŒì¼ í¬ê¸° í™•ì¸
                    if os.path.getsize(file_path) > max_file_size:
                        print(f"íŒŒì¼ í¬ê¸°ê°€ í¼ (ê±´ë„ˆëœ€): {rel_path}")
                        continue
                    
                    with open(file_path, 'r', encoding='utf-8', errors='ignore') as f:
                        content = f.read()
                    
                    # íŒŒì¼ ì •ë³´ ìˆ˜ì§‘
                    collected_files.append({
                        'filename': file,
                        'path': rel_path,
                        'content': content,
                        'extension': pathlib.Path(file).suffix,
                        'size': len(content)
                    })
                    
                except Exception as e:
                    print(f"íŒŒì¼ ì½ê¸° ì˜¤ë¥˜: {rel_path} - {e}")
    
    # ìš°ì„ ìˆœìœ„ë³„ ì •ë ¬
    def get_priority(file_info):
        priority_map = {
            # ì„¤ì • íŒŒì¼ë“¤
            'main.py': 1, 'app.py': 1, 'App.tsx': 1, 'index.tsx': 1,
            'package.json': 2, 'requirements.txt': 2, 'docker-compose.yml': 2,
            # ëª¨ë¸ ë° ìŠ¤í‚¤ë§ˆ
            '.py': 3 if 'models' in file_info['path'] else 5,
            '.ts': 3 if 'types' in file_info['path'] else 5,
            # API ë° ì„œë¹„ìŠ¤
            '.py': 4 if 'api' in file_info['path'] or 'services' in file_info['path'] else 5,
            '.ts': 4 if 'services' in file_info['path'] else 5,
            # ê¸°íƒ€
            '.md': 10, '.txt': 10, '.json': 6, '.sql': 7
        }
        
        # íŒŒì¼ëª… ê¸°ì¤€ ìš°ì„ ìˆœìœ„
        if file_info['filename'] in priority_map:
            return priority_map[file_info['filename']]
        
        # í™•ì¥ì ê¸°ì¤€ ìš°ì„ ìˆœìœ„
        ext = file_info['extension']
        if ext in priority_map:
            return priority_map[ext]
        
        return 5  # ê¸°ë³¸ ìš°ì„ ìˆœìœ„
    
    collected_files.sort(key=get_priority)
    
    # ë§ˆí¬ë‹¤ìš´ íŒŒì¼ ìƒì„±
    with open(output_file, 'w', encoding='utf-8') as f:
        f.write("# í”„ë¡œì íŠ¸ ì½”ë“œ ìˆ˜ì§‘ ê²°ê³¼\n\n")
        f.write(f"**í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬:** {project_dir}\n")
        f.write(f"**ìˆ˜ì§‘ëœ íŒŒì¼ ìˆ˜:** {len(collected_files)}\n")
        f.write(f"**ìƒì„± ì¼ì‹œ:** {os.popen('date').read().strip()}\n\n")
        
        # íŒŒì¼ ëª©ë¡ ìš”ì•½
        f.write("## ğŸ“‹ íŒŒì¼ ëª©ë¡\n\n")
        for i, file_info in enumerate(collected_files, 1):
            f.write(f"{i}. **{file_info['filename']}** - `{file_info['path']}` ({file_info['size']:,} chars)\n")
        f.write("\n---\n\n")
        
        # ê° íŒŒì¼ ìƒì„¸ ë‚´ìš©
        f.write("## ğŸ“ íŒŒì¼ ìƒì„¸ ë‚´ìš©\n\n")
        
        for i, file_info in enumerate(collected_files, 1):
            f.write(f"### {i}. {file_info['filename']}\n\n")
            f.write(f"- **ê²½ë¡œ:** `{file_info['path']}`\n")
            f.write(f"- **í¬ê¸°:** {file_info['size']:,} characters\n")
            f.write(f"- **íƒ€ì…:** {file_info['extension']}\n\n")
            
            # ì–¸ì–´ë³„ ì½”ë“œ ë¸”ë¡
            lang_map = {
                '.py': 'python', '.ts': 'typescript', '.tsx': 'tsx',
                '.js': 'javascript', '.jsx': 'jsx', '.sql': 'sql',
                '.json': 'json', '.yml': 'yaml', '.yaml': 'yaml',
                '.md': 'markdown', '.txt': 'text'
            }
            
            lang = lang_map.get(file_info['extension'], 'text')
            f.write(f"```{lang}\n{file_info['content']}\n```\n\n")
            f.write("---\n\n")
    
    print(f"âœ… ì½”ë“œ ìˆ˜ì§‘ ì™„ë£Œ!")
    print(f"ğŸ“„ ì¶œë ¥ íŒŒì¼: {output_file}")
    print(f"ğŸ“Š ì´ {len(collected_files)}ê°œ íŒŒì¼ ìˆ˜ì§‘")
    
    # í†µê³„ ì •ë³´
    ext_count = {}
    for file_info in collected_files:
        ext = file_info['extension']
        ext_count[ext] = ext_count.get(ext, 0) + 1
    
    print(f"ğŸ“ˆ íŒŒì¼ íƒ€ì…ë³„ í†µê³„:")
    for ext, count in sorted(ext_count.items()):
        print(f"  {ext}: {count}ê°œ")


def collect_road_maintenance_project(project_dir: str = "."):
    """ë„ë¡œ ìœ ì§€ë³´ìˆ˜ í”„ë¡œì íŠ¸ ì „ìš© ì½”ë“œ ìˆ˜ì§‘"""
    
    # í”„ë¡œì íŠ¸ë³„ ë§ì¶¤ ì„¤ì •
    include_extensions = [
        '.py', '.ts', '.tsx', '.js', '.jsx',
        '.sql', '.json', '.yml', '.yaml', '.md'
    ]
    
    exclude_dirs = [
        'node_modules', 'venv', '__pycache__', '.git',
        'uploads', 'analysis_results', 'videos', 'public',
        'logo192.png', 'logo512.png', 'favicon.ico'
    ]
    
    collect_project_code(
        project_dir=project_dir,
        output_file="road_maintenance_code.md",
        include_extensions=include_extensions,
        exclude_dirs=exclude_dirs,
        max_file_size=200000  # 200KBë¡œ ì¦ê°€ (AI ëª¨ë¸ íŒŒì¼ ê³ ë ¤)
    )


if __name__ == "__main__":
    import argparse
    
    parser = argparse.ArgumentParser(description='í”„ë¡œì íŠ¸ ì½”ë“œë¥¼ LLM ì…ë ¥ìš©ìœ¼ë¡œ ìˆ˜ì§‘')
    parser.add_argument('--dir', '-d', default='.', help='í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ ê²½ë¡œ')
    parser.add_argument('--output', '-o', default='collected_code.md', help='ì¶œë ¥ íŒŒì¼ëª…')
    parser.add_argument('--road-maintenance', action='store_true', 
                       help='ë„ë¡œ ìœ ì§€ë³´ìˆ˜ í”„ë¡œì íŠ¸ ì „ìš© ì„¤ì • ì‚¬ìš©')
    
    args = parser.parse_args()
    
    if args.road_maintenance:
        collect_road_maintenance_project(args.dir)
    else:
        collect_project_code(args.dir, args.output)
```

---

### 22. postcss.config.js

- **ê²½ë¡œ:** `frontend/postcss.config.js`
- **í¬ê¸°:** 82 characters
- **íƒ€ì…:** .js

```javascript
module.exports = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}

```

---

### 23. tailwind.config.js

- **ê²½ë¡œ:** `frontend/tailwind.config.js`
- **í¬ê¸°:** 1,356 characters
- **íƒ€ì…:** .js

```javascript
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./src/**/*.{js,jsx,ts,tsx}",
    "./public/index.html"
  ],
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#f8faff',
          100: '#e8f2ff',
          200: '#cce5ff',
          300: '#99ccff',
          400: '#66b3ff',
          500: '#667eea',
          600: '#5a67d8',
          700: '#4c51bf',
          800: '#434190',
          900: '#3c366b',
        },
        secondary: {
          50: '#fdf4ff',
          100: '#fae8ff',
          200: '#f5d0fe',
          300: '#f0abfc',
          400: '#e879f9',
          500: '#764ba2',
          600: '#c026d3',
          700: '#a21caf',
          800: '#86198f',
          900: '#701a75',
        }
      },
      fontFamily: {
        sans: ['Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'sans-serif'],
      },
      animation: {
        'fadeIn': 'fadeIn 0.5s ease-in-out',
        'slideUp': 'slideUp 0.3s ease-out',
        'spin-slow': 'spin 2s linear infinite',
      },
      keyframes: {
        fadeIn: {
          '0%': { opacity: '0' },
          '100%': { opacity: '1' },
        },
        slideUp: {
          '0%': { transform: 'translateY(20px)', opacity: '0' },
          '100%': { transform: 'translateY(0)', opacity: '1' },
        }
      }
    },
  },
  plugins: [],
}

```

---

### 24. setupTests.ts

- **ê²½ë¡œ:** `frontend/src/setupTests.ts`
- **í¬ê¸°:** 241 characters
- **íƒ€ì…:** .ts

```typescript
// jest-dom adds custom jest matchers for asserting on DOM nodes.
// allows you to do things like:
// expect(element).toHaveTextContent(/react/i)
// learn more: https://github.com/testing-library/jest-dom
import '@testing-library/jest-dom';

```

---

### 25. react-app-env.d.ts

- **ê²½ë¡œ:** `frontend/src/react-app-env.d.ts`
- **í¬ê¸°:** 40 characters
- **íƒ€ì…:** .ts

```typescript
/// <reference types="react-scripts" />

```

---

### 26. reportWebVitals.ts

- **ê²½ë¡œ:** `frontend/src/reportWebVitals.ts`
- **í¬ê¸°:** 388 characters
- **íƒ€ì…:** .ts

```typescript
const reportWebVitals = (onPerfEntry?: (metric: any) => void) => {
  if (onPerfEntry && onPerfEntry instanceof Function) {
    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {
      getCLS(onPerfEntry);
      getFID(onPerfEntry);
      getFCP(onPerfEntry);
      getLCP(onPerfEntry);
      getTTFB(onPerfEntry);
    });
  }
};

export default reportWebVitals;

```

---

### 27. App.test.tsx

- **ê²½ë¡œ:** `frontend/src/App.test.tsx`
- **í¬ê¸°:** 241 characters
- **íƒ€ì…:** .tsx

```tsx
import React from 'react';
import { render, screen } from '@testing-library/react';
import App from './App';

test('renders app without crashing', () => {
  render(<App />);
  // ê¸°ë³¸ì ì¸ ë Œë”ë§ í…ŒìŠ¤íŠ¸
  expect(document.body).toBeInTheDocument();
});

```

---

### 28. helpers.ts

- **ê²½ë¡œ:** `frontend/src/utils/helpers.ts`
- **í¬ê¸°:** 3,530 characters
- **íƒ€ì…:** .ts

```typescript
// frontend/src/utils/helpers.ts
import { format, formatDistanceToNow } from 'date-fns';
import { ko } from 'date-fns/locale';

export const formatDate = (dateString: string): string => {
  return format(new Date(dateString), 'yyyy.MM.dd HH:mm', { locale: ko });
};

export const formatDateShort = (dateString: string): string => {
  return format(new Date(dateString), 'MM.dd', { locale: ko });
};

export const formatRelativeTime = (dateString: string): string => {
  return formatDistanceToNow(new Date(dateString), { addSuffix: true, locale: ko });
};

export const formatFileSize = (bytes: number): string => {
  if (bytes === 0) return '0 Bytes';
  
  const k = 1024;
  const sizes = ['Bytes', 'KB', 'MB', 'GB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  
  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
};

export const isVideoFile = (file: File): boolean => {
  const allowedTypes = ['video/mp4', 'video/mov', 'video/avi', 'video/mkv', 'video/webm'];
  return allowedTypes.includes(file.type);
};

export const validateVideoFile = (file: File, maxSize: number = 100 * 1024 * 1024): { valid: boolean; error?: string } => {
  if (!isVideoFile(file)) {
    return { valid: false, error: 'ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¹„ë””ì˜¤ í˜•ì‹ì…ë‹ˆë‹¤.' };
  }
  
  if (file.size > maxSize) {
    return { valid: false, error: `íŒŒì¼ í¬ê¸°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤. ìµœëŒ€ ${formatFileSize(maxSize)}` };
  }
  
  return { valid: true };
};

export const formatDuration = (seconds: number): string => {
  const mins = Math.floor(seconds / 60);
  const secs = Math.floor(seconds % 60);
  return `${mins}:${secs.toString().padStart(2, '0')}`;
};

export const formatCurrency = (amount: number): string => {
  return new Intl.NumberFormat('ko-KR', {
    style: 'currency',
    currency: 'KRW'
  }).format(amount);
};

export const formatNumber = (num: number): string => {
  return new Intl.NumberFormat('ko-KR').format(num);
};

export const validateEmail = (email: string): boolean => {
  const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return re.test(email);
};

export const validateCoordinate = (lat: number, lng: number): boolean => {
  return lat >= -90 && lat <= 90 && lng >= -180 && lng <= 180;
};

export const truncateText = (text: string, maxLength: number): string => {
  if (text.length <= maxLength) return text;
  return text.slice(0, maxLength) + '...';
};

export const getStatusBadgeClass = (status: string, colorMap: Record<string, string>): string => {
  return `inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${colorMap[status] || 'bg-gray-100 text-gray-800'}`;
};

export const debounce = <T extends (...args: any[]) => any>(
  func: T,
  wait: number
): ((...args: Parameters<T>) => void) => {
  let timeout: NodeJS.Timeout;
  return (...args: Parameters<T>) => {
    clearTimeout(timeout);
    timeout = setTimeout(() => func(...args), wait);
  };
};

export const downloadFile = (url: string, filename: string): void => {
  const link = document.createElement('a');
  link.href = url;
  link.download = filename;
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
};

export const copyToClipboard = async (text: string): Promise<boolean> => {
  try {
    await navigator.clipboard.writeText(text);
    return true;
  } catch (err) {
    console.error('Failed to copy text: ', err);
    return false;
  }
};

export const getInitials = (name: string): string => {
  return name
    .split(' ')
    .map(word => word.charAt(0))
    .join('')
    .toUpperCase()
    .slice(0, 2);
};
```

---

### 29. constants.ts

- **ê²½ë¡œ:** `frontend/src/utils/constants.ts`
- **í¬ê¸°:** 1,483 characters
- **íƒ€ì…:** .ts

```typescript
// frontend/src/utils/constants.ts
import { MarkerStatus, MarkerPriority, IssueType } from '../types/marker';
import { AnalysisStatus } from '../types/analysis';

export const MARKER_STATUS_LABELS = {
  [MarkerStatus.PENDING]: 'ì²˜ë¦¬ ëŒ€ê¸°',
  [MarkerStatus.PROGRESS]: 'ì‘ì—… ì¤‘',
  [MarkerStatus.COMPLETED]: 'ì™„ë£Œ'
};

export const MARKER_PRIORITY_LABELS = {
  [MarkerPriority.URGENT]: 'ê¸´ê¸‰',
  [MarkerPriority.HIGH]: 'ë†’ìŒ',
  [MarkerPriority.NORMAL]: 'ë³´í†µ'
};

export const ISSUE_TYPE_LABELS = {
  [IssueType.POTHOLE]: 'ë°©ì‚¬ ê· ì—´',
  [IssueType.CRACK]: 'ë„ë¡œ ê· ì—´',
  [IssueType.SIGN_DAMAGE]: 'í‘œì§€íŒ ì†ìƒ'
};

export const ANALYSIS_STATUS_LABELS = {
  [AnalysisStatus.PENDING]: 'ë¶„ì„ ëŒ€ê¸°',
  [AnalysisStatus.PROCESSING]: 'ë¶„ì„ ì¤‘',
  [AnalysisStatus.COMPLETED]: 'ë¶„ì„ ì™„ë£Œ',
  [AnalysisStatus.FAILED]: 'ë¶„ì„ ì‹¤íŒ¨'
};

export const MARKER_STATUS_COLORS = {
  [MarkerStatus.PENDING]: 'bg-yellow-100 text-yellow-800',
  [MarkerStatus.PROGRESS]: 'bg-blue-100 text-blue-800',
  [MarkerStatus.COMPLETED]: 'bg-green-100 text-green-800'
};

export const MARKER_PRIORITY_COLORS = {
  [MarkerPriority.URGENT]: 'bg-red-100 text-red-800',
  [MarkerPriority.HIGH]: 'bg-orange-100 text-orange-800',
  [MarkerPriority.NORMAL]: 'bg-gray-100 text-gray-800'
};

export const ANALYSIS_STATUS_COLORS = {
  [AnalysisStatus.PENDING]: 'bg-gray-100 text-gray-800',
  [AnalysisStatus.PROCESSING]: 'bg-yellow-100 text-yellow-800',
  [AnalysisStatus.COMPLETED]: 'bg-green-100 text-green-800',
  [AnalysisStatus.FAILED]: 'bg-red-100 text-red-800'
};

```

---

### 30. analysis.ts

- **ê²½ë¡œ:** `frontend/src/types/analysis.ts`
- **í¬ê¸°:** 1,194 characters
- **íƒ€ì…:** .ts

```typescript
// frontend/src/types/analysis.ts
export enum AnalysisStatus {
    PENDING = 'pending',
    PROCESSING = 'processing',
    COMPLETED = 'completed',
    FAILED = 'failed'
  }
  
  export interface CrackDetail {
    crack_id: string;
    crack_type: string;
    length: number;
    width: number;
    area: number;
    severity: string;
    confidence: number;
  }
  
  export interface MaterialEstimation {
    asphalt_concrete: number;
    sealer: number;
    primer: number;
    mesh?: number;
    total_cost: number;
  }
  
  export interface SeverityAnalysis {
    overall_severity: string;
    risk_score: number;
    urgent_repairs_needed: boolean;
    estimated_repair_time: string;
  }
  
  export interface Analysis {
    id: number;
    marker_id: number;
    video_id: number;
    status: AnalysisStatus;
    progress: number;
    total_cracks_detected: number;
    total_crack_area: number;
    confidence_score: number;
    crack_details?: CrackDetail[];
    material_estimation?: MaterialEstimation;
    severity_analysis?: SeverityAnalysis;
    result_video_path?: string;
    error_message?: string;
    started_at?: string;
    completed_at?: string;
    created_at: string;
  }
```

---

### 31. dashboard.ts

- **ê²½ë¡œ:** `frontend/src/types/dashboard.ts`
- **í¬ê¸°:** 427 characters
- **íƒ€ì…:** .ts

```typescript
// frontend/src/types/dashboard.ts
export interface DashboardStats {
  total_markers: number;
  urgent_issues: number;
  weekly_completed: number;
  pending_markers: number;
  active_markers: number;
}

export interface Activity {
  id: number;
  type: string;
  message: string;
  user: string;
  location?: string;
  timestamp: string;
  marker_id?: number;
}

export interface RegionStat {
  name: string;
  count: number;
}
```

---

### 32. naver-maps.d.ts

- **ê²½ë¡œ:** `frontend/src/types/naver-maps.d.ts`
- **í¬ê¸°:** 4,882 characters
- **íƒ€ì…:** .ts

```typescript
// frontend/src/types/naver-maps.d.ts
// ë„¤ì´ë²„ ì§€ë„ API TypeScript íƒ€ì… ì •ì˜

declare global {
  interface Window {
    naver: any;
    navermap_authFailure?: () => void;
  }

  const naver: {
    maps: {
      // ì§€ë„ í´ë˜ìŠ¤
      Map: new (mapDiv: HTMLElement | string, mapOptions?: any) => NaverMap;
      
      // ì¢Œí‘œ í´ë˜ìŠ¤
      LatLng: new (lat: number, lng: number) => NaverLatLng;
      LatLngBounds: new () => NaverLatLngBounds;
      
      // ë§ˆì»¤ í´ë˜ìŠ¤
      Marker: new (options: NaverMarkerOptions) => NaverMarker;
      
      // ì •ë³´ì°½ í´ë˜ìŠ¤
      InfoWindow: new (options: NaverInfoWindowOptions) => NaverInfoWindow;
      
      // ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤
      Size: new (width: number, height: number) => NaverSize;
      Point: new (x: number, y: number) => NaverPoint;
      
      // ì´ë²¤íŠ¸ í´ë˜ìŠ¤
      Event: {
        addListener: (target: any, eventName: string, handler: Function) => any;
        removeListener: (listener: any) => void;
        trigger: (target: any, eventName: string, ...args: any[]) => void;
      };
      
      // ì§€ë„ íƒ€ì…
      MapTypeId: {
        NORMAL: string;
        TERRAIN: string;
        SATELLITE: string;
        HYBRID: string;
      };
    };
  };
}

// ë„¤ì´ë²„ ì§€ë„ ì¸í„°í˜ì´ìŠ¤ ì •ì˜
export interface NaverMap {
  setCenter(latlng: NaverLatLng): void;
  getCenter(): NaverLatLng;
  setZoom(zoom: number): void;
  getZoom(): number;
  fitBounds(bounds: NaverLatLngBounds, padding?: any): void;
  setMapTypeId(mapTypeId: string): void;
  getMapTypeId(): string;
  addPane(name: string, elementOrZIndex: HTMLElement | number): void;
  removePane(name: string): void;
  refresh(): void;
  autoResize(): void;
  setSize(size: NaverSize): void;
  getSize(): NaverSize;
  destroy(): void;
}

export interface NaverLatLng {
  lat(): number;
  lng(): number;
  equals(latlng: NaverLatLng): boolean;
  toString(): string;
  clone(): NaverLatLng;
}

export interface NaverLatLngBounds {
  extend(latlng: NaverLatLng): void;
  union(bounds: NaverLatLngBounds): NaverLatLngBounds;
  intersects(bounds: NaverLatLngBounds): boolean;
  isEmpty(): boolean;
  getNE(): NaverLatLng;
  getSW(): NaverLatLng;
  getCenter(): NaverLatLng;
  hasLatLng(latlng: NaverLatLng): boolean;
}

export interface NaverMarkerOptions {
  position: NaverLatLng;
  map?: NaverMap;
  icon?: string | NaverMarkerIcon;
  title?: string;
  cursor?: string;
  clickable?: boolean;
  draggable?: boolean;
  visible?: boolean;
  zIndex?: number;
  animation?: number;
}

export interface NaverMarkerIcon {
  url?: string;
  content?: string;
  size?: NaverSize;
  scaledSize?: NaverSize;
  origin?: NaverPoint;
  anchor?: NaverPoint;
}

export interface NaverMarker {
  setPosition(position: NaverLatLng): void;
  getPosition(): NaverLatLng;
  setMap(map: NaverMap | null): void;
  getMap(): NaverMap;
  setIcon(icon: string | NaverMarkerIcon): void;
  getIcon(): string | NaverMarkerIcon;
  setTitle(title: string): void;
  getTitle(): string;
  setVisible(visible: boolean): void;
  getVisible(): boolean;
  setZIndex(zIndex: number): void;
  getZIndex(): number;
  setClickable(clickable: boolean): void;
  getClickable(): boolean;
  setDraggable(draggable: boolean): void;
  getDraggable(): boolean;
  setCursor(cursor: string): void;
  getCursor(): string;
}

export interface NaverInfoWindowOptions {
  content: string;
  maxWidth?: number;
  backgroundColor?: string;
  borderColor?: string;
  borderWidth?: number;
  anchorSize?: NaverSize;
  anchorSkew?: boolean;
  anchorColor?: string;
  pixelOffset?: NaverPoint;
  position?: NaverLatLng;
  disableAutoPan?: boolean;
  disableAnchor?: boolean;
  zIndex?: number;
}

export interface NaverInfoWindow {
  open(map: NaverMap, anchor?: NaverMarker | NaverLatLng): void;
  close(): void;
  getMap(): NaverMap;
  setContent(content: string): void;
  getContent(): string;
  setPosition(position: NaverLatLng): void;
  getPosition(): NaverLatLng;
  setZIndex(zIndex: number): void;
  getZIndex(): number;
}

export interface NaverSize {
  width: number;
  height: number;
  equals(size: NaverSize): boolean;
}

export interface NaverPoint {
  x: number;
  y: number;
  equals(point: NaverPoint): boolean;
  clone(): NaverPoint;
}

// ì§€ë„ ì˜µì…˜ ì¸í„°í˜ì´ìŠ¤
export interface NaverMapOptions {
  center?: NaverLatLng;
  zoom?: number;
  mapTypeControl?: boolean;
  mapDataControl?: boolean;
  logoControl?: boolean;
  scaleControl?: boolean;
  zoomControl?: boolean;
  minZoom?: number;
  maxZoom?: number;
  draggable?: boolean;
  pinchZoom?: boolean;
  scrollWheel?: boolean;
  keyboardShortcuts?: boolean;
  disableDoubleTapZoom?: boolean;
  disableDoubleClickZoom?: boolean;
  disableTwoFingerTapZoom?: boolean;
  size?: NaverSize;
  mapTypeId?: string;
}

// ì´ë²¤íŠ¸ íƒ€ì…
export interface NaverMapEvent {
  coord: NaverLatLng;
  point: NaverPoint;
  domEvent: Event;
}

export interface NaverMarkerEvent {
  coord: NaverLatLng;
  point: NaverPoint;
  domEvent: Event;
}

export {};
```

---

### 33. video.ts

- **ê²½ë¡œ:** `frontend/src/types/video.ts`
- **í¬ê¸°:** 468 characters
- **íƒ€ì…:** .ts

```typescript
// frontend/src/types/video.ts
export interface Video {
    id: number;
    filename: string;
    original_filename: string;
    file_size: number;
    duration?: number;
    width?: number;
    height?: number;
    fps?: number;
    marker_id: number;
    uploaded_by: string;
    description?: string;
    created_at: string;
    has_analysis: boolean;
  }
  
  export interface VideoUpload {
    file: File;
    description?: string;
    uploaded_by: string;
  }
  
```

---

### 34. marker.ts

- **ê²½ë¡œ:** `frontend/src/types/marker.ts`
- **í¬ê¸°:** 1,232 characters
- **íƒ€ì…:** .ts

```typescript
// frontend/src/types/marker.ts
export enum MarkerStatus {
    PENDING = 'pending',
    PROGRESS = 'progress',
    COMPLETED = 'completed'
  }
  
  export enum MarkerPriority {
    URGENT = 'urgent',
    HIGH = 'high',
    NORMAL = 'normal'
  }
  
  export enum IssueType {
    POTHOLE = 'pothole',
    CRACK = 'crack',
    SIGN_DAMAGE = 'sign_damage'
  }
  
  export interface Marker {
    id: number;
    title: string;
    description?: string;
    latitude: number;
    longitude: number;
    address?: string;
    road_name?: string;
    issue_type: IssueType;
    status: MarkerStatus;
    priority: MarkerPriority;
    assigned_to?: string;
    created_by: string;
    created_at: string;
    updated_at?: string;
    video_count: number;
    analysis_count: number;
  }
  
  export interface MarkerCreate {
    title: string;
    description?: string;
    latitude: number;
    longitude: number;
    address?: string;
    road_name?: string;
    issue_type: IssueType;
    priority: MarkerPriority;
    assigned_to?: string;
    created_by: string;
  }
  
  export interface MarkerUpdate {
    title?: string;
    description?: string;
    status?: MarkerStatus;
    priority?: MarkerPriority;
    assigned_to?: string;
  }
```

---

### 35. VideoComparisonPlayer.tsx

- **ê²½ë¡œ:** `frontend/src/components/video/VideoComparisonPlayer.tsx`
- **í¬ê¸°:** 13,640 characters
- **íƒ€ì…:** .tsx

```tsx
import React, { useState, useEffect } from 'react';
import { Analysis } from '../../types/analysis';
import LoadingSpinner from '../common/LoadingSpinner';

interface VideoComparisonData {
  analysis_id: number;
  status: string;
  progress: number;
  original_video: {
    id: number;
    filename: string;
    stream_url: string;
    duration: number;
    size: number;
  };
  result_video: {
    available: boolean;
    stream_url: string | null;
  };
  analysis_summary?: {
    total_cracks: number;
    total_area: number;
    confidence: number;
    severity: string | null;
  };
}

interface VideoComparisonPlayerProps {
  analysis: Analysis;
}

const VideoComparisonPlayer: React.FC<VideoComparisonPlayerProps> = ({ analysis }) => {
  const [comparisonData, setComparisonData] = useState<VideoComparisonData | null>(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [activeTab, setActiveTab] = useState<'original' | 'result'>('original');

  useEffect(() => {
    fetchComparisonData();
  }, [analysis.id]);

  const fetchComparisonData = async () => {
    try {
      setLoading(true);
      setError(null);
      
      console.log(`ğŸ” ë¹„êµ ë°ì´í„° ìš”ì²­: /api/analysis/${analysis.id}/comparison`);
      
      const response = await fetch(`/api/analysis/${analysis.id}/comparison`);
      
      console.log(`ğŸ“¡ ì‘ë‹µ ìƒíƒœ: ${response.status} ${response.statusText}`);
      
      if (!response.ok) {
        const errorText = await response.text();
        console.error(`âŒ API ì˜¤ë¥˜ ì‘ë‹µ:`, errorText);
        
        if (response.status === 404) {
          throw new Error('ë¶„ì„ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        } else if (response.status === 500) {
          throw new Error('ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        } else {
          throw new Error(`API ì˜¤ë¥˜: ${response.status} ${response.statusText}`);
        }
      }
      
      const contentType = response.headers.get('content-type');
      console.log(`ğŸ“‹ ì‘ë‹µ Content-Type: ${contentType}`);
      
      if (!contentType || !contentType.includes('application/json')) {
        const textResponse = await response.text();
        console.error(`âŒ JSONì´ ì•„ë‹Œ ì‘ë‹µ:`, textResponse);
        throw new Error('ì„œë²„ì—ì„œ ì˜¬ë°”ë¥´ì§€ ì•Šì€ ì‘ë‹µ í˜•ì‹ì„ ë°˜í™˜í–ˆìŠµë‹ˆë‹¤.');
      }
      
      const data = await response.json();
      console.log(`âœ… ë¹„êµ ë°ì´í„° ìˆ˜ì‹ :`, data);
      
      setComparisonData(data);
      
      // ê²°ê³¼ ë¹„ë””ì˜¤ê°€ ìˆìœ¼ë©´ ê²°ê³¼ íƒ­ìœ¼ë¡œ ìë™ ì „í™˜
      if (data.result_video && data.result_video.available) {
        setActiveTab('result');
      }
    } catch (err) {
      console.error(`ğŸ’¥ ë¹„êµ ë°ì´í„° í˜ì¹˜ ì˜¤ë¥˜:`, err);
      setError(err instanceof Error ? err.message : 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    } finally {
      setLoading(false);
    }
  };

  if (loading) {
    return (
      <div className="flex justify-center py-8">
        <LoadingSpinner text="ë¹„ë””ì˜¤ ë°ì´í„° ë¡œë”© ì¤‘..." />
      </div>
    );
  }

  if (error) {
    return (
      <div className="bg-red-50 border border-red-200 rounded-lg p-4">
        <p className="text-red-700">{error}</p>
        <button 
          onClick={fetchComparisonData}
          className="mt-2 text-red-600 hover:text-red-800 underline"
        >
          ë‹¤ì‹œ ì‹œë„
        </button>
      </div>
    );
  }

  if (!comparisonData) {
    return null;
  }

  const isAnalysisComplete = comparisonData.status === 'completed';
  const isAnalysisInProgress = comparisonData.status === 'processing';

  return (
    <div className="space-y-6">
      {/* ë¶„ì„ ìƒíƒœ í‘œì‹œ */}
      <div className="bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4">
        <div className="flex items-center justify-between mb-2">
          <h3 className="text-lg font-semibold text-gray-900">ğŸ¤– AI ë¶„ì„ ìƒíƒœ</h3>
          <div className="flex items-center space-x-2">
            {isAnalysisInProgress && (
              <div className="animate-spin w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full"></div>
            )}
            <span className={`px-3 py-1 rounded-full text-sm font-medium ${
              isAnalysisComplete 
                ? 'bg-green-100 text-green-800' 
                : isAnalysisInProgress 
                ? 'bg-yellow-100 text-yellow-800'
                : 'bg-gray-100 text-gray-800'
            }`}>
              {isAnalysisComplete ? 'ë¶„ì„ ì™„ë£Œ' : isAnalysisInProgress ? 'ë¶„ì„ ì¤‘' : 'ëŒ€ê¸° ì¤‘'}
            </span>
          </div>
        </div>
        
        {isAnalysisInProgress && (
          <div className="mb-4">
            <div className="flex justify-between text-sm text-gray-600 mb-1">
              <span>ì§„í–‰ë¥ </span>
              <span>{comparisonData.progress.toFixed(1)}%</span>
            </div>
            <div className="w-full bg-gray-200 rounded-full h-2">
              <div 
                className="bg-blue-500 h-2 rounded-full transition-all duration-300"
                style={{ width: `${comparisonData.progress}%` }}
              ></div>
            </div>
          </div>
        )}

        {/* ë¶„ì„ ìš”ì•½ */}
        {comparisonData.analysis_summary && (
          <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
            <div className="text-center">
              <div className="text-2xl font-bold text-blue-600">
                {comparisonData.analysis_summary.total_cracks}
              </div>
              <div className="text-sm text-gray-600">ê²€ì¶œëœ ê· ì—´</div>
            </div>
            <div className="text-center">
              <div className="text-2xl font-bold text-purple-600">
                {comparisonData.analysis_summary.total_area.toFixed(1)}mÂ²
              </div>
              <div className="text-sm text-gray-600">ì´ ê· ì—´ ë©´ì </div>
            </div>
            <div className="text-center">
              <div className="text-2xl font-bold text-green-600">
                {(comparisonData.analysis_summary.confidence * 100).toFixed(0)}%
              </div>
              <div className="text-sm text-gray-600">í‰ê·  ì‹ ë¢°ë„</div>
            </div>
            <div className="text-center">
              <div className={`text-2xl font-bold ${
                comparisonData.analysis_summary.severity === 'ìœ„í—˜' 
                  ? 'text-red-600' 
                  : comparisonData.analysis_summary.severity === 'ë³´í†µ'
                  ? 'text-yellow-600'
                  : 'text-green-600'
              }`}>
                {comparisonData.analysis_summary.severity || 'N/A'}
              </div>
              <div className="text-sm text-gray-600">ì‹¬ê°ë„</div>
            </div>
          </div>
        )}
      </div>

      {/* ë¹„ë””ì˜¤ ë¹„êµ íƒ­ */}
      <div className="bg-white border border-gray-200 rounded-lg overflow-hidden">
        {/* íƒ­ í—¤ë” */}
        <div className="border-b border-gray-200 bg-gray-50">
          <div className="flex">
            <button
              onClick={() => setActiveTab('original')}
              className={`flex-1 px-6 py-3 text-sm font-medium transition-colors ${
                activeTab === 'original'
                  ? 'text-blue-600 border-b-2 border-blue-600 bg-white'
                  : 'text-gray-500 hover:text-gray-700'
              }`}
            >
              ğŸ“¹ ì›ë³¸ ì˜ìƒ
            </button>
            <button
              onClick={() => setActiveTab('result')}
              disabled={!comparisonData.result_video.available}
              className={`flex-1 px-6 py-3 text-sm font-medium transition-colors ${
                activeTab === 'result'
                  ? 'text-purple-600 border-b-2 border-purple-600 bg-white'
                  : comparisonData.result_video.available
                  ? 'text-gray-500 hover:text-gray-700'
                  : 'text-gray-300 cursor-not-allowed'
              }`}
            >
              ğŸ¤– ë¶„ì„ ê²°ê³¼ ì˜ìƒ 
              {!comparisonData.result_video.available && ' (ë¶„ì„ ì¤‘)'}
            </button>
          </div>
        </div>

        {/* ë¹„ë””ì˜¤ í”Œë ˆì´ì–´ */}
        <div className="p-6">
          {activeTab === 'original' && (
            <div className="space-y-4">
              <div className="bg-black rounded-lg overflow-hidden">
                <video
                  controls
                  className="w-full h-80"
                  key={`original-${comparisonData.original_video.id}`}
                  preload="metadata"
                  playsInline
                  style={{ maxHeight: '400px' }}
                  onLoadStart={() => console.log('ğŸ¬ ë¹„ë””ì˜¤ ë¡œë“œ ì‹œì‘')}
                  onLoadedMetadata={() => console.log('ğŸ“‹ ë¹„ë””ì˜¤ ë©”íƒ€ë°ì´í„° ë¡œë“œë¨')}
                  onCanPlay={() => console.log('âœ… ë¹„ë””ì˜¤ ì¬ìƒ ì¤€ë¹„ë¨')}
                  onError={(e) => {
                    console.error('âŒ ë¹„ë””ì˜¤ ë¡œë“œ ì˜¤ë¥˜:', e);
                    console.error('ë¹„ë””ì˜¤ URL:', comparisonData.original_video.stream_url);
                  }}
                >
                  <source 
                    src={comparisonData.original_video.stream_url} 
                    type="video/mp4"
                    onError={() => console.error('âŒ MP4 ì†ŒìŠ¤ ë¡œë“œ ì‹¤íŒ¨')}
                  />
                  ë¸Œë¼ìš°ì €ì—ì„œ ë¹„ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                </video>
                
                {/* ë””ë²„ê¹… ì •ë³´ */}
                <div className="mt-2 p-2 bg-gray-800 text-green-400 text-xs font-mono">
                  <div>ğŸ”— Stream URL: {comparisonData.original_video.stream_url}</div>
                  <div>ğŸ“ Video ID: {comparisonData.original_video.id}</div>
                  <div>ğŸ“ Size: {(comparisonData.original_video.size / (1024 * 1024)).toFixed(1)} MB</div>
                </div>
              </div>
              
              <div className="bg-blue-50 rounded-lg p-4">
                <h4 className="font-medium text-blue-900 mb-2">ğŸ“¹ ì›ë³¸ ì˜ìƒ ì •ë³´</h4>
                <div className="grid grid-cols-2 gap-4 text-sm">
                  <div>
                    <span className="text-blue-700">íŒŒì¼ëª…:</span>
                    <span className="ml-2 text-blue-900">{comparisonData.original_video.filename}</span>
                  </div>
                  <div>
                    <span className="text-blue-700">íŒŒì¼ í¬ê¸°:</span>
                    <span className="ml-2 text-blue-900">
                      {(comparisonData.original_video.size / (1024 * 1024)).toFixed(1)} MB
                    </span>
                  </div>
                  <div>
                    <span className="text-blue-700">ì¬ìƒ ì‹œê°„:</span>
                    <span className="ml-2 text-blue-900">
                      {comparisonData.original_video.duration 
                        ? `${Math.floor(comparisonData.original_video.duration / 60)}:${Math.floor(comparisonData.original_video.duration % 60).toString().padStart(2, '0')}`
                        : 'ì•Œ ìˆ˜ ì—†ìŒ'
                      }
                    </span>
                  </div>
                  <div>
                    <span className="text-blue-700">ìƒíƒœ:</span>
                    <span className="ml-2 text-green-600 font-medium">âœ… ì›¹ í˜¸í™˜</span>
                  </div>
                </div>
              </div>
            </div>
          )}

          {activeTab === 'result' && (
            <div className="space-y-4">
              {comparisonData.result_video.available ? (
                <>
                  <div className="bg-black rounded-lg overflow-hidden">
                    <video
                      controls
                      className="w-full h-80"
                      key={`result-${comparisonData.analysis_id}`}
                      preload="metadata"
                      playsInline
                      style={{ maxHeight: '400px' }}
                    >
                      <source src={comparisonData.result_video.stream_url!} type="video/mp4" />
                      ë¸Œë¼ìš°ì €ì—ì„œ ë¹„ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                    </video>
                  </div>
                  
                  <div className="bg-purple-50 rounded-lg p-4">
                    <h4 className="font-medium text-purple-900 mb-2">ğŸ¤– AI ë¶„ì„ ê²°ê³¼</h4>
                    <div className="space-y-2 text-sm text-purple-700">
                      <p>â€¢ ì´ ì˜ìƒì€ YOLO AI ëª¨ë¸ë¡œ ë¶„ì„ë˜ì–´ ê· ì—´ì´ ë¹¨ê°„ìƒ‰ ë°•ìŠ¤ë¡œ í‘œì‹œë©ë‹ˆë‹¤.</p>
                      <p>â€¢ ê° ë°•ìŠ¤ì—ëŠ” ì‹ ë¢°ë„ê°€ í•¨ê»˜ í‘œì‹œë©ë‹ˆë‹¤.</p>
                      <p>â€¢ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ìµœì í™”ëœ H.264 í˜•ì‹ìœ¼ë¡œ ì¸ì½”ë”©ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                    </div>
                  </div>
                </>
              ) : (
                <div className="text-center py-12">
                  <div className="text-6xl mb-4">ğŸ”„</div>
                  <h3 className="text-lg font-medium text-gray-900 mb-2">ë¶„ì„ ì§„í–‰ ì¤‘</h3>
                  <p className="text-gray-600 mb-4">
                    AIê°€ ì˜ìƒì„ ë¶„ì„í•˜ê³  ì›¹ í˜¸í™˜ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.
                  </p>
                  {isAnalysisInProgress && (
                    <div className="max-w-xs mx-auto">
                      <div className="flex justify-between text-sm text-gray-600 mb-1">
                        <span>ì§„í–‰ë¥ </span>
                        <span>{comparisonData.progress.toFixed(1)}%</span>
                      </div>
                      <div className="w-full bg-gray-200 rounded-full h-2">
                        <div 
                          className="bg-purple-500 h-2 rounded-full transition-all duration-300"
                          style={{ width: `${comparisonData.progress}%` }}
                        ></div>
                      </div>
                      <p className="text-xs text-gray-500 mt-2">
                        {comparisonData.progress < 80 ? 'í”„ë ˆì„ ë¶„ì„ ì¤‘...' : 'ì›¹ í˜¸í™˜ í˜•ì‹ ë³€í™˜ ì¤‘...'}
                      </p>
                    </div>
                  )}
                </div>
              )}
            </div>
          )}
        </div>
      </div>
    </div>
  );
};

export default VideoComparisonPlayer;
```

---

### 36. AIAnalysisResult.tsx

- **ê²½ë¡œ:** `frontend/src/components/video/AIAnalysisResult.tsx`
- **í¬ê¸°:** 10,248 characters
- **íƒ€ì…:** .tsx

```tsx
import React from 'react';
import { Analysis } from '../../types/analysis';

interface AIAnalysisResultProps {
  analysis: Analysis;
  onStartAnalysis?: () => void;
  canStartAnalysis?: boolean;
}

const AIAnalysisResult: React.FC<AIAnalysisResultProps> = ({ 
  analysis, 
  onStartAnalysis,
  canStartAnalysis = false 
}) => {
  const isCompleted = analysis.status === 'completed';
  const isProcessing = analysis.status === 'processing';
  const isFailed = analysis.status === 'failed';

  if (!isCompleted && !isProcessing && !isFailed) {
    return (
      <div className="bg-gray-50 rounded-lg p-6 text-center">
        <div className="text-4xl mb-3">ğŸ¤–</div>
        <h3 className="text-lg font-medium text-gray-900 mb-2">AI ë¶„ì„ ëŒ€ê¸° ì¤‘</h3>
        <p className="text-gray-600 mb-4">
          ì´ ì˜ìƒì€ ì•„ì§ AI ë¶„ì„ì´ ì‹œì‘ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
        </p>
        {canStartAnalysis && onStartAnalysis && (
          <button
            onClick={onStartAnalysis}
            className="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg transition-colors"
          >
            ğŸš€ AI ë¶„ì„ ì‹œì‘
          </button>
        )}
      </div>
    );
  }

  if (isProcessing) {
    return (
      <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-6">
        <div className="flex items-center mb-4">
          <div className="animate-spin w-6 h-6 border-2 border-yellow-500 border-t-transparent rounded-full mr-3"></div>
          <h3 className="text-lg font-semibold text-yellow-900">ğŸ¤– AI ë¶„ì„ ì§„í–‰ ì¤‘</h3>
        </div>
        
        <div className="mb-4">
          <div className="flex justify-between text-sm text-yellow-700 mb-1">
            <span>ì§„í–‰ë¥ </span>
            <span>{analysis.progress}%</span>
          </div>
          <div className="w-full bg-yellow-200 rounded-full h-3">
            <div 
              className="bg-yellow-500 h-3 rounded-full transition-all duration-500"
              style={{ width: `${analysis.progress}%` }}
            ></div>
          </div>
        </div>
        
        <p className="text-sm text-yellow-700">
          YOLO ëª¨ë¸ì´ ì˜ìƒì„ í”„ë ˆì„ë³„ë¡œ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.
        </p>
      </div>
    );
  }

  if (isFailed) {
    return (
      <div className="bg-red-50 border border-red-200 rounded-lg p-6">
        <div className="flex items-center mb-3">
          <span className="text-2xl mr-3">âŒ</span>
          <h3 className="text-lg font-semibold text-red-900">AI ë¶„ì„ ì‹¤íŒ¨</h3>
        </div>
        
        <p className="text-red-700 mb-3">
          {analysis.error_message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ë¡œ ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'}
        </p>
        
        {canStartAnalysis && onStartAnalysis && (
          <button
            onClick={onStartAnalysis}
            className="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-colors text-sm"
          >
            ğŸ”„ ë‹¤ì‹œ ë¶„ì„
          </button>
        )}
      </div>
    );
  }

  // ë¶„ì„ ì™„ë£Œ ìƒíƒœ
  return (
    <div className="space-y-6">
      {/* ë¶„ì„ ìš”ì•½ */}
      <div className="bg-gradient-to-br from-green-50 to-blue-50 rounded-lg p-6">
        <div className="flex items-center mb-4">
          <span className="text-2xl mr-3">âœ…</span>
          <h3 className="text-lg font-semibold text-gray-900">ğŸ¤– AI ë¶„ì„ ì™„ë£Œ</h3>
        </div>
        
        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
          <div className="text-center">
            <div className="text-2xl font-bold text-blue-600">{analysis.total_cracks_detected}</div>
            <div className="text-sm text-gray-600">ê²€ì¶œëœ ê· ì—´</div>
          </div>
          <div className="text-center">
            <div className="text-2xl font-bold text-purple-600">{analysis.total_crack_area.toFixed(1)}mÂ²</div>
            <div className="text-sm text-gray-600">ì´ ê· ì—´ ë©´ì </div>
          </div>
          <div className="text-center">
            <div className="text-2xl font-bold text-green-600">{(analysis.confidence_score * 100).toFixed(0)}%</div>
            <div className="text-sm text-gray-600">í‰ê·  ì‹ ë¢°ë„</div>
          </div>
          <div className="text-center">
            <div className="text-2xl font-bold text-orange-600">100%</div>
            <div className="text-sm text-gray-600">ë¶„ì„ ì™„ë£Œ</div>
          </div>
        </div>
      </div>
      
      {/* ì‹¬ê°ë„ ë¶„ì„ */}
      {analysis.severity_analysis && (
        <div className="bg-white border border-gray-200 rounded-lg p-6">
          <h4 className="font-semibold text-gray-900 mb-4 flex items-center">
            <span className="text-xl mr-2">âš ï¸</span>
            ì‹¬ê°ë„ ë¶„ì„
          </h4>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div className="space-y-3">
              <div className="flex justify-between">
                <span className="text-gray-600">ì „ì²´ ì‹¬ê°ë„:</span>
                <span className={`font-semibold ${
                  analysis.severity_analysis.overall_severity === 'ìœ„í—˜' 
                    ? 'text-red-600' 
                    : analysis.severity_analysis.overall_severity === 'ë³´í†µ'
                    ? 'text-yellow-600'
                    : 'text-green-600'
                }`}>
                  {analysis.severity_analysis.overall_severity}
                </span>
              </div>
              <div className="flex justify-between">
                <span className="text-gray-600">ìœ„í—˜ ì ìˆ˜:</span>
                <span className="font-semibold">{analysis.severity_analysis.risk_score}/100</span>
              </div>
            </div>
            <div className="space-y-3">
              <div className="flex justify-between">
                <span className="text-gray-600">ê¸´ê¸‰ ë³´ìˆ˜ í•„ìš”:</span>
                <span className={`font-semibold ${
                  analysis.severity_analysis.urgent_repairs_needed ? 'text-red-600' : 'text-green-600'
                }`}>
                  {analysis.severity_analysis.urgent_repairs_needed ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}
                </span>
              </div>
              <div className="flex justify-between">
                <span className="text-gray-600">ì˜ˆìƒ ì‘ì—… ì‹œê°„:</span>
                <span className="font-semibold">{analysis.severity_analysis.estimated_repair_time}</span>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* ê· ì—´ ìƒì„¸ ì •ë³´ */}
      {analysis.crack_details && analysis.crack_details.length > 0 && (
        <div className="bg-white border border-gray-200 rounded-lg p-6">
          <h4 className="font-semibold text-gray-900 mb-4 flex items-center">
            <span className="text-xl mr-2">ğŸ”</span>
            ê²€ì¶œëœ ê· ì—´ ìƒì„¸ ({analysis.crack_details.length}ê°œ)
          </h4>
          <div className="space-y-3 max-h-60 overflow-y-auto">
            {analysis.crack_details.slice(0, 5).map((crack: any, index: number) => (
              <div key={index} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                <div className="flex-1">
                  <div className="font-medium text-gray-900">{crack.crack_type || `ê· ì—´ #${index + 1}`}</div>
                  <div className="text-sm text-gray-600">
                    ë©´ì : {crack.area?.toFixed(3)}mÂ² | ì‹ ë¢°ë„: {(crack.confidence * 100).toFixed(1)}%
                  </div>
                </div>
                <div className={`px-2 py-1 rounded-full text-xs font-medium ${
                  crack.severity === 'ìœ„í—˜' 
                    ? 'bg-red-100 text-red-800'
                    : crack.severity === 'ë³´í†µ'
                    ? 'bg-yellow-100 text-yellow-800'
                    : 'bg-green-100 text-green-800'
                }`}>
                  {crack.severity}
                </div>
              </div>
            ))}
            {analysis.crack_details.length > 5 && (
              <div className="text-center text-sm text-gray-500 py-2">
                + {analysis.crack_details.length - 5}ê°œ ë” ìˆìŒ
              </div>
            )}
          </div>
        </div>
      )}

      {/* ë³´ìˆ˜ì¬ ìš©ëŸ‰ ì‚°ì • */}
      {analysis.material_estimation && (
        <div className="bg-white border border-gray-200 rounded-lg p-6">
          <h4 className="font-semibold text-gray-900 mb-4 flex items-center">
            <span className="text-xl mr-2">ğŸ§±</span>
            ë³´ìˆ˜ì¬ ìš©ëŸ‰ ì‚°ì •
          </h4>
          <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
            <div className="text-center p-3 bg-blue-50 rounded-lg">
              <div className="text-lg font-bold text-blue-600">
                {analysis.material_estimation.asphalt_concrete}í†¤
              </div>
              <div className="text-sm text-blue-800">ì•„ìŠ¤íŒ”íŠ¸ ì½˜í¬ë¦¬íŠ¸</div>
            </div>
            <div className="text-center p-3 bg-green-50 rounded-lg">
              <div className="text-lg font-bold text-green-600">
                {analysis.material_estimation.sealer}L
              </div>
              <div className="text-sm text-green-800">ì‹¤ëŸ¬</div>
            </div>
            <div className="text-center p-3 bg-purple-50 rounded-lg">
              <div className="text-lg font-bold text-purple-600">
                {analysis.material_estimation.primer}L
              </div>
              <div className="text-sm text-purple-800">í”„ë¼ì´ë¨¸</div>
            </div>
          </div>
          <div className="mt-4 pt-4 border-t border-gray-200 text-center">
            <div className="text-2xl font-bold text-gray-900">
              {analysis.material_estimation.total_cost?.toLocaleString()}ì›
            </div>
            <div className="text-sm text-gray-600">ì˜ˆìƒ ì´ ë¹„ìš©</div>
          </div>
        </div>
      )}

      {/* ë¶„ì„ ì‹œê°„ ì •ë³´ */}
      <div className="bg-gray-50 rounded-lg p-4">
        <div className="grid grid-cols-2 gap-4 text-sm">
          <div>
            <span className="text-gray-600">ë¶„ì„ ì‹œì‘:</span>
            <span className="ml-2 text-gray-900">
              {analysis.started_at ? new Date(analysis.started_at).toLocaleString('ko-KR') : '-'}
            </span>
          </div>
          <div>
            <span className="text-gray-600">ë¶„ì„ ì™„ë£Œ:</span>
            <span className="ml-2 text-gray-900">
              {analysis.completed_at ? new Date(analysis.completed_at).toLocaleString('ko-KR') : '-'}
            </span>
          </div>
        </div>
      </div>
    </div>
  );
};

export default AIAnalysisResult;
```

---

### 37. VideoPlayer.tsx

- **ê²½ë¡œ:** `frontend/src/components/video/VideoPlayer.tsx`
- **í¬ê¸°:** 1,277 characters
- **íƒ€ì…:** .tsx

```tsx
import React from 'react';
import { Video } from '../../types/video';

interface VideoPlayerProps {
  video: Video;
  showAnalysis?: boolean;
}

const VideoPlayer: React.FC<VideoPlayerProps> = ({ video, showAnalysis = false }) => {
  return (
    <div className="space-y-4">
      <div className="bg-black rounded-lg overflow-hidden">
        <video
          controls
          className="w-full h-64"
          poster="/api/videos/thumbnail/${video.id}"
        >
          <source src={`/api/videos/${video.id}/stream`} type="video/mp4" />
          ë¸Œë¼ìš°ì €ì—ì„œ ë¹„ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
        </video>
      </div>
      
      <div className="bg-gray-50 rounded-lg p-4">
        <h3 className="font-medium text-gray-900 mb-2">{video.original_filename}</h3>
        <div className="grid grid-cols-2 gap-4 text-sm text-gray-600">
          <div>íŒŒì¼ í¬ê¸°: {(video.file_size / (1024 * 1024)).toFixed(2)} MB</div>
          <div>ê¸¸ì´: {video.duration ? `${Math.floor(video.duration / 60)}:${Math.floor(video.duration % 60).toString().padStart(2, '0')}` : 'ì•Œ ìˆ˜ ì—†ìŒ'}</div>
          <div>í•´ìƒë„: {video.width && video.height ? `${video.width}x${video.height}` : 'ì•Œ ìˆ˜ ì—†ìŒ'}</div>
          <div>ì—…ë¡œë“œ: {video.uploaded_by}</div>
        </div>
      </div>
    </div>
  );
};

export default VideoPlayer;

```

---

### 38. VideoUpload.tsx

- **ê²½ë¡œ:** `frontend/src/components/video/VideoUpload.tsx`
- **í¬ê¸°:** 2,538 characters
- **íƒ€ì…:** .tsx

```tsx
import React, { useState } from 'react';

interface VideoUploadProps {
  onUpload: (file: File, description?: string) => void;
  uploading?: boolean;
}

const VideoUpload: React.FC<VideoUploadProps> = ({ onUpload, uploading = false }) => {
  const [selectedFile, setSelectedFile] = useState<File | null>(null);
  const [description, setDescription] = useState('');

  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (file) {
      setSelectedFile(file);
    }
  };

  const handleUpload = () => {
    if (selectedFile) {
      onUpload(selectedFile, description);
      setSelectedFile(null);
      setDescription('');
    }
  };

  return (
    <div className="space-y-4">
      <div className="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
        <input
          type="file"
          accept="video/*"
          onChange={handleFileSelect}
          className="hidden"
          id="video-upload"
        />
        <label htmlFor="video-upload" className="cursor-pointer">
          <div className="text-4xl mb-4">ğŸ¥</div>
          <p className="text-lg font-medium text-gray-900 mb-2">ë¹„ë””ì˜¤ íŒŒì¼ ì„ íƒ</p>
          <p className="text-sm text-gray-500">í´ë¦­í•˜ì—¬ íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”</p>
        </label>
      </div>
      
      {selectedFile && (
        <div className="space-y-4">
          <div className="bg-gray-50 rounded-lg p-4">
            <h4 className="font-medium text-gray-900 mb-2">ì„ íƒëœ íŒŒì¼</h4>
            <p className="text-sm text-gray-600">{selectedFile.name}</p>
            <p className="text-xs text-gray-500">
              {(selectedFile.size / (1024 * 1024)).toFixed(2)} MB
            </p>
          </div>
          
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">ì„¤ëª… (ì„ íƒì‚¬í•­)</label>
            <textarea
              value={description}
              onChange={(e) => setDescription(e.target.value)}
              rows={2}
              className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500"
              placeholder="ë¹„ë””ì˜¤ì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"
            />
          </div>
          
          <button
            onClick={handleUpload}
            disabled={uploading}
            className="w-full bg-primary-500 text-white py-2 px-4 rounded-lg hover:bg-primary-600 disabled:opacity-50"
          >
            {uploading ? 'ì—…ë¡œë“œ ì¤‘...' : 'ì—…ë¡œë“œ'}
          </button>
        </div>
      )}
    </div>
  );
};

export default VideoUpload;

```

---

### 39. Dashboard.tsx

- **ê²½ë¡œ:** `frontend/src/components/dashboard/Dashboard.tsx`
- **í¬ê¸°:** 307 characters
- **íƒ€ì…:** .tsx

```tsx
// frontend/src/components/dashboard/Dashboard.tsx
import React from 'react';

interface DashboardProps {
  children: React.ReactNode;
}

const Dashboard: React.FC<DashboardProps> = ({ children }) => {
  return (
    <div className="space-y-6">
      {children}
    </div>
  );
};

export default Dashboard;
```

---

### 40. ActivityList.tsx

- **ê²½ë¡œ:** `frontend/src/components/dashboard/ActivityList.tsx`
- **í¬ê¸°:** 3,081 characters
- **íƒ€ì…:** .tsx

```tsx
// frontend/src/components/dashboard/ActivityList.tsx
import React from 'react';
import { Activity } from '../../types/dashboard';
import { formatRelativeTime } from '../../utils/helpers';

interface ActivityListProps {
  activities: Activity[];
}

const ActivityList: React.FC<ActivityListProps> = ({ activities }) => {
  if (activities.length === 0) {
    return (
      <div className="p-6 text-center text-gray-500">
        <div className="text-3xl mb-2">ğŸ“</div>
        <p>ìµœê·¼ í™œë™ì´ ì—†ìŠµë‹ˆë‹¤</p>
      </div>
    );
  }

  const getActivityIcon = (type: string) => {
    switch (type) {
      case 'marker_created':
        return 'ğŸ“';
      case 'video_uploaded':
        return 'ğŸ¥';
      case 'analysis_completed':
        return 'ğŸ¤–';
      case 'status_updated':
        return 'ğŸ”„';
      default:
        return 'ğŸ“‹';
    }
  };

  const getActivityColor = (type: string) => {
    switch (type) {
      case 'marker_created':
        return 'bg-blue-100 text-blue-800';
      case 'video_uploaded':
        return 'bg-purple-100 text-purple-800';
      case 'analysis_completed':
        return 'bg-green-100 text-green-800';
      case 'status_updated':
        return 'bg-yellow-100 text-yellow-800';
      default:
        return 'bg-gray-100 text-gray-800';
    }
  };

  return (
    <div className="max-h-96 overflow-y-auto">
      <div className="divide-y divide-gray-200">
        {activities.map((activity) => (
          <div key={activity.id} className="p-4 hover:bg-gray-50 transition-colors">
            <div className="flex items-start space-x-3">
              <div className={`
                flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm
                ${getActivityColor(activity.type)}
              `}>
                {getActivityIcon(activity.type)}
              </div>
              
              <div className="flex-1 min-w-0">
                <p className="text-sm text-gray-900 leading-relaxed">
                  {activity.message}
                </p>
                
                <div className="flex items-center mt-1 space-x-4">
                  <span className="text-xs text-gray-500">
                    {formatRelativeTime(activity.timestamp)}
                  </span>
                  
                  {activity.location && (
                    <span className="text-xs text-gray-500 flex items-center">
                      <svg className="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                      </svg>
                      {activity.location}
                    </span>
                  )}
                </div>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

export default ActivityList;
```

---

### 41. StatCard.tsx

- **ê²½ë¡œ:** `frontend/src/components/dashboard/StatCard.tsx`
- **í¬ê¸°:** 2,531 characters
- **íƒ€ì…:** .tsx

```tsx
// frontend/src/components/dashboard/StatCard.tsx
import React from 'react';

interface StatCardProps {
  title: string;
  value: string | number;
  icon: string;
  color: 'blue' | 'red' | 'green' | 'yellow' | 'purple';
  change?: {
    value: number;
    type: 'increase' | 'decrease';
  };
}

const StatCard: React.FC<StatCardProps> = ({ title, value, icon, color, change }) => {
  const colorClasses = {
    blue: 'bg-blue-500 text-blue-500',
    red: 'bg-red-500 text-red-500',
    green: 'bg-green-500 text-green-500',
    yellow: 'bg-yellow-500 text-yellow-500',
    purple: 'bg-purple-500 text-purple-500',
  };

  const bgColorClass = colorClasses[color].split(' ')[0];
  const textColorClass = colorClasses[color].split(' ')[1];

  return (
    <div className="bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow duration-200">
      <div className="flex items-center justify-between">
        <div className="flex-1">
          <p className="text-sm font-medium text-gray-600 mb-1">{title}</p>
          <p className="text-2xl font-bold text-gray-900">{value}</p>
          
          {change && (
            <div className="flex items-center mt-2">
              <span className={`
                inline-flex items-center text-xs font-medium
                ${change.type === 'increase' ? 'text-green-600' : 'text-red-600'}
              `}>
                {change.type === 'increase' ? (
                  <svg className="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                    <path fillRule="evenodd" d="M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z" clipRule="evenodd" />
                  </svg>
                ) : (
                  <svg className="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                    <path fillRule="evenodd" d="M14.707 10.293a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 111.414-1.414L9 12.586V5a1 1 0 012 0v7.586l2.293-2.293a1 1 0 011.414 0z" clipRule="evenodd" />
                  </svg>
                )}
                {Math.abs(change.value)}%
              </span>
              <span className="text-xs text-gray-500 ml-1">ì§€ë‚œì£¼ ëŒ€ë¹„</span>
            </div>
          )}
        </div>
        
        <div className={`
          w-12 h-12 rounded-lg flex items-center justify-center text-white text-xl
          ${bgColorClass}
        `}>
          {icon}
        </div>
      </div>
    </div>
  );
};

export default StatCard;

```

---

### 42. NaverMap.tsx

- **ê²½ë¡œ:** `frontend/src/components/map/NaverMap.tsx`
- **í¬ê¸°:** 18,440 characters
- **íƒ€ì…:** .tsx

```tsx
// frontend/src/components/map/NaverMap.tsx (ìš°í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€)
import React, { useEffect, useRef, useState, useCallback } from 'react';
import { Marker as MarkerType } from '../../types/marker';

interface NaverMapProps {
  markers?: MarkerType[];
  onMarkerClick?: (marker: MarkerType) => void;
  onMapClick?: (lat: number, lng: number) => void;
  onMapRightClick?: (lat: number, lng: number) => void; // ìš°í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
  height?: string;
  showControls?: boolean;
  center?: { lat: number; lng: number };
  zoom?: number;
}

const NaverMap: React.FC<NaverMapProps> = ({
  markers = [],
  onMarkerClick,
  onMapClick,
  onMapRightClick, // ìƒˆë¡œ ì¶”ê°€ëœ props
  height = '400px',
  showControls = true,
  center = { lat: 37.3595704, lng: 127.105399 },
  zoom = 15
}) => {
  const mapRef = useRef<HTMLDivElement>(null);
  const mapInstanceRef = useRef<any>(null);
  const markersRef = useRef<any[]>([]);
  const contextMenuRef = useRef<any>(null); // ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ì°¸ì¡°
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [mapReady, setMapReady] = useState(false);
  const [debugInfo, setDebugInfo] = useState<string>('ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ë¨');
  const [componentMounted, setComponentMounted] = useState(false);
  const [rightClickPosition, setRightClickPosition] = useState<{lat: number, lng: number} | null>(null);

  // ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ì œê±°
  const removeContextMenu = useCallback(() => {
    if (contextMenuRef.current) {
      try {
        contextMenuRef.current.setMap(null);
        contextMenuRef.current = null;
      } catch (error) {
        console.error('ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ì œê±° ì˜¤ë¥˜:', error);
      }
    }
  }, []);

  // ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ìƒì„±
  const createContextMenu = useCallback((position: any, lat: number, lng: number) => {
    if (!mapInstanceRef.current) return;

    const naverMaps = (window as any).naver.maps;
    
    // ê¸°ì¡´ ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ì œê±°
    removeContextMenu();

    // ìƒˆ ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ìƒì„±
    const contextMenuContent = `
      <div style="
        background: white;
        border: 1px solid #ddd;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        padding: 0;
        min-width: 180px;
        font-size: 14px;
        z-index: 1000;
      ">
        <div style="
          padding: 12px 16px;
          border-bottom: 1px solid #eee;
          background: #f8f9fa;
          border-radius: 8px 8px 0 0;
          font-weight: 500;
          color: #495057;
        ">
          ğŸ“ ìœ„ì¹˜: ${lat.toFixed(4)}, ${lng.toFixed(4)}
        </div>
        <div id="context-menu-add-marker" style="
          padding: 12px 16px;
          cursor: pointer;
          border-radius: 0 0 8px 8px;
          transition: background-color 0.2s ease;
          display: flex;
          align-items: center;
          gap: 8px;
        " onmouseover="this.style.backgroundColor='#e3f2fd'" 
           onmouseout="this.style.backgroundColor='white'">
          <span style="font-size: 16px;">ğŸ“</span>
          <span style="color: #333; font-weight: 500;">ì—¬ê¸°ì— ë§ˆì»¤ ì¶”ê°€</span>
        </div>
      </div>
    `;

    contextMenuRef.current = new naverMaps.InfoWindow({
      content: contextMenuContent,
      backgroundColor: 'transparent',
      borderWidth: 0,
      disableAnchor: true,
      pixelOffset: new naverMaps.Point(10, -10)
    });

    contextMenuRef.current.open(mapInstanceRef.current, position);

    // ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ í´ë¦­ ì´ë²¤íŠ¸ ë“±ë¡
    setTimeout(() => {
      const addMarkerButton = document.getElementById('context-menu-add-marker');
      if (addMarkerButton) {
        addMarkerButton.addEventListener('click', () => {
          console.log('ğŸ¯ ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ì—ì„œ ë§ˆì»¤ ì¶”ê°€ í´ë¦­:', { lat, lng });
          removeContextMenu();
          if (onMapRightClick) {
            onMapRightClick(lat, lng);
          }
        });
      }
    }, 100);
  }, [onMapRightClick, removeContextMenu]);

  // ê¸°ì¡´ API í™•ì¸ í•¨ìˆ˜ ë“±ì€ ê·¸ëŒ€ë¡œ ìœ ì§€
  const checkAPIDirectly = useCallback((): boolean => {
    try {
      const hasNaver = typeof (window as any).naver !== 'undefined';
      const hasMaps = hasNaver && (window as any).naver.maps;
      const hasMapClass = hasMaps && typeof (window as any).naver.maps.Map === 'function';
      
      console.log('ğŸ” ì»´í¬ë„ŒíŠ¸ì—ì„œ API ì§ì ‘ í™•ì¸:', {
        hasNaver,
        hasMaps,
        hasMapClass,
        naverMapReady: (window as any).naverMapReady,
        mapRefCurrent: !!mapRef.current,
        componentMounted
      });
      
      return hasMapClass;
    } catch (err) {
      console.error('API í™•ì¸ ì¤‘ ì˜¤ë¥˜:', err);
      return false;
    }
  }, [componentMounted]);

  // ì§€ë„ ìƒì„± í•¨ìˆ˜ (ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ë¨)
  const createMap = useCallback(() => {
    console.log('ğŸ—ºï¸ createMap í˜¸ì¶œ - ì‚¬ì „ ê²€ì‚¬ ì‹œì‘');

    if (mapInstanceRef.current) {
      console.log('âœ… ì§€ë„ ì´ë¯¸ ìƒì„±ë¨, ì¤‘ë³µ ìƒì„± ë°©ì§€');
      setMapReady(true);
      setIsLoading(false);
      return;
    }

    if (!componentMounted || !mapRef.current || !checkAPIDirectly()) {
      console.log('â³ ì‚¬ì „ ì¡°ê±´ ë¯¸ì¶©ì¡±, ì¬ì‹œë„ ëŒ€ê¸°');
      setTimeout(() => {
        if (mapRef.current && componentMounted) {
          createMap();
        }
      }, 100);
      return;
    }

    try {
      console.log('ğŸ—ºï¸ ì§€ë„ ìƒì„± ì‹¤ì œ ì‹œì‘...');
      setDebugInfo('ì§€ë„ ìƒì„± ì‹œì‘');

      const naverMaps = (window as any).naver.maps;
      
      const mapOptions = {
        center: new naverMaps.LatLng(center.lat, center.lng),
        zoom: zoom,
        mapTypeControl: showControls,
        mapDataControl: showControls,
        logoControl: false,
        scaleControl: showControls,
        zoomControl: showControls,
        minZoom: 6,
        maxZoom: 21
      };

      mapInstanceRef.current = new naverMaps.Map(mapRef.current, mapOptions);
      console.log('âœ… ì§€ë„ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±!');

      const checkMapReady = () => {
        try {
          if (mapInstanceRef.current && 
              typeof mapInstanceRef.current.getCenter === 'function') {
            
            console.log('ğŸ¯ ì§€ë„ ì™„ì „ ì¤€ë¹„ ì™„ë£Œ!');
            setMapReady(true);
            setIsLoading(false);
            setError(null);
            setDebugInfo('ì§€ë„ ì¤€ë¹„ ì™„ë£Œ');

            // ì¼ë°˜ í´ë¦­ ì´ë²¤íŠ¸
            if (onMapClick) {
              naverMaps.Event.addListener(mapInstanceRef.current, 'click', (e: any) => {
                const latlng = e.coord;
                const lat = latlng.lat();
                const lng = latlng.lng();
                console.log('ğŸ–±ï¸ ì§€ë„ í´ë¦­:', { lat, lng });
                removeContextMenu(); // í´ë¦­ ì‹œ ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ì œê±°
                onMapClick(lat, lng);
              });
            }

            // ìš°í´ë¦­ ì´ë²¤íŠ¸ (ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´)
            naverMaps.Event.addListener(mapInstanceRef.current, 'rightclick', (e: any) => {
              const latlng = e.coord;
              const lat = latlng.lat();
              const lng = latlng.lng();
              console.log('ğŸ–±ï¸ ì§€ë„ ìš°í´ë¦­:', { lat, lng });
              
              // ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ìƒì„±
              createContextMenu(latlng, lat, lng);
              
              // ê¸°ë³¸ ë¸Œë¼ìš°ì € ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ë°©ì§€
              e.domEvent.preventDefault();
            });

            // ì§€ë„ì˜ ë‹¤ë¥¸ ê³³ í´ë¦­ ì‹œ ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ì œê±°
            naverMaps.Event.addListener(mapInstanceRef.current, 'click', () => {
              removeContextMenu();
            });

            console.log('ğŸ–±ï¸ ëª¨ë“  ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ì™„ë£Œ');
            return true;
          }
          return false;
        } catch (err) {
          console.error('ì§€ë„ ì¤€ë¹„ í™•ì¸ ì¤‘ ì˜¤ë¥˜:', err);
          return false;
        }
      };

      // idle ì´ë²¤íŠ¸ ë“±ë¡
      naverMaps.Event.addListener(mapInstanceRef.current, 'idle', () => {
        if (!mapReady) {
          checkMapReady();
        }
      });

      // í´ë§ìœ¼ë¡œ ì¤€ë¹„ ìƒíƒœ í™•ì¸
      let checkCount = 0;
      const pollMapReady = () => {
        checkCount++;
        setDebugInfo(`ì§€ë„ ì¤€ë¹„ í™•ì¸ ì¤‘... (${checkCount}/20)`);
        
        if (checkMapReady()) {
          return;
        }
        
        if (checkCount < 20) {
          setTimeout(pollMapReady, 200);
        } else {
          console.warn('âš ï¸ ì§€ë„ ì¤€ë¹„ íƒ€ì„ì•„ì›ƒ, ê°•ì œ ì™„ë£Œ');
          setMapReady(true);
          setIsLoading(false);
          setDebugInfo('ì§€ë„ ì¤€ë¹„ ì™„ë£Œ (íƒ€ì„ì•„ì›ƒ)');
        }
      };

      setTimeout(pollMapReady, 100);

    } catch (err) {
      console.error('âŒ ì§€ë„ ìƒì„± ì‹¤íŒ¨:', err);
      setError(`ì§€ë„ ìƒì„± ì‹¤íŒ¨: ${err}`);
      setIsLoading(false);
      setDebugInfo(`ì§€ë„ ìƒì„± ì‹¤íŒ¨: ${err}`);
    }
  }, [componentMounted, checkAPIDirectly, center, zoom, showControls, onMapClick, mapReady, createContextMenu, removeContextMenu]);

  // ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ë° API í™•ì¸ ë¡œì§ì€ ê¸°ì¡´ê³¼ ë™ì¼
  useEffect(() => {
    console.log('ğŸš€ NaverMap ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ë¨');
    
    const mountTimer = setTimeout(() => {
      setComponentMounted(true);
    }, 0);

    return () => {
      clearTimeout(mountTimer);
      console.log('ğŸ§¹ NaverMap ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸');
      
      // ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ì •ë¦¬
      removeContextMenu();
      
      // ë§ˆì»¤ ì •ë¦¬
      if (markersRef.current.length > 0) {
        markersRef.current.forEach(marker => marker.setMap(null));
        markersRef.current = [];
      }
    };
  }, [removeContextMenu]);

  useEffect(() => {
    if (!componentMounted) {
      return;
    }

    console.log('ğŸ” ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ì™„ë£Œ, API í™•ì¸ ì‹œì‘');
    
    let mounted = true;
    let attemptCount = 0;
    const maxAttempts = 100;

    const tryCreateMap = () => {
      if (!mounted || !componentMounted) return;
      
      attemptCount++;
      setDebugInfo(`API í™•ì¸ ì‹œë„ ${attemptCount}/${maxAttempts}`);
      
      if (checkAPIDirectly()) {
        console.log('âœ… API í™•ì¸ ì„±ê³µ, ì§€ë„ ìƒì„± ì‹œì‘!');
        createMap();
        return;
      }

      if ((window as any).naverMapReady) {
        console.log('âœ… ì „ì—­ ìƒíƒœ í™•ì¸ ì„±ê³µ, ì§€ë„ ìƒì„± ì‹œì‘!');
        createMap();
        return;
      }

      if (attemptCount < maxAttempts) {
        setTimeout(tryCreateMap, 500);
      } else {
        console.error('âŒ API í™•ì¸ ìµœëŒ€ ì¬ì‹œë„ ì´ˆê³¼');
        setError('ë„¤ì´ë²„ ì§€ë„ APIë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
        setIsLoading(false);
        setDebugInfo('API í™•ì¸ íƒ€ì„ì•„ì›ƒ');
      }
    };

    if (checkAPIDirectly()) {
      console.log('ğŸ¯ ì¦‰ì‹œ API í™•ì¸ ì„±ê³µ!');
      createMap();
    } else {
      console.log('â³ API ë¡œë“œ ëŒ€ê¸° ì‹œì‘...');
      setTimeout(tryCreateMap, 100);
    }

    const handleNaverReady = () => {
      if (mounted && componentMounted && !mapReady && !mapInstanceRef.current) {
        console.log('ğŸ‰ naverMapReady ì´ë²¤íŠ¸ ìˆ˜ì‹ ! (ë³´ì¡°)');
        setTimeout(createMap, 50);
      }
    };

    window.addEventListener('naverMapReady', handleNaverReady);

    return () => {
      mounted = false;
      window.removeEventListener('naverMapReady', handleNaverReady);
    };
  }, [componentMounted, checkAPIDirectly, createMap, mapReady]);

  // ë§ˆì»¤ ì—…ë°ì´íŠ¸ ë¡œì§ì€ ê¸°ì¡´ê³¼ ë™ì¼
  useEffect(() => {
    if (!mapReady || !mapInstanceRef.current) {
      console.log('â¸ï¸ ë§ˆì»¤ ì—…ë°ì´íŠ¸ ëŒ€ê¸° (ì§€ë„ ë¯¸ì¤€ë¹„)');
      return;
    }

    console.log(`ğŸ·ï¸ ë§ˆì»¤ ì—…ë°ì´íŠ¸ ì‹œì‘: ${markers.length}ê°œ`);

    const naverMaps = (window as any).naver.maps;
    
    // ê¸°ì¡´ ë§ˆì»¤ ì œê±°
    markersRef.current.forEach(marker => marker.setMap(null));
    markersRef.current = [];

    // ìƒˆ ë§ˆì»¤ ì¶”ê°€
    markers.forEach((markerData, index) => {
      try {
        const position = new naverMaps.LatLng(markerData.latitude, markerData.longitude);
        
        const marker = new naverMaps.Marker({
          position: position,
          map: mapInstanceRef.current,
          title: markerData.title,
          icon: {
            content: `
              <div style="
                width: 32px; height: 32px; 
                background: ${markerData.priority === 'urgent' ? '#ef4444' : markerData.priority === 'high' ? '#f97316' : '#10b981'};
                border: 3px solid white; border-radius: 50%; 
                box-shadow: 0 3px 8px rgba(0,0,0,0.4);
                display: flex; align-items: center; justify-content: center;
                color: white; font-size: 16px; cursor: pointer;
                transition: transform 0.2s ease;
              " 
              onmouseover="this.style.transform='scale(1.1)'" 
              onmouseout="this.style.transform='scale(1)'">
                ${markerData.priority === 'urgent' ? 'ğŸš¨' : markerData.priority === 'high' ? 'âš ï¸' : 'ğŸ“'}
              </div>
            `,
            size: new naverMaps.Size(32, 32),
            anchor: new naverMaps.Point(16, 16)
          }
        });

        // í´ë¦­ ì´ë²¤íŠ¸
        if (onMarkerClick) {
          naverMaps.Event.addListener(marker, 'click', () => {
            console.log('ğŸ“ ë§ˆì»¤ í´ë¦­:', markerData.title);
            removeContextMenu(); // ë§ˆì»¤ í´ë¦­ ì‹œë„ ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ì œê±°
            onMarkerClick(markerData);
          });
        }

        // ê°„ë‹¨í•œ ì •ë³´ì°½
        const infoWindow = new naverMaps.InfoWindow({
          content: `
            <div style="padding:8px;max-width:180px;font-size:12px;line-height:1.4;">
              <strong style="color:#333;">${markerData.title}</strong><br>
              <span style="color:#666;">${markerData.description || ''}</span><br>
              <small style="color:#999;">${markerData.road_name || markerData.address || ''}</small>
            </div>
          `,
          backgroundColor: 'white',
          borderColor: '#ddd',
          borderWidth: 1,
          pixelOffset: new naverMaps.Point(0, -5)
        });

        naverMaps.Event.addListener(marker, 'mouseover', () => {
          infoWindow.open(mapInstanceRef.current, marker);
        });

        naverMaps.Event.addListener(marker, 'mouseout', () => {
          infoWindow.close();
        });

        markersRef.current.push(marker);
        console.log(`âœ… ë§ˆì»¤ ${index + 1} ìƒì„±: ${markerData.title}`);
        
      } catch (err) {
        console.error(`âŒ ë§ˆì»¤ ìƒì„± ì‹¤íŒ¨ (${markerData.title}):`, err);
      }
    });

    // ì§€ë„ ë²”ìœ„ ì¡°ì •
    if (markers.length > 0 && mapInstanceRef.current) {
      try {
        if (markers.length === 1) {
          mapInstanceRef.current.setCenter(
            new naverMaps.LatLng(markers[0].latitude, markers[0].longitude)
          );
          mapInstanceRef.current.setZoom(16);
        } else {
          const bounds = new naverMaps.LatLngBounds();
          markers.forEach(marker => {
            bounds.extend(new naverMaps.LatLng(marker.latitude, marker.longitude));
          });
          mapInstanceRef.current.fitBounds(bounds, { top: 50, right: 50, bottom: 50, left: 50 });
        }
        console.log('ğŸ¯ ì§€ë„ ë²”ìœ„ ì¡°ì • ì™„ë£Œ');
      } catch (err) {
        console.error('âŒ ë²”ìœ„ ì¡°ì • ì‹¤íŒ¨:', err);
      }
    }
  }, [markers, onMarkerClick, mapReady, removeContextMenu]);

  // ìˆ˜ë™ ì§€ë„ ìƒì„± ë²„íŠ¼ í•¸ë“¤ëŸ¬
  const handleManualCreate = () => {
    console.log('ğŸ”§ ìˆ˜ë™ ì§€ë„ ìƒì„± ì‹œë„');
    setIsLoading(true);
    setError(null);
    setDebugInfo('ìˆ˜ë™ ìƒì„± ì‹œë„ ì¤‘...');
    removeContextMenu();
    mapInstanceRef.current = null;
    setMapReady(false);
    createMap();
  };

  return (
    <div className="relative">
      {/* ì§€ë„ ì»¨í…Œì´ë„ˆ */}
      <div 
        ref={mapRef} 
        style={{ height }}
        className="w-full rounded-lg overflow-hidden shadow-lg bg-gray-200"
        onContextMenu={(e) => {
          // ë¸Œë¼ìš°ì € ê¸°ë³¸ ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ë°©ì§€ëŠ” ë„¤ì´ë²„ ì§€ë„ì—ì„œ ì²˜ë¦¬
          if (!mapReady) {
            e.preventDefault();
          }
        }}
      />
      
      {/* ë¡œë”© ì˜¤ë²„ë ˆì´ */}
      {(isLoading || error) && (
        <div className="absolute inset-0 flex items-center justify-center bg-gray-100 rounded-lg z-20">
          {error ? (
            <div className="text-center text-red-700 p-6">
              <div className="text-4xl mb-3">âŒ</div>
              <p className="font-medium text-lg mb-2">ì§€ë„ ë¡œë“œ ì˜¤ë¥˜</p>
              <p className="text-sm mb-4">{error}</p>
              <div className="space-y-2">
                <button 
                  onClick={() => window.location.reload()} 
                  className="block mx-auto px-4 py-2 bg-red-100 hover:bg-red-200 text-red-800 rounded-lg transition-colors"
                >
                  ìƒˆë¡œê³ ì¹¨
                </button>
                <button 
                  onClick={handleManualCreate}
                  className="block mx-auto px-4 py-2 bg-blue-100 hover:bg-blue-200 text-blue-800 rounded-lg transition-colors text-sm"
                >
                  ìˆ˜ë™ ìƒì„± ì‹œë„
                </button>
              </div>
            </div>
          ) : (
            <div className="text-center text-gray-500">
              <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-3"></div>
              <p className="text-lg font-medium">ë„¤ì´ë²„ ì§€ë„ ì¤€ë¹„ ì¤‘...</p>
              <p className="text-sm mt-1">{debugInfo}</p>
            </div>
          )}
        </div>
      )}
      
      {/* ì¤Œ ì»¨íŠ¸ë¡¤ */}
      {mapReady && !isLoading && !error && (
        <div className="absolute top-3 right-3 bg-white rounded-lg shadow-md overflow-hidden z-10">
          <button 
            onClick={() => {
              if (mapInstanceRef.current) {
                const zoom = mapInstanceRef.current.getZoom();
                mapInstanceRef.current.setZoom(zoom + 1);
              }
            }}
            className="block w-10 h-10 bg-white hover:bg-gray-100 border-b border-gray-200 text-lg font-bold transition-colors"
            title="í™•ëŒ€"
          >
            +
          </button>
          <button 
            onClick={() => {
              if (mapInstanceRef.current) {
                const zoom = mapInstanceRef.current.getZoom();
                mapInstanceRef.current.setZoom(zoom - 1);
              }
            }}
            className="block w-10 h-10 bg-white hover:bg-gray-100 text-lg font-bold transition-colors"
            title="ì¶•ì†Œ"
          >
            âˆ’
          </button>
        </div>
      )}
      
      {/* ì‚¬ìš©ë²• ì•ˆë‚´ */}
      {mapReady && !isLoading && !error && (
        <div className="absolute top-3 left-3 bg-white bg-opacity-95 rounded-lg px-3 py-2 shadow-md z-10 max-w-xs">
          <p className="text-xs text-gray-600">
            ğŸ’¡ <strong>ì§€ë„ ìš°í´ë¦­</strong>ìœ¼ë¡œ ìƒˆ ë§ˆì»¤ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
          </p>
        </div>
      )}
      
      {/* ìƒíƒœ ì •ë³´ */}
      <div className="absolute bottom-3 left-3 bg-white bg-opacity-95 rounded-lg px-3 py-2 shadow-md z-10">
        <div className="flex items-center space-x-2 text-sm">
          {mapReady ? (
            <>
              <span className="text-green-600 font-medium">âœ… ì§€ë„ ì¤€ë¹„</span>
              <span className="text-gray-600">ğŸ“ {markers.length}ê°œ</span>
            </>
          ) : (
            <>
              <span className="text-orange-600 font-medium">â³ ë¡œë”©ì¤‘</span>
              <span className="text-gray-600">ì»¨í…Œì´ë„ˆ: {mapRef.current ? 'âœ…' : 'âŒ'}</span>
            </>
          )}
        </div>
      </div>
    </div>
  );
};

export default NaverMap;
```

---

### 43. MarkerPopup.tsx

- **ê²½ë¡œ:** `frontend/src/components/map/MarkerPopup.tsx`
- **í¬ê¸°:** 883 characters
- **íƒ€ì…:** .tsx

```tsx
//frontend/src/components/map/MarkerPopup.tsx
import React from 'react';
import { Marker } from '../../types/marker';

interface MarkerPopupProps {
  marker: Marker;
  onClose: () => void;
}

const MarkerPopup: React.FC<MarkerPopupProps> = ({ marker, onClose }) => {
  return (
    <div className="bg-white rounded-lg shadow-lg p-4 max-w-sm">
      <div className="flex justify-between items-start mb-2">
        <h3 className="font-semibold text-gray-900">{marker.title}</h3>
        <button 
          onClick={onClose}
          className="text-gray-400 hover:text-gray-600"
        >
          âœ•
        </button>
      </div>
      <p className="text-sm text-gray-600 mb-2">{marker.description}</p>
      <div className="text-xs text-gray-500">
        ğŸ“ {marker.address || `${marker.latitude}, ${marker.longitude}`}
      </div>
    </div>
  );
};

export default MarkerPopup;

```

---

### 44. MarkerAddPopup.tsx

- **ê²½ë¡œ:** `frontend/src/components/map/MarkerAddPopup.tsx`
- **í¬ê¸°:** 16,309 characters
- **íƒ€ì…:** .tsx

```tsx
// frontend/src/components/map/MarkerAddPopup.tsx (ë™ì˜ìƒ ì—…ë¡œë“œ í¬í•¨)
import React, { useState, useEffect, useRef } from 'react';
import { MarkerCreate, IssueType, MarkerPriority } from '../../types/marker';
import { ISSUE_TYPE_LABELS, MARKER_PRIORITY_LABELS } from '../../utils/constants';
import { formatFileSize } from '../../utils/helpers';

interface MarkerAddPopupProps {
  isOpen: boolean;
  position: { lat: number; lng: number } | null;
  onSubmit: (marker: MarkerCreate, videoFile?: File) => Promise<void>;
  onClose: () => void;
  loading?: boolean;
}

const MarkerAddPopup: React.FC<MarkerAddPopupProps> = ({
  isOpen,
  position,
  onSubmit,
  onClose,
  loading = false
}) => {
  const fileInputRef = useRef<HTMLInputElement>(null);
  const [formData, setFormData] = useState<Omit<MarkerCreate, 'latitude' | 'longitude'>>({
    title: '',
    description: '',
    address: '',
    road_name: '',
    issue_type: IssueType.CRACK,
    priority: MarkerPriority.NORMAL,
    assigned_to: '',
    created_by: 'ê¹€ê´€ë¦¬ì'
  });

  const [selectedVideo, setSelectedVideo] = useState<File | null>(null);
  const [videoPreview, setVideoPreview] = useState<string | null>(null);
  const [addressLoading, setAddressLoading] = useState(false);
  const [addressError, setAddressError] = useState<string | null>(null);

  // í—ˆìš©ë˜ëŠ” ë¹„ë””ì˜¤ í˜•ì‹
  const allowedVideoTypes = ['video/mp4', 'video/mov', 'video/avi', 'video/mkv'];
  const maxVideoSize = 100 * 1024 * 1024; // 100MB

  // ì¢Œí‘œë¡œë¶€í„° ì£¼ì†Œ ê²€ìƒ‰ (ì—­ì§€ì˜¤ì½”ë”©)
  const reverseGeocode = async (lat: number, lng: number) => {
    if (!(window as any).naver?.maps?.Service) {
      console.warn('ë„¤ì´ë²„ ì§€ë„ Geocoding ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      return;
    }

    setAddressLoading(true);
    setAddressError(null);

    try {
      const coords = new (window as any).naver.maps.LatLng(lat, lng);
      
      (window as any).naver.maps.Service.reverseGeocode({
        coords: coords,
        orders: [
          (window as any).naver.maps.Service.OrderType.ADDR,
          (window as any).naver.maps.Service.OrderType.ROAD_ADDR
        ].join(',')
      }, (status: any, response: any) => {
        setAddressLoading(false);
        
        if (status === (window as any).naver.maps.Service.Status.ERROR) {
          setAddressError('ì£¼ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
          return;
        }

        if (response.v2 && response.v2.results && response.v2.results.length > 0) {
          const result = response.v2.results[0];
          const roadAddr = result.region?.area1?.name + ' ' + 
                          result.region?.area2?.name + ' ' + 
                          (result.land?.name || '');
          
          setFormData(prev => ({
            ...prev,
            address: result.region?.area1?.name + ' ' + result.region?.area2?.name,
            road_name: roadAddr.trim()
          }));
        }
      });
    } catch (error) {
      console.error('ì—­ì§€ì˜¤ì½”ë”© ì˜¤ë¥˜:', error);
      setAddressLoading(false);
      setAddressError('ì£¼ì†Œ ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
  };

  // ë¹„ë””ì˜¤ íŒŒì¼ ì„ íƒ í•¸ë“¤ëŸ¬
  const handleVideoSelect = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (!file) return;

    // íŒŒì¼ íƒ€ì… ê²€ì¦
    if (!allowedVideoTypes.includes(file.type)) {
      alert('ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¹„ë””ì˜¤ í˜•ì‹ì…ë‹ˆë‹¤.\nì§€ì› í˜•ì‹: MP4, MOV, AVI, MKV');
      if (fileInputRef.current) {
        fileInputRef.current.value = '';
      }
      return;
    }

    // íŒŒì¼ í¬ê¸° ê²€ì¦
    if (file.size > maxVideoSize) {
      alert(`íŒŒì¼ í¬ê¸°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤.\nìµœëŒ€ í¬ê¸°: ${formatFileSize(maxVideoSize)}`);
      if (fileInputRef.current) {
        fileInputRef.current.value = '';
      }
      return;
    }

    setSelectedVideo(file);

    // ë¹„ë””ì˜¤ ë¯¸ë¦¬ë³´ê¸° ìƒì„±
    const url = URL.createObjectURL(file);
    setVideoPreview(url);
  };

  // ë¹„ë””ì˜¤ ì œê±° í•¸ë“¤ëŸ¬
  const handleVideoRemove = () => {
    setSelectedVideo(null);
    if (videoPreview) {
      URL.revokeObjectURL(videoPreview);
      setVideoPreview(null);
    }
    if (fileInputRef.current) {
      fileInputRef.current.value = '';
    }
  };

  // íŒì—…ì´ ì—´ë¦´ ë•Œë§ˆë‹¤ í¼ ì´ˆê¸°í™”
  useEffect(() => {
    if (isOpen && position) {
      // í¼ ì´ˆê¸°í™”
      setFormData({
        title: '',
        description: '',
        address: '',
        road_name: '',
        issue_type: IssueType.CRACK,
        priority: MarkerPriority.NORMAL,
        assigned_to: '',
        created_by: 'ê¹€ê´€ë¦¬ì'
      });
      
      // ë¹„ë””ì˜¤ ê´€ë ¨ ìƒíƒœ ì´ˆê¸°í™”
      setSelectedVideo(null);
      if (videoPreview) {
        URL.revokeObjectURL(videoPreview);
        setVideoPreview(null);
      }
      if (fileInputRef.current) {
        fileInputRef.current.value = '';
      }
      
      // ì£¼ì†Œ ê²€ìƒ‰
      reverseGeocode(position.lat, position.lng);
    }
  }, [isOpen, position]);

  // ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ë¯¸ë¦¬ë³´ê¸° URL ì •ë¦¬
  useEffect(() => {
    return () => {
      if (videoPreview) {
        URL.revokeObjectURL(videoPreview);
      }
    };
  }, [videoPreview]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    if (!position) return;

    const markerData: MarkerCreate = {
      ...formData,
      latitude: position.lat,
      longitude: position.lng
    };

    try {
      await onSubmit(markerData, selectedVideo || undefined);
      onClose();
    } catch (error) {
      console.error('ë§ˆì»¤ ìƒì„± ì˜¤ë¥˜:', error);
    }
  };

  const handleInputChange = (field: string, value: any) => {
    setFormData(prev => ({
      ...prev,
      [field]: value
    }));
  };

  if (!isOpen || !position) return null;

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center">
      {/* ë°±ë“œë¡­ */}
      <div 
        className="absolute inset-0 bg-black bg-opacity-50"
        onClick={onClose}
      />
      
      {/* íŒì—… */}
      <div className="relative bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto">
        {/* í—¤ë” */}
        <div className="bg-gradient-to-r from-primary-500 to-secondary-500 text-white p-4 rounded-t-xl">
          <div className="flex items-center justify-between">
            <div>
              <h2 className="text-lg font-semibold">ğŸ“ ìƒˆ ë§ˆì»¤ ì¶”ê°€</h2>
              <p className="text-sm opacity-90">
                ìœ„ì¹˜: {position.lat.toFixed(6)}, {position.lng.toFixed(6)}
              </p>
            </div>
            <button
              onClick={onClose}
              className="p-1 hover:bg-white hover:bg-opacity-20 rounded-full transition-colors"
            >
              <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
        </div>

        {/* í¼ */}
        <form onSubmit={handleSubmit} className="p-6 space-y-6">
          {/* ê¸°ë³¸ ì •ë³´ ì„¹ì…˜ */}
          <div className="space-y-4">
            <h3 className="text-lg font-medium text-gray-900 border-b border-gray-200 pb-2">
              ğŸ“‹ ê¸°ë³¸ ì •ë³´
            </h3>
            
            {/* ì œëª© */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                ì œëª© <span className="text-red-500">*</span>
              </label>
              <input
                type="text"
                required
                value={formData.title}
                onChange={(e) => handleInputChange('title', e.target.value)}
                placeholder="ì˜ˆ: ì„œìš¸ë¡œ êµì°¨ì  ë°©ì‚¬ ê· ì—´"
                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
              />
            </div>

            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              {/* ì´ìŠˆ ìœ í˜• */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">ì´ìŠˆ ìœ í˜•</label>
                <select
                  value={formData.issue_type}
                  onChange={(e) => handleInputChange('issue_type', e.target.value as IssueType)}
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                >
                  {Object.entries(ISSUE_TYPE_LABELS).map(([key, label]) => (
                    <option key={key} value={key}>{label}</option>
                  ))}
                </select>
              </div>

              {/* ìš°ì„ ìˆœìœ„ */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">ìš°ì„ ìˆœìœ„</label>
                <select
                  value={formData.priority}
                  onChange={(e) => handleInputChange('priority', e.target.value as MarkerPriority)}
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                >
                  {Object.entries(MARKER_PRIORITY_LABELS).map(([key, label]) => (
                    <option key={key} value={key}>{label}</option>
                  ))}
                </select>
              </div>
            </div>

            {/* ì„¤ëª… */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">ì„¤ëª…</label>
              <textarea
                value={formData.description}
                onChange={(e) => handleInputChange('description', e.target.value)}
                rows={3}
                placeholder="ìƒì„¸ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"
                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 resize-none"
              />
            </div>
          </div>

          {/* ìœ„ì¹˜ ì •ë³´ ì„¹ì…˜ */}
          <div className="space-y-4">
            <h3 className="text-lg font-medium text-gray-900 border-b border-gray-200 pb-2">
              ğŸ“ ìœ„ì¹˜ ì •ë³´
            </h3>
            
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              {/* ì£¼ì†Œ */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  ì£¼ì†Œ
                  {addressLoading && (
                    <span className="ml-2 text-xs text-blue-600">
                      <span className="inline-block animate-spin mr-1">ğŸ”„</span>
                      ê²€ìƒ‰ ì¤‘...
                    </span>
                  )}
                </label>
                {addressError && (
                  <p className="text-xs text-red-600 mb-1">{addressError}</p>
                )}
                <input
                  type="text"
                  value={formData.address}
                  onChange={(e) => handleInputChange('address', e.target.value)}
                  placeholder="ì£¼ì†Œê°€ ìë™ìœ¼ë¡œ ê²€ìƒ‰ë©ë‹ˆë‹¤"
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                />
              </div>

              {/* ë„ë¡œëª… */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">ë„ë¡œëª…</label>
                <input
                  type="text"
                  value={formData.road_name}
                  onChange={(e) => handleInputChange('road_name', e.target.value)}
                  placeholder="ë„ë¡œëª…ì´ ìë™ìœ¼ë¡œ ê²€ìƒ‰ë©ë‹ˆë‹¤"
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                />
              </div>
            </div>

            {/* ë‹´ë‹¹ì */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">ë‹´ë‹¹ì</label>
              <input
                type="text"
                value={formData.assigned_to}
                onChange={(e) => handleInputChange('assigned_to', e.target.value)}
                placeholder="ë‹´ë‹¹ìëª… (ì„ íƒì‚¬í•­)"
                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
              />
            </div>
          </div>

          {/* ë¹„ë””ì˜¤ ì—…ë¡œë“œ ì„¹ì…˜ */}
          <div className="space-y-4">
            <h3 className="text-lg font-medium text-gray-900 border-b border-gray-200 pb-2">
              ğŸ¥ ë¹„ë””ì˜¤ ì—…ë¡œë“œ (ì„ íƒì‚¬í•­)
            </h3>
            
            {!selectedVideo ? (
              <div>
                <div 
                  className="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-primary-400 transition-colors cursor-pointer"
                  onClick={() => fileInputRef.current?.click()}
                >
                  <input
                    type="file"
                    ref={fileInputRef}
                    onChange={handleVideoSelect}
                    accept="video/mp4,video/mov,video/avi,video/mkv"
                    className="hidden"
                  />
                  <div className="text-4xl mb-3">ğŸ¥</div>
                  <p className="text-lg font-medium text-gray-700 mb-2">ë¹„ë””ì˜¤ íŒŒì¼ ì„ íƒ</p>
                  <p className="text-sm text-gray-500 mb-2">í´ë¦­í•˜ì—¬ íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”</p>
                  <p className="text-xs text-gray-400">
                    ì§€ì› í˜•ì‹: MP4, MOV, AVI, MKV<br/>
                    ìµœëŒ€ í¬ê¸°: {formatFileSize(maxVideoSize)}
                  </p>
                </div>
              </div>
            ) : (
              <div className="space-y-3">
                {/* ì„ íƒëœ íŒŒì¼ ì •ë³´ */}
                <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
                  <div className="flex items-start justify-between">
                    <div className="flex-1">
                      <h4 className="font-medium text-blue-900 mb-1">ì„ íƒëœ ë¹„ë””ì˜¤</h4>
                      <p className="text-sm text-blue-700 mb-1">{selectedVideo.name}</p>
                      <p className="text-xs text-blue-600">
                        í¬ê¸°: {formatFileSize(selectedVideo.size)} | 
                        í˜•ì‹: {selectedVideo.type}
                      </p>
                    </div>
                    <button
                      type="button"
                      onClick={handleVideoRemove}
                      className="text-red-500 hover:text-red-700 p-1"
                      title="ë¹„ë””ì˜¤ ì œê±°"
                    >
                      ğŸ—‘ï¸
                    </button>
                  </div>
                </div>

                {/* ë¹„ë””ì˜¤ ë¯¸ë¦¬ë³´ê¸° */}
                {videoPreview && (
                  <div className="bg-black rounded-lg overflow-hidden">
                    <video
                      src={videoPreview}
                      controls
                      className="w-full max-h-48"
                      preload="metadata"
                    >
                      ë¸Œë¼ìš°ì €ì—ì„œ ë¹„ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                    </video>
                  </div>
                )}

                {/* ë‹¤ë¥¸ ë¹„ë””ì˜¤ ì„ íƒ ë²„íŠ¼ */}
                <button
                  type="button"
                  onClick={() => fileInputRef.current?.click()}
                  className="w-full py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm"
                >
                  ë‹¤ë¥¸ ë¹„ë””ì˜¤ ì„ íƒ
                </button>
              </div>
            )}
          </div>

          {/* ë²„íŠ¼ */}
          <div className="flex space-x-3 pt-4 border-t border-gray-200">
            <button
              type="button"
              onClick={onClose}
              disabled={loading}
              className="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50"
            >
              ì·¨ì†Œ
            </button>
            <button
              type="submit"
              disabled={loading || !formData.title.trim()}
              className="flex-1 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors disabled:opacity-50 flex items-center justify-center"
            >
              {loading ? (
                <>
                  <span className="inline-block animate-spin mr-2">ğŸ”„</span>
                  {selectedVideo ? 'ë§ˆì»¤ ìƒì„± ë° ì—…ë¡œë“œ ì¤‘...' : 'ë§ˆì»¤ ìƒì„± ì¤‘...'}
                </>
              ) : (
                <>
                  {selectedVideo ? 'ğŸ“ğŸ¥ ë§ˆì»¤ ìƒì„± ë° ì—…ë¡œë“œ' : 'ğŸ“ ë§ˆì»¤ ìƒì„±'}
                </>
              )}
            </button>
          </div>
        </form>
      </div>
    </div>
  );
};

export default MarkerAddPopup;
```

---

### 45. Modal.tsx

- **ê²½ë¡œ:** `frontend/src/components/common/Modal.tsx`
- **í¬ê¸°:** 2,214 characters
- **íƒ€ì…:** .tsx

```tsx
// frontend/src/components/common/Modal.tsx
import React, { useEffect } from 'react';

interface ModalProps {
  isOpen: boolean;
  onClose: () => void;
  title: string;
  children: React.ReactNode;
  size?: 'sm' | 'md' | 'lg' | 'xl';
}

const Modal: React.FC<ModalProps> = ({ 
  isOpen, 
  onClose, 
  title, 
  children, 
  size = 'md' 
}) => {
  useEffect(() => {
    const handleEscape = (e: KeyboardEvent) => {
      if (e.key === 'Escape') {
        onClose();
      }
    };

    if (isOpen) {
      document.addEventListener('keydown', handleEscape);
      document.body.style.overflow = 'hidden';
    }

    return () => {
      document.removeEventListener('keydown', handleEscape);
      document.body.style.overflow = 'unset';
    };
  }, [isOpen, onClose]);

  if (!isOpen) return null;

  const sizeClasses = {
    sm: 'max-w-md',
    md: 'max-w-lg',
    lg: 'max-w-4xl',
    xl: 'max-w-6xl'
  };

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center">
      {/* Backdrop */}
      <div 
        className="absolute inset-0 bg-black bg-opacity-50"
        onClick={onClose}
      />
      
      {/* Modal */}
      <div className={`
        relative bg-white rounded-lg shadow-xl w-full mx-4
        ${sizeClasses[size]}
        max-h-[90vh] overflow-hidden
        animate-slideUp
      `}>
        {/* Header */}
        <div className="bg-gradient-to-r from-primary-500 to-secondary-500 text-white px-6 py-4">
          <div className="flex items-center justify-between">
            <h2 className="text-xl font-semibold">{title}</h2>
            <button
              onClick={onClose}
              className="p-1 hover:bg-white hover:bg-opacity-20 rounded-full transition-colors"
            >
              <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
        </div>
        
        {/* Body */}
        <div className="p-6 overflow-y-auto max-h-[calc(90vh-80px)]">
          {children}
        </div>
      </div>
    </div>
  );
};

export default Modal;
```

---

### 46. Sidebar.tsx

- **ê²½ë¡œ:** `frontend/src/components/common/Sidebar.tsx`
- **í¬ê¸°:** 2,736 characters
- **íƒ€ì…:** .tsx

```tsx
// frontend/src/components/common/Sidebar.tsx
import React from 'react';
import { useLocation, useNavigate } from 'react-router-dom';

interface SidebarProps {
  isOpen: boolean;
  onClose: () => void;
}

interface MenuItem {
  id: string;
  label: string;
  icon: string;
  path: string;
}

const menuItems: MenuItem[] = [
  { id: 'dashboard', label: 'ëŒ€ì‹œë³´ë“œ', icon: 'ğŸ“Š', path: '/' },
  { id: 'markers', label: 'ë§ˆì»¤ ê´€ë¦¬', icon: 'ğŸ“', path: '/markers' },
  { id: 'analytics', label: 'í†µê³„ ë¶„ì„', icon: 'ğŸ“ˆ', path: '/analytics' },
  { id: 'settings', label: 'ì„¤ì •', icon: 'âš™ï¸', path: '/settings' },
];

const Sidebar: React.FC<SidebarProps> = ({ isOpen, onClose }) => {
  const location = useLocation();
  const navigate = useNavigate();

  const handleNavigation = (path: string) => {
    navigate(path);
    if (window.innerWidth < 768) {
      onClose();
    }
  };

  return (
    <>
      {/* Overlay for mobile */}
      {isOpen && (
        <div 
          className="fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden"
          onClick={onClose}
        />
      )}
      
      {/* Sidebar */}
      <aside className={`
        fixed top-16 left-0 h-full w-64 bg-white shadow-lg z-40 transform transition-transform duration-300 ease-in-out
        ${isOpen ? 'translate-x-0' : '-translate-x-full'}
      `}>
        <nav className="mt-4">
          <ul className="space-y-1">
            {menuItems.map((item) => (
              <li key={item.id}>
                <button
                  onClick={() => handleNavigation(item.path)}
                  className={`
                    w-full flex items-center space-x-3 px-6 py-3 text-left transition-colors duration-200
                    border-l-4 border-transparent hover:bg-gray-50 hover:border-primary-500
                    ${location.pathname === item.path 
                      ? 'bg-primary-50 border-primary-500 text-primary-700 font-medium' 
                      : 'text-gray-700'
                    }
                  `}
                >
                  <span className="text-xl">{item.icon}</span>
                  <span className="font-medium">{item.label}</span>
                </button>
              </li>
            ))}
          </ul>
        </nav>
        
        <div className="absolute bottom-4 left-4 right-4">
          <div className="bg-gray-50 rounded-lg p-4">
            <h4 className="text-sm font-medium text-gray-900 mb-2">ì‹œìŠ¤í…œ ìƒíƒœ</h4>
            <div className="flex items-center space-x-2">
              <div className="w-3 h-3 bg-green-400 rounded-full"></div>
              <span className="text-sm text-gray-600">ì •ìƒ ìš´ì˜ ì¤‘</span>
            </div>
          </div>
        </div>
      </aside>
    </>
  );
};

export default Sidebar;
```

---

### 47. Header.tsx

- **ê²½ë¡œ:** `frontend/src/components/common/Header.tsx`
- **í¬ê¸°:** 2,066 characters
- **íƒ€ì…:** .tsx

```tsx
// frontend/src/components/common/Header.tsx
import React from 'react';

interface HeaderProps {
  onToggleSidebar: () => void;
}

const Header: React.FC<HeaderProps> = ({ onToggleSidebar }) => {
  return (
    <header className="bg-gradient-to-r from-primary-500 to-secondary-500 text-white shadow-lg fixed top-0 left-0 right-0 z-50 h-16">
      <div className="flex items-center justify-between h-full px-6">
        <div className="flex items-center space-x-4">
          <button
            onClick={onToggleSidebar}
            className="p-2 rounded-lg hover:bg-white hover:bg-opacity-20 transition-colors"
          >
            <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" />
            </svg>
          </button>
          <div className="flex items-center space-x-2">
            <span className="text-2xl">ğŸ›£ï¸</span>
            <h1 className="text-xl font-bold">ë„ë¡œê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
          </div>
        </div>
        
        <div className="flex items-center space-x-4">
          <button className="relative p-2 rounded-lg hover:bg-white hover:bg-opacity-20 transition-colors">
            <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 17h5l-5 5-5-5h5v-12a4 4 0 00-8 0v12" />
            </svg>
            <span className="absolute -top-1 -right-1 bg-red-500 text-xs rounded-full h-5 w-5 flex items-center justify-center">
              3
            </span>
          </button>
          
          <div className="flex items-center space-x-2">
            <div className="w-8 h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
              <span className="text-sm font-medium">ê¹€</span>
            </div>
            <span className="text-sm font-medium">ê¹€ê´€ë¦¬ì</span>
          </div>
        </div>
      </div>
    </header>
  );
};

export default Header;
```

---

### 48. LoadingSpinner.tsx

- **ê²½ë¡œ:** `frontend/src/components/common/LoadingSpinner.tsx`
- **í¬ê¸°:** 706 characters
- **íƒ€ì…:** .tsx

```tsx
// frontend/src/components/common/LoadingSpinner.tsx
import React from 'react';

interface LoadingSpinnerProps {
  size?: 'sm' | 'md' | 'lg';
  text?: string;
}

const LoadingSpinner: React.FC<LoadingSpinnerProps> = ({ 
  size = 'md', 
  text = 'ë¡œë”© ì¤‘...' 
}) => {
  const sizeClasses = {
    sm: 'w-4 h-4',
    md: 'w-8 h-8',
    lg: 'w-12 h-12'
  };

  return (
    <div className="flex flex-col items-center justify-center space-y-2">
      <div className={`
        ${sizeClasses[size]} 
        border-4 border-gray-200 border-t-primary-500 
        rounded-full animate-spin
      `} />
      {text && <p className="text-gray-600 text-sm">{text}</p>}
    </div>
  );
};

export default LoadingSpinner;
```

---

### 49. MarkerList.tsx

- **ê²½ë¡œ:** `frontend/src/components/markers/MarkerList.tsx`
- **í¬ê¸°:** 2,035 characters
- **íƒ€ì…:** .tsx

```tsx
import React from 'react';
import { Marker } from '../../types/marker';
import { MARKER_STATUS_COLORS, MARKER_PRIORITY_COLORS } from '../../utils/constants';
import { formatDate, getStatusBadgeClass } from '../../utils/helpers';

interface MarkerListProps {
  markers: Marker[];
  onMarkerClick: (marker: Marker) => void;
  loading?: boolean;
}

const MarkerList: React.FC<MarkerListProps> = ({ markers, onMarkerClick, loading }) => {
  if (loading) {
    return (
      <div className="flex justify-center py-8">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"></div>
      </div>
    );
  }

  if (markers.length === 0) {
    return (
      <div className="text-center py-8 text-gray-500">
        <div className="text-4xl mb-4">ğŸ“</div>
        <p>ë“±ë¡ëœ ë§ˆì»¤ê°€ ì—†ìŠµë‹ˆë‹¤</p>
      </div>
    );
  }

  return (
    <div className="space-y-4">
      {markers.map((marker) => (
        <div
          key={marker.id}
          onClick={() => onMarkerClick(marker)}
          className="bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer"
        >
          <div className="flex justify-between items-start mb-2">
            <h3 className="font-semibold text-gray-900">{marker.title}</h3>
            <div className="flex space-x-2">
              <span className={getStatusBadgeClass(marker.status, MARKER_STATUS_COLORS)}>
                {marker.status}
              </span>
              <span className={getStatusBadgeClass(marker.priority, MARKER_PRIORITY_COLORS)}>
                {marker.priority}
              </span>
            </div>
          </div>
          
          <p className="text-sm text-gray-600 mb-2">{marker.description}</p>
          
          <div className="flex justify-between items-center text-xs text-gray-500">
            <span>ï¿½ï¿½ {marker.road_name || marker.address}</span>
            <span>{formatDate(marker.created_at)}</span>
          </div>
        </div>
      ))}
    </div>
  );
};

export default MarkerList;

```

---

### 50. MarkerDetail.tsx

- **ê²½ë¡œ:** `frontend/src/components/markers/MarkerDetail.tsx`
- **í¬ê¸°:** 10,557 characters
- **íƒ€ì…:** .tsx

```tsx
// frontend/src/components/markers/MarkerDetail.tsx (ìˆ˜ì •ëœ ë²„ì „)
import React, { useState } from 'react';
import { Marker, MarkerStatus, MarkerPriority, MarkerUpdate } from '../../types/marker';
import { MARKER_STATUS_LABELS, MARKER_PRIORITY_LABELS, MARKER_STATUS_COLORS, MARKER_PRIORITY_COLORS } from '../../utils/constants';
import { formatDate, getStatusBadgeClass } from '../../utils/helpers';

interface MarkerDetailProps {
  marker: Marker;
  onEdit: (updates: MarkerUpdate) => Promise<void>; // Promise<void> ëª…ì‹œ
  onDelete: () => Promise<void>; // Promise<void> ëª…ì‹œ
}

const MarkerDetail: React.FC<MarkerDetailProps> = ({ marker, onEdit, onDelete }) => {
  const [isEditing, setIsEditing] = useState(false);
  const [editData, setEditData] = useState<MarkerUpdate>({
    title: marker.title,
    description: marker.description,
    status: marker.status,
    priority: marker.priority,
    assigned_to: marker.assigned_to
  });
  const [isLoading, setIsLoading] = useState(false);

  const handleEditSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    try {
      setIsLoading(true);
      await onEdit(editData);
      setIsEditing(false);
    } catch (error) {
      console.error('ìˆ˜ì • ì¤‘ ì˜¤ë¥˜:', error);
    } finally {
      setIsLoading(false);
    }
  };

  const handleDeleteClick = async () => {
    if (!window.confirm('ì´ ë§ˆì»¤ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
    
    try {
      setIsLoading(true);
      await onDelete();
    } catch (error) {
      console.error('ì‚­ì œ ì¤‘ ì˜¤ë¥˜:', error);
    } finally {
      setIsLoading(false);
    }
  };

  const handleEditCancel = () => {
    setEditData({
      title: marker.title,
      description: marker.description,
      status: marker.status,
      priority: marker.priority,
      assigned_to: marker.assigned_to
    });
    setIsEditing(false);
  };

  if (isEditing) {
    return (
      <div className="space-y-4">
        <h3 className="text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2">
          âœï¸ ë§ˆì»¤ ìˆ˜ì •
        </h3>
        
        <form onSubmit={handleEditSubmit} className="space-y-4">
          {/* ì œëª© */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">ì œëª©</label>
            <input
              type="text"
              value={editData.title || ''}
              onChange={(e) => setEditData(prev => ({ ...prev, title: e.target.value }))}
              className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
              required
            />
          </div>

          {/* ì„¤ëª… */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">ì„¤ëª…</label>
            <textarea
              value={editData.description || ''}
              onChange={(e) => setEditData(prev => ({ ...prev, description: e.target.value }))}
              rows={3}
              className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
            />
          </div>

          {/* ìƒíƒœ */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">ìƒíƒœ</label>
            <select
              value={editData.status || ''}
              onChange={(e) => setEditData(prev => ({ ...prev, status: e.target.value as MarkerStatus }))}
              className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
            >
              {Object.entries(MARKER_STATUS_LABELS).map(([key, label]) => (
                <option key={key} value={key}>{label}</option>
              ))}
            </select>
          </div>

          {/* ìš°ì„ ìˆœìœ„ */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">ìš°ì„ ìˆœìœ„</label>
            <select
              value={editData.priority || ''}
              onChange={(e) => setEditData(prev => ({ ...prev, priority: e.target.value as MarkerPriority }))}
              className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
            >
              {Object.entries(MARKER_PRIORITY_LABELS).map(([key, label]) => (
                <option key={key} value={key}>{label}</option>
              ))}
            </select>
          </div>

          {/* ë‹´ë‹¹ì */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">ë‹´ë‹¹ì</label>
            <input
              type="text"
              value={editData.assigned_to || ''}
              onChange={(e) => setEditData(prev => ({ ...prev, assigned_to: e.target.value }))}
              className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
              placeholder="ë‹´ë‹¹ìëª… (ì„ íƒì‚¬í•­)"
            />
          </div>

          {/* ë²„íŠ¼ */}
          <div className="flex justify-end space-x-3 pt-4 border-t border-gray-200">
            <button
              type="button"
              onClick={handleEditCancel}
              disabled={isLoading}
              className="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50"
            >
              ì·¨ì†Œ
            </button>
            <button
              type="submit"
              disabled={isLoading || !editData.title?.trim()}
              className="px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors disabled:opacity-50 flex items-center space-x-2"
            >
              {isLoading ? (
                <>
                  <span className="animate-spin">ğŸ”„</span>
                  <span>ì €ì¥ ì¤‘...</span>
                </>
              ) : (
                <>
                  <span>âœ…</span>
                  <span>ì €ì¥</span>
                </>
              )}
            </button>
          </div>
        </form>
      </div>
    );
  }

  return (
    <div className="space-y-6">
      {/* ê¸°ë³¸ ì •ë³´ */}
      <div>
        <div className="flex items-center justify-between border-b border-gray-200 pb-2 mb-4">
          <h3 className="text-lg font-semibold text-gray-900">ğŸ“‹ ê¸°ë³¸ ì •ë³´</h3>
          <div className="flex space-x-2">
            <button
              onClick={() => setIsEditing(true)}
              disabled={isLoading}
              className="text-blue-600 hover:text-blue-700 p-1 disabled:opacity-50"
              title="ìˆ˜ì •"
            >
              âœï¸
            </button>
          </div>
        </div>
        
        <div className="space-y-4">
          <div>
            <h4 className="font-semibold text-gray-900 text-lg mb-2">{marker.title}</h4>
            <p className="text-gray-600 leading-relaxed">{marker.description || 'ì„¤ëª… ì—†ìŒ'}</p>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">ìƒíƒœ</label>
              <span className={getStatusBadgeClass(marker.status, MARKER_STATUS_COLORS)}>
                {MARKER_STATUS_LABELS[marker.status]}
              </span>
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">ìš°ì„ ìˆœìœ„</label>
              <span className={getStatusBadgeClass(marker.priority, MARKER_PRIORITY_COLORS)}>
                {MARKER_PRIORITY_LABELS[marker.priority]}
              </span>
            </div>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">ë‹´ë‹¹ì</label>
              <p className="text-sm text-gray-900">{marker.assigned_to || 'ë¯¸ë°°ì •'}</p>
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">ìƒì„±ì</label>
              <p className="text-sm text-gray-900">{marker.created_by}</p>
            </div>
          </div>
        </div>
      </div>

      {/* ìœ„ì¹˜ ì •ë³´ */}
      <div>
        <h4 className="font-semibold text-gray-900 border-b border-gray-200 pb-2 mb-4">ğŸ“ ìœ„ì¹˜ ì •ë³´</h4>
        <div className="space-y-2">
          <div>
            <label className="block text-sm font-medium text-gray-700">ì£¼ì†Œ</label>
            <p className="text-sm text-gray-900">{marker.address || 'ì£¼ì†Œ ì—†ìŒ'}</p>
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-700">ë„ë¡œëª…</label>
            <p className="text-sm text-gray-900">{marker.road_name || 'ë„ë¡œëª… ì—†ìŒ'}</p>
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-700">ì¢Œí‘œ</label>
            <p className="text-sm text-gray-900 font-mono">
              {marker.latitude.toFixed(6)}, {marker.longitude.toFixed(6)}
            </p>
          </div>
        </div>
      </div>

      {/* ì‹œê°„ ì •ë³´ */}
      <div>
        <h4 className="font-semibold text-gray-900 border-b border-gray-200 pb-2 mb-4">ğŸ• ì‹œê°„ ì •ë³´</h4>
        <div className="space-y-2">
          <div>
            <label className="block text-sm font-medium text-gray-700">ìƒì„±ì¼</label>
            <p className="text-sm text-gray-900">{formatDate(marker.created_at)}</p>
          </div>
          {marker.updated_at && (
            <div>
              <label className="block text-sm font-medium text-gray-700">ìˆ˜ì •ì¼</label>
              <p className="text-sm text-gray-900">{formatDate(marker.updated_at)}</p>
            </div>
          )}
        </div>
      </div>

      {/* ì•¡ì…˜ ë²„íŠ¼ */}
      <div className="flex justify-end space-x-3 pt-4 border-t border-gray-200">
        <button
          onClick={() => setIsEditing(true)}
          disabled={isLoading}
          className="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 flex items-center space-x-2"
        >
          <span>âœï¸</span>
          <span>ìˆ˜ì •</span>
        </button>
        <button
          onClick={handleDeleteClick}
          disabled={isLoading}
          className="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors disabled:opacity-50 flex items-center space-x-2"
        >
          {isLoading ? (
            <>
              <span className="animate-spin">ğŸ”„</span>
              <span>ì‚­ì œ ì¤‘...</span>
            </>
          ) : (
            <>
              <span>ğŸ—‘ï¸</span>
              <span>ì‚­ì œ</span>
            </>
          )}
        </button>
      </div>
    </div>
  );
};

export default MarkerDetail;
```

---

### 51. MarkerForm.tsx

- **ê²½ë¡œ:** `frontend/src/components/markers/MarkerForm.tsx`
- **í¬ê¸°:** 3,384 characters
- **íƒ€ì…:** .tsx

```tsx
import React, { useState } from 'react';
import { MarkerCreate, IssueType, MarkerPriority } from '../../types/marker';

interface MarkerFormProps {
  onSubmit: (marker: MarkerCreate) => void;
  onCancel: () => void;
  initialData?: Partial<MarkerCreate>;
}

const MarkerForm: React.FC<MarkerFormProps> = ({ onSubmit, onCancel, initialData }) => {
  const [formData, setFormData] = useState<MarkerCreate>({
    title: initialData?.title || '',
    description: initialData?.description || '',
    latitude: initialData?.latitude || 37.5665,
    longitude: initialData?.longitude || 126.9780,
    address: initialData?.address || '',
    road_name: initialData?.road_name || '',
    issue_type: initialData?.issue_type || IssueType.CRACK,
    priority: initialData?.priority || MarkerPriority.NORMAL,
    assigned_to: initialData?.assigned_to || '',
    created_by: 'ê¹€ê´€ë¦¬ì' // ì„ì‹œê°’
  });

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    onSubmit(formData);
  };

  return (
    <form onSubmit={handleSubmit} className="space-y-4">
      <div>
        <label className="block text-sm font-medium text-gray-700 mb-1">ì œëª©</label>
        <input
          type="text"
          required
          value={formData.title}
          onChange={(e) => setFormData({ ...formData, title: e.target.value })}
          className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500"
        />
      </div>
      
      <div>
        <label className="block text-sm font-medium text-gray-700 mb-1">ì„¤ëª…</label>
        <textarea
          value={formData.description}
          onChange={(e) => setFormData({ ...formData, description: e.target.value })}
          rows={3}
          className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500"
        />
      </div>
      
      <div className="grid grid-cols-2 gap-4">
        <div>
          <label className="block text-sm font-medium text-gray-700 mb-1">ìœ„ë„</label>
          <input
            type="number"
            step="any"
            required
            value={formData.latitude}
            onChange={(e) => setFormData({ ...formData, latitude: parseFloat(e.target.value) })}
            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500"
          />
        </div>
        <div>
          <label className="block text-sm font-medium text-gray-700 mb-1">ê²½ë„</label>
          <input
            type="number"
            step="any"
            required
            value={formData.longitude}
            onChange={(e) => setFormData({ ...formData, longitude: parseFloat(e.target.value) })}
            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500"
          />
        </div>
      </div>
      
      <div className="flex justify-end space-x-3">
        <button
          type="button"
          onClick={onCancel}
          className="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"
        >
          ì·¨ì†Œ
        </button>
        <button
          type="submit"
          className="px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600"
        >
          ì €ì¥
        </button>
      </div>
    </form>
  );
};

export default MarkerForm;

```

---

### 52. useVideo.ts

- **ê²½ë¡œ:** `frontend/src/hooks/useVideo.ts`
- **í¬ê¸°:** 1,738 characters
- **íƒ€ì…:** .ts

```typescript
// frontend/src/hooks/useVideo.ts
import { useState, useEffect } from 'react';
import { Video, VideoUpload } from '../types/video';
import { videoService } from '../services/videoService';

export const useVideos = (markerId: number | null) => {
  const [videos, setVideos] = useState<Video[]>([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const fetchVideos = async (id: number) => {
    try {
      setLoading(true);
      setError(null);
      const data = await videoService.getMarkerVideos(id);
      setVideos(data);
    } catch (err) {
      setError(err instanceof Error ? err.message : 'ë¹„ë””ì˜¤ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    } finally {
      setLoading(false);
    }
  };

  const uploadVideo = async (id: number, upload: VideoUpload): Promise<Video | null> => {
    try {
      const newVideo = await videoService.uploadVideo(id, upload);
      setVideos(prev => [newVideo, ...prev]);
      return newVideo;
    } catch (err) {
      setError(err instanceof Error ? err.message : 'ë¹„ë””ì˜¤ ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      return null;
    }
  };

  const deleteVideo = async (id: number): Promise<boolean> => {
    try {
      await videoService.deleteVideo(id);
      setVideos(prev => prev.filter(video => video.id !== id));
      return true;
    } catch (err) {
      setError(err instanceof Error ? err.message : 'ë¹„ë””ì˜¤ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      return false;
    }
  };

  useEffect(() => {
    if (markerId) {
      fetchVideos(markerId);
    }
  }, [markerId]);

  return {
    videos,
    loading,
    error,
    refetch: () => markerId && fetchVideos(markerId),
    uploadVideo: (upload: VideoUpload) => markerId && uploadVideo(markerId, upload),
    deleteVideo
  };
};
```

---

### 53. useMarkers.ts

- **ê²½ë¡œ:** `frontend/src/hooks/useMarkers.ts`
- **í¬ê¸°:** 2,853 characters
- **íƒ€ì…:** .ts

```typescript
// frontend/src/hooks/useMarkers.ts
import { useState, useEffect } from 'react';
import { Marker, MarkerCreate, MarkerUpdate } from '../types/marker';
import { markerService, MarkerQueryParams } from '../services/markerService';

export const useMarkers = (params: MarkerQueryParams = {}) => {
  const [markers, setMarkers] = useState<Marker[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  const fetchMarkers = async () => {
    try {
      setLoading(true);
      setError(null);
      const data = await markerService.getMarkers(params);
      setMarkers(data);
    } catch (err) {
      setError(err instanceof Error ? err.message : 'ë§ˆì»¤ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    } finally {
      setLoading(false);
    }
  };

  const createMarker = async (marker: MarkerCreate): Promise<Marker | null> => {
    try {
      const newMarker = await markerService.createMarker(marker);
      setMarkers(prev => [newMarker, ...prev]);
      return newMarker;
    } catch (err) {
      setError(err instanceof Error ? err.message : 'ë§ˆì»¤ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      return null;
    }
  };

  const updateMarker = async (id: number, updates: MarkerUpdate): Promise<Marker | null> => {
    try {
      const updatedMarker = await markerService.updateMarker(id, updates);
      setMarkers(prev => prev.map(marker => 
        marker.id === id ? updatedMarker : marker
      ));
      return updatedMarker;
    } catch (err) {
      setError(err instanceof Error ? err.message : 'ë§ˆì»¤ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      return null;
    }
  };

  const deleteMarker = async (id: number): Promise<boolean> => {
    try {
      await markerService.deleteMarker(id);
      setMarkers(prev => prev.filter(marker => marker.id !== id));
      return true;
    } catch (err) {
      setError(err instanceof Error ? err.message : 'ë§ˆì»¤ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      return false;
    }
  };

  useEffect(() => {
    fetchMarkers();
  }, [JSON.stringify(params)]);

  return {
    markers,
    loading,
    error,
    refetch: fetchMarkers,
    createMarker,
    updateMarker,
    deleteMarker
  };
};

export const useMarker = (id: number | null) => {
  const [marker, setMarker] = useState<Marker | null>(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const fetchMarker = async (markerId: number) => {
    try {
      setLoading(true);
      setError(null);
      const data = await markerService.getMarker(markerId);
      setMarker(data);
    } catch (err) {
      setError(err instanceof Error ? err.message : 'ë§ˆì»¤ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    if (id) {
      fetchMarker(id);
    }
  }, [id]);

  return {
    marker,
    loading,
    error,
    refetch: () => id && fetchMarker(id)
  };
};

```

---

### 54. useAIAnalysis.ts

- **ê²½ë¡œ:** `frontend/src/hooks/useAIAnalysis.ts`
- **í¬ê¸°:** 2,146 characters
- **íƒ€ì…:** .ts

```typescript
// frontend/src/hooks/useAIAnalysis.ts
import { useState, useEffect } from 'react';
import { Analysis } from '../types/analysis';
import { analysisService } from '../services/analysisService';

export const useAnalyses = (videoId: number | null) => {
  const [analyses, setAnalyses] = useState<Analysis[]>([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const fetchAnalyses = async (id: number) => {
    try {
      setLoading(true);
      setError(null);
      const data = await analysisService.getVideoAnalyses(id);
      setAnalyses(data);
    } catch (err) {
      setError(err instanceof Error ? err.message : 'ë¶„ì„ ê²°ê³¼ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    } finally {
      setLoading(false);
    }
  };

  const startAnalysis = async (id: number): Promise<Analysis | null> => {
    try {
      const newAnalysis = await analysisService.startAnalysis(id);
      setAnalyses(prev => [newAnalysis, ...prev]);
      return newAnalysis;
    } catch (err) {
      setError(err instanceof Error ? err.message : 'AI ë¶„ì„ ì‹œì‘ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      return null;
    }
  };

  useEffect(() => {
    if (videoId) {
      fetchAnalyses(videoId);
    }
  }, [videoId]);

  return {
    analyses,
    loading,
    error,
    refetch: () => videoId && fetchAnalyses(videoId),
    startAnalysis: () => videoId && startAnalysis(videoId)
  };
};

export const useAnalysis = (id: number | null) => {
  const [analysis, setAnalysis] = useState<Analysis | null>(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const fetchAnalysis = async (analysisId: number) => {
    try {
      setLoading(true);
      setError(null);
      const data = await analysisService.getAnalysis(analysisId);
      setAnalysis(data);
    } catch (err) {
      setError(err instanceof Error ? err.message : 'ë¶„ì„ ê²°ê³¼ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    if (id) {
      fetchAnalysis(id);
    }
  }, [id]);

  return {
    analysis,
    loading,
    error,
    refetch: () => id && fetchAnalysis(id)
  };
};
```

---

### 55. AnalyticsPage.tsx

- **ê²½ë¡œ:** `frontend/src/pages/AnalyticsPage.tsx`
- **í¬ê¸°:** 728 characters
- **íƒ€ì…:** .tsx

```tsx
// frontend/src/pages/AnalyticsPage.tsx
import React from 'react';

const AnalyticsPage: React.FC = () => {
  return (
    <div className="space-y-6">
      <div className="bg-white rounded-lg shadow-sm p-6">
        <h1 className="text-2xl font-bold text-gray-900 mb-2">í†µê³„ ë¶„ì„</h1>
        <p className="text-gray-600">ë„ë¡œ ìœ ì§€ë³´ìˆ˜ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ ì¸ì‚¬ì´íŠ¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤</p>
      </div>
      
      <div className="bg-white rounded-lg shadow-sm p-6">
        <div className="text-center text-gray-500">
          <div className="text-4xl mb-4">ğŸ“ˆ</div>
          <p className="text-lg font-medium">í†µê³„ ë¶„ì„ í˜ì´ì§€</p>
          <p className="text-sm">ì°¨íŠ¸ì™€ ë¶„ì„ ë°ì´í„°ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</p>
        </div>
      </div>
    </div>
  );
};

export default AnalyticsPage;

```

---

### 56. MarkersPage.tsx

- **ê²½ë¡œ:** `frontend/src/pages/MarkersPage.tsx`
- **í¬ê¸°:** 19,525 characters
- **íƒ€ì…:** .tsx

```tsx
import React, { useState, useEffect } from 'react';
import { useMarkers } from '../hooks/useMarkers';
import { useVideos } from '../hooks/useVideo';
import { useAnalyses } from '../hooks/useAIAnalysis';
import { Marker, MarkerStatus, MarkerPriority, IssueType } from '../types/marker';
import { Video } from '../types/video';
import { Analysis } from '../types/analysis';
import LoadingSpinner from '../components/common/LoadingSpinner';
import Modal from '../components/common/Modal';
import MarkerList from '../components/markers/MarkerList';
import MarkerDetail from '../components/markers/MarkerDetail';
import VideoComparisonPlayer from '../components/video/VideoComparisonPlayer';
import AIAnalysisResult from '../components/video/AIAnalysisResult';
import { MARKER_STATUS_LABELS, MARKER_PRIORITY_LABELS, ISSUE_TYPE_LABELS } from '../utils/constants';
import { formatDate, formatFileSize } from '../utils/helpers';
import toast from 'react-hot-toast';

const MarkersPage: React.FC = () => {
  const [searchQuery, setSearchQuery] = useState('');
  const [statusFilter, setStatusFilter] = useState<MarkerStatus | ''>('');
  const [priorityFilter, setPriorityFilter] = useState<MarkerPriority | ''>('');
  const [issueTypeFilter, setIssueTypeFilter] = useState<IssueType | ''>('');
  
  // ëª¨ë‹¬ ìƒíƒœ
  const [selectedMarker, setSelectedMarker] = useState<Marker | null>(null);
  const [selectedVideo, setSelectedVideo] = useState<Video | null>(null);
  const [selectedAnalysis, setSelectedAnalysis] = useState<Analysis | null>(null);
  const [showDetailModal, setShowDetailModal] = useState(false);
  const [showVideoModal, setShowVideoModal] = useState(false);
  const [showAnalysisModal, setShowAnalysisModal] = useState(false);

  // í˜ì´ì§€ë„¤ì´ì…˜
  const [currentPage, setCurrentPage] = useState(0);
  const [pageSize] = useState(10);

  // í•„í„°ë§ëœ ë§ˆì»¤ë“¤ ì¡°íšŒ
  const { 
    markers, 
    loading, 
    error, 
    refetch,
    updateMarker,
    deleteMarker 
  } = useMarkers({
    skip: currentPage * pageSize,
    limit: pageSize,
    search: searchQuery || undefined,
    status: statusFilter || undefined,
    priority: priorityFilter || undefined,
    issue_type: issueTypeFilter || undefined
  });

  // ì„ íƒëœ ë§ˆì»¤ì˜ ë¹„ë””ì˜¤ë“¤
  const {
    videos,
    loading: videosLoading
  } = useVideos(selectedMarker?.id || null);

  // ì„ íƒëœ ë¹„ë””ì˜¤ì˜ ë¶„ì„ë“¤
  const {
    analyses,
    loading: analysesLoading,
    startAnalysis
  } = useAnalyses(selectedVideo?.id || null);

  // ë§ˆì»¤ í´ë¦­ í•¸ë“¤ëŸ¬
  const handleMarkerClick = (marker: Marker) => {
    setSelectedMarker(marker);
    setShowDetailModal(true);
  };

  // ë§ˆì»¤ ìˆ˜ì • í•¸ë“¤ëŸ¬
  const handleMarkerEdit = async (markerId: number, updates: any) => {
    try {
      const updatedMarker = await updateMarker(markerId, updates);
      if (updatedMarker) {
        toast.success('ë§ˆì»¤ ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
        if (selectedMarker?.id === markerId) {
          setSelectedMarker(updatedMarker);
        }
      }
    } catch (error) {
      console.error('ë§ˆì»¤ ìˆ˜ì • ì˜¤ë¥˜:', error);
      toast.error('ë§ˆì»¤ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
  };

  // ë§ˆì»¤ ì‚­ì œ í•¸ë“¤ëŸ¬
  const handleMarkerDelete = async (markerId: number) => {
    if (!window.confirm('ì´ ë§ˆì»¤ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
    
    try {
      const success = await deleteMarker(markerId);
      if (success) {
        toast.success('ë§ˆì»¤ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
        setShowDetailModal(false);
        setSelectedMarker(null);
      }
    } catch (error) {
      console.error('ë§ˆì»¤ ì‚­ì œ ì˜¤ë¥˜:', error);
      toast.error('ë§ˆì»¤ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
  };

  // ë¹„ë””ì˜¤ í´ë¦­ í•¸ë“¤ëŸ¬ (ë¶„ì„ í¬í•¨)
  const handleVideoClick = (video: Video) => {
    setSelectedVideo(video);
    setShowVideoModal(true);
  };

  // AI ë¶„ì„ ì‹œì‘ í•¸ë“¤ëŸ¬
  const handleStartAnalysis = async (videoId: number) => {
    try {
      const newAnalysis = await startAnalysis();
      if (newAnalysis) {
        toast.success('AI ë¶„ì„ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. ì§„í–‰ ìƒí™©ì„ í™•ì¸í•˜ì„¸ìš”.');
        // ë¶„ì„ ëª¨ë‹¬ ì—´ê¸°
        setSelectedAnalysis(newAnalysis);
        setShowAnalysisModal(true);
      }
    } catch (error) {
      console.error('ë¶„ì„ ì‹œì‘ ì˜¤ë¥˜:', error);
      toast.error('AI ë¶„ì„ ì‹œì‘ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
  };

  // ë¶„ì„ ê²°ê³¼ í´ë¦­ í•¸ë“¤ëŸ¬
  const handleAnalysisClick = (analysis: Analysis) => {
    setSelectedAnalysis(analysis);
    setShowAnalysisModal(true);
  };

  // ê²€ìƒ‰ ì´ˆê¸°í™”
  const handleSearchReset = () => {
    setSearchQuery('');
    setStatusFilter('');
    setPriorityFilter('');
    setIssueTypeFilter('');
    setCurrentPage(0);
  };

  // í˜ì´ì§€ ë³€ê²½ í•¸ë“¤ëŸ¬
  const handlePageChange = (page: number) => {
    setCurrentPage(page);
  };

  useEffect(() => {
    // í•„í„°ê°€ ë³€ê²½ë˜ë©´ ì²« í˜ì´ì§€ë¡œ ì´ë™
    setCurrentPage(0);
  }, [searchQuery, statusFilter, priorityFilter, issueTypeFilter]);

  if (loading && markers.length === 0) {
    return (
      <div className="flex items-center justify-center min-h-[60vh]">
        <LoadingSpinner size="lg" text="ë§ˆì»¤ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..." />
      </div>
    );
  }

  return (
    <div className="space-y-6">
      {/* Page Header */}
      <div className="bg-white rounded-lg shadow-sm p-6">
        <div className="flex justify-between items-center">
          <div>
            <h1 className="text-2xl font-bold text-gray-900 mb-2">ğŸ¤– AI ë¶„ì„ ë§ˆì»¤ ê´€ë¦¬</h1>
            <p className="text-gray-600">ë„ë¡œ ê· ì—´ì„ AIë¡œ ë¶„ì„í•˜ê³  ìœ ì§€ë³´ìˆ˜ ì‘ì—…ì„ ê´€ë¦¬í•©ë‹ˆë‹¤</p>
          </div>
          <div className="flex items-center space-x-3">
            <button
              onClick={() => refetch()}
              disabled={loading}
              className="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg transition-colors flex items-center space-x-2"
            >
              <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
              </svg>
              <span>ìƒˆë¡œê³ ì¹¨</span>
            </button>
          </div>
        </div>
      </div>

      {/* ê²€ìƒ‰ ë° í•„í„° */}
      <div className="bg-white rounded-lg shadow-sm p-6">
        <h2 className="text-lg font-semibold text-gray-900 mb-4">ê²€ìƒ‰ ë° í•„í„°</h2>
        
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4">
          {/* ê²€ìƒ‰ */}
          <div className="lg:col-span-2">
            <label className="block text-sm font-medium text-gray-700 mb-1">ê²€ìƒ‰</label>
            <input
              type="text"
              value={searchQuery}
              onChange={(e) => setSearchQuery(e.target.value)}
              placeholder="ë§ˆì»¤ ì œëª©, ë„ë¡œëª…, ë‹´ë‹¹ìëª…..."
              className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
            />
          </div>
          
          {/* ìƒíƒœ í•„í„° */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">ìƒíƒœ</label>
            <select
              value={statusFilter}
              onChange={(e) => setStatusFilter(e.target.value as MarkerStatus | '')}
              className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
            >
              <option value="">ì „ì²´</option>
              {Object.entries(MARKER_STATUS_LABELS).map(([key, label]) => (
                <option key={key} value={key}>{label}</option>
              ))}
            </select>
          </div>
          
          {/* ìš°ì„ ìˆœìœ„ í•„í„° */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">ìš°ì„ ìˆœìœ„</label>
            <select
              value={priorityFilter}
              onChange={(e) => setPriorityFilter(e.target.value as MarkerPriority | '')}
              className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
            >
              <option value="">ì „ì²´</option>
              {Object.entries(MARKER_PRIORITY_LABELS).map(([key, label]) => (
                <option key={key} value={key}>{label}</option>
              ))}
            </select>
          </div>
          
          {/* ì´ìŠˆ ìœ í˜• í•„í„° */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">ì´ìŠˆ ìœ í˜•</label>
            <select
              value={issueTypeFilter}
              onChange={(e) => setIssueTypeFilter(e.target.value as IssueType | '')}
              className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
            >
              <option value="">ì „ì²´</option>
              {Object.entries(ISSUE_TYPE_LABELS).map(([key, label]) => (
                <option key={key} value={key}>{label}</option>
              ))}
            </select>
          </div>
        </div>

        <div className="flex justify-between items-center">
          <div className="text-sm text-gray-600">
            {loading ? 'ê²€ìƒ‰ ì¤‘...' : `ì´ ${markers.length}ê°œì˜ ë§ˆì»¤`}
          </div>
          <button
            onClick={handleSearchReset}
            className="text-sm text-primary-600 hover:text-primary-700"
          >
            í•„í„° ì´ˆê¸°í™”
          </button>
        </div>
      </div>

      {/* ë§ˆì»¤ ëª©ë¡ */}
      <div className="bg-white rounded-lg shadow-sm">
        <div className="p-6 border-b border-gray-200">
          <h2 className="text-lg font-semibold text-gray-900">ë§ˆì»¤ ëª©ë¡</h2>
        </div>
        
        {error ? (
          <div className="p-6 text-center text-red-600">
            <p className="mb-4">ë§ˆì»¤ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>
            <p className="text-sm mb-4">{error}</p>
            <button
              onClick={() => refetch()}
              className="bg-red-100 hover:bg-red-200 text-red-800 px-4 py-2 rounded-lg transition-colors"
            >
              ë‹¤ì‹œ ì‹œë„
            </button>
          </div>
        ) : (
          <div className="p-6">
            <MarkerList 
              markers={markers}
              onMarkerClick={handleMarkerClick}
              loading={loading}
            />
            
            {/* í˜ì´ì§€ë„¤ì´ì…˜ */}
            {markers.length > 0 && (
              <div className="flex justify-center items-center mt-6 space-x-2">
                <button
                  onClick={() => handlePageChange(Math.max(0, currentPage - 1))}
                  disabled={currentPage === 0}
                  className="px-3 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50"
                >
                  ì´ì „
                </button>
                
                <span className="px-4 py-2 text-sm text-gray-600">
                  í˜ì´ì§€ {currentPage + 1}
                </span>
                
                <button
                  onClick={() => handlePageChange(currentPage + 1)}
                  disabled={markers.length < pageSize}
                  className="px-3 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50"
                >
                  ë‹¤ìŒ
                </button>
              </div>
            )}
          </div>
        )}
      </div>

      {/* ë§ˆì»¤ ìƒì„¸ ëª¨ë‹¬ */}
      <Modal
        isOpen={showDetailModal}
        onClose={() => {
          setShowDetailModal(false);
          setSelectedMarker(null);
        }}
        title={selectedMarker ? `${selectedMarker.title}` : 'ë§ˆì»¤ ìƒì„¸ ì •ë³´'}
        size="xl"
      >
        {selectedMarker && (
          <div className="space-y-6">
            {/* ê¸°ë³¸ ì •ë³´ */}
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <MarkerDetail
                  marker={selectedMarker}
                  onEdit={(updates) => handleMarkerEdit(selectedMarker.id, updates)}
                  onDelete={() => handleMarkerDelete(selectedMarker.id)}
                />
              </div>
              
              {/* ìƒì„¸ í†µê³„ */}
              <div className="space-y-4">
                <h3 className="text-lg font-semibold text-gray-900">ğŸ“Š ìƒì„¸ í†µê³„</h3>
                <div className="grid grid-cols-2 gap-4">
                  <div className="bg-blue-50 rounded-lg p-4 text-center">
                    <div className="text-2xl font-bold text-blue-600">{selectedMarker.video_count}</div>
                    <div className="text-sm text-blue-800">ì—…ë¡œë“œëœ ë¹„ë””ì˜¤</div>
                  </div>
                  <div className="bg-green-50 rounded-lg p-4 text-center">
                    <div className="text-2xl font-bold text-green-600">{selectedMarker.analysis_count}</div>
                    <div className="text-sm text-green-800">AI ë¶„ì„ ì™„ë£Œ</div>
                  </div>
                </div>
              </div>
            </div>

            {/* ë¹„ë””ì˜¤ ë° ë¶„ì„ ëª©ë¡ */}
            <div>
              <div className="flex justify-between items-center mb-4">
                <h3 className="text-lg font-semibold text-gray-900">ğŸ¥ ì—…ë¡œë“œëœ ë¹„ë””ì˜¤ ë° AI ë¶„ì„</h3>
                <span className="text-sm text-gray-500">{videos.length}ê°œ</span>
              </div>
              
              {videosLoading ? (
                <div className="text-center py-8">
                  <LoadingSpinner text="ë¹„ë””ì˜¤ ëª©ë¡ ë¡œë”© ì¤‘..." />
                </div>
              ) : videos.length === 0 ? (
                <div className="text-center py-8 text-gray-500">
                  <div className="text-4xl mb-2">ğŸ¥</div>
                  <p>ì—…ë¡œë“œëœ ë¹„ë””ì˜¤ê°€ ì—†ìŠµë‹ˆë‹¤</p>
                </div>
              ) : (
                <div className="space-y-4">
                  {videos.map((video) => (
                    <div
                      key={video.id}
                      className="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow"
                    >
                      <div className="flex items-center justify-between">
                        <div className="flex items-center space-x-4">
                          <div className="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <span className="text-2xl">ğŸ¥</span>
                          </div>
                          <div className="flex-1 min-w-0">
                            <h4 className="font-medium text-gray-900 truncate">
                              {video.original_filename}
                            </h4>
                            <div className="text-sm text-gray-500 space-y-1">
                              <div>í¬ê¸°: {formatFileSize(video.file_size)} | ì—…ë¡œë“œ: {video.uploaded_by}</div>
                              <div>ë‚ ì§œ: {formatDate(video.created_at)}</div>
                            </div>
                          </div>
                        </div>
                        
                        <div className="flex items-center space-x-2">
                          <button
                            onClick={() => handleVideoClick(video)}
                            className="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg transition-colors text-sm"
                          >
                            ğŸ“¹ ì˜ìƒ ë³´ê¸°
                          </button>
                          
                          {video.has_analysis ? (
                            <span className="inline-flex items-center text-xs text-green-600 bg-green-100 px-2 py-1 rounded">
                              ğŸ¤– ë¶„ì„ ì™„ë£Œ
                            </span>
                          ) : (
                            <button
                              onClick={() => handleStartAnalysis(video.id)}
                              className="bg-purple-500 hover:bg-purple-600 text-white px-3 py-2 rounded-lg transition-colors text-sm"
                            >
                              ğŸš€ AI ë¶„ì„
                            </button>
                          )}
                        </div>
                      </div>
                      
                      {/* í•´ë‹¹ ë¹„ë””ì˜¤ì˜ ë¶„ì„ ëª©ë¡ í‘œì‹œ */}
                      {video.has_analysis && (
                        <div className="mt-3 pt-3 border-t border-gray-100">
                          <div className="text-sm text-gray-600 mb-2">AI ë¶„ì„ ê²°ê³¼:</div>
                          <button
                            onClick={() => {
                              // í•´ë‹¹ ë¹„ë””ì˜¤ì˜ ìµœì‹  ë¶„ì„ ì°¾ê¸°
                              const latestAnalysis = analyses.find(a => a.video_id === video.id);
                              if (latestAnalysis) {
                                handleAnalysisClick(latestAnalysis);
                              }
                            }}
                            className="text-purple-600 hover:text-purple-700 text-sm underline"
                          >
                            ğŸ“Š ë¶„ì„ ê²°ê³¼ ë³´ê¸°
                          </button>
                        </div>
                      )}
                    </div>
                  ))}
                </div>
              )}
            </div>
          </div>
        )}
      </Modal>

      {/* ë¹„ë””ì˜¤ ì¬ìƒ ë° ë¶„ì„ ëª¨ë‹¬ */}
      <Modal
        isOpen={showVideoModal}
        onClose={() => {
          setShowVideoModal(false);
          setSelectedVideo(null);
        }}
        title={selectedVideo ? `${selectedVideo.original_filename}` : 'ë¹„ë””ì˜¤ ì¬ìƒ'}
        size="xl"
      >
        {selectedVideo && (
          <div className="space-y-6">
            {/* ë¶„ì„ì´ ìˆìœ¼ë©´ ë¹„êµ í”Œë ˆì´ì–´, ì—†ìœ¼ë©´ ì¼ë°˜ í”Œë ˆì´ì–´ */}
            {selectedVideo.has_analysis ? (
              <div>
                <h3 className="text-lg font-semibold text-gray-900 mb-4">ğŸ¬ ì›ë³¸ vs AI ë¶„ì„ ê²°ê³¼</h3>
                {analyses.length > 0 ? (
                  <VideoComparisonPlayer analysis={analyses[0]} />
                ) : (
                  <div className="text-center py-8">
                    <LoadingSpinner text="ë¶„ì„ ë°ì´í„° ë¡œë”© ì¤‘..." />
                  </div>
                )}
              </div>
            ) : (
              <div className="space-y-4">
                <div className="bg-black rounded-lg overflow-hidden">
                  <video
                    controls
                    className="w-full h-64"
                  >
                    <source src={`/api/videos/${selectedVideo.id}/stream`} type="video/mp4" />
                    ë¸Œë¼ìš°ì €ì—ì„œ ë¹„ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                  </video>
                </div>
                
                <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                  <h4 className="font-medium text-yellow-900 mb-2">ğŸ¤– AI ë¶„ì„ ëŒ€ê¸° ì¤‘</h4>
                  <p className="text-yellow-700 text-sm mb-3">
                    ì´ ì˜ìƒì€ ì•„ì§ AI ë¶„ì„ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë¶„ì„ì„ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
                  </p>
                  <button
                    onClick={() => handleStartAnalysis(selectedVideo.id)}
                    className="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg transition-colors text-sm"
                  >
                    ğŸš€ AI ë¶„ì„ ì‹œì‘
                  </button>
                </div>
              </div>
            )}
          </div>
        )}
      </Modal>

      {/* AI ë¶„ì„ ê²°ê³¼ ëª¨ë‹¬ */}
      <Modal
        isOpen={showAnalysisModal}
        onClose={() => {
          setShowAnalysisModal(false);
          setSelectedAnalysis(null);
        }}
        title="ğŸ¤– AI ë¶„ì„ ê²°ê³¼"
        size="xl"
      >
        {selectedAnalysis && (
          <AIAnalysisResult
            analysis={selectedAnalysis}
            onStartAnalysis={() => selectedVideo && handleStartAnalysis(selectedVideo.id)}
            canStartAnalysis={selectedAnalysis.status === 'failed'}
          />
        )}
      </Modal>
    </div>
  );
};

export default MarkersPage;
```

---

### 57. SettingsPage.tsx

- **ê²½ë¡œ:** `frontend/src/pages/SettingsPage.tsx`
- **í¬ê¸°:** 719 characters
- **íƒ€ì…:** .tsx

```tsx
// frontend/src/pages/SettingsPage.tsx
import React from 'react';

const SettingsPage: React.FC = () => {
  return (
    <div className="space-y-6">
      <div className="bg-white rounded-lg shadow-sm p-6">
        <h1 className="text-2xl font-bold text-gray-900 mb-2">ì‹œìŠ¤í…œ ì„¤ì •</h1>
        <p className="text-gray-600">ì‹œìŠ¤í…œ ì„¤ì • ë° ì‚¬ìš©ì ê¶Œí•œì„ ê´€ë¦¬í•©ë‹ˆë‹¤</p>
      </div>
      
      <div className="bg-white rounded-lg shadow-sm p-6">
        <div className="text-center text-gray-500">
          <div className="text-4xl mb-4">âš™ï¸</div>
          <p className="text-lg font-medium">ì„¤ì • í˜ì´ì§€</p>
          <p className="text-sm">ì‹œìŠ¤í…œ ì„¤ì •ê³¼ ê´€ë¦¬ ê¸°ëŠ¥ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</p>
        </div>
      </div>
    </div>
  );
};

export default SettingsPage;
```

---

### 58. DashboardPage.tsx

- **ê²½ë¡œ:** `frontend/src/pages/DashboardPage.tsx`
- **í¬ê¸°:** 15,055 characters
- **íƒ€ì…:** .tsx

```tsx
// frontend/src/pages/DashboardPage.tsx (ë™ì˜ìƒ ì—…ë¡œë“œ ì§€ì›)
import React, { useEffect, useState } from 'react';
import { dashboardService } from '../services/dashboardService';
import { markerService } from '../services/markerService';
import { videoService } from '../services/videoService';
import { DashboardStats, Activity, RegionStat } from '../types/dashboard';
import { Marker, MarkerCreate } from '../types/marker';
import LoadingSpinner from '../components/common/LoadingSpinner';
import StatCard from '../components/dashboard/StatCard';
import ActivityList from '../components/dashboard/ActivityList';
import NaverMap from '../components/map/NaverMap';
import MarkerAddPopup from '../components/map/MarkerAddPopup';
import { formatNumber } from '../utils/helpers';
import toast from 'react-hot-toast';

const DashboardPage: React.FC = () => {
  const [stats, setStats] = useState<DashboardStats | null>(null);
  const [activities, setActivities] = useState<Activity[]>([]);
  const [regions, setRegions] = useState<RegionStat[]>([]);
  const [markers, setMarkers] = useState<Marker[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [selectedMarker, setSelectedMarker] = useState<Marker | null>(null);
  
  // ë§ˆì»¤ ì¶”ê°€ íŒì—… ìƒíƒœ
  const [showMarkerAddPopup, setShowMarkerAddPopup] = useState(false);
  const [newMarkerPosition, setNewMarkerPosition] = useState<{lat: number, lng: number} | null>(null);
  const [creatingMarker, setCreatingMarker] = useState(false);

  // ë°ì´í„° ìƒˆë¡œê³ ì¹¨ í•¨ìˆ˜
  const refreshData = async () => {
    try {
      const [statsData, activitiesData, regionsData, markersData] = await Promise.all([
        dashboardService.getStats(),
        dashboardService.getRecentActivities(10),
        dashboardService.getRegionStats(),
        markerService.getMarkers({ limit: 50 })
      ]);
      
      setStats(statsData);
      setActivities(activitiesData);
      setRegions(regionsData);
      setMarkers(markersData);
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      setError(errorMessage);
      toast.error(errorMessage);
    }
  };

  useEffect(() => {
    const fetchDashboardData = async () => {
      try {
        setLoading(true);
        setError(null);
        await refreshData();
      } catch (err) {
        // ì˜¤ë¥˜ëŠ” refreshDataì—ì„œ ì²˜ë¦¬ë¨
      } finally {
        setLoading(false);
      }
    };

    fetchDashboardData();
  }, []);

  // ë§ˆì»¤ í´ë¦­ í•¸ë“¤ëŸ¬
  const handleMarkerClick = (marker: Marker) => {
    setSelectedMarker(marker);
    toast.success(`ë§ˆì»¤ ì„ íƒ: ${marker.title}`);
  };

  // ì§€ë„ í´ë¦­ í•¸ë“¤ëŸ¬ (ì¼ë°˜ í´ë¦­)
  const handleMapClick = (lat: number, lng: number) => {
    console.log('ì§€ë„ í´ë¦­:', lat, lng);
    if (selectedMarker) {
      setSelectedMarker(null);
    }
  };

  // ì§€ë„ ìš°í´ë¦­ í•¸ë“¤ëŸ¬ (ë§ˆì»¤ ì¶”ê°€)
  const handleMapRightClick = (lat: number, lng: number) => {
    console.log('ì§€ë„ ìš°í´ë¦­ - ë§ˆì»¤ ì¶”ê°€:', lat, lng);
    setNewMarkerPosition({ lat, lng });
    setShowMarkerAddPopup(true);
    toast('ìš°í´ë¦­í•œ ìœ„ì¹˜ì— ìƒˆ ë§ˆì»¤ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.', {
      icon: 'ğŸ“',
      duration: 2000
    });
  };

  // ë§ˆì»¤ ìƒì„± í•¸ë“¤ëŸ¬ (ë™ì˜ìƒ ì—…ë¡œë“œ í¬í•¨)
  const handleCreateMarker = async (markerData: MarkerCreate, videoFile?: File) => {
    try {
      setCreatingMarker(true);
      
      console.log('ìƒˆ ë§ˆì»¤ ìƒì„±:', markerData);
      console.log('ì²¨ë¶€ëœ ë¹„ë””ì˜¤:', videoFile?.name);
      
      // 1. ë§ˆì»¤ ìƒì„±
      const newMarker = await markerService.createMarker(markerData);
      console.log('ë§ˆì»¤ ìƒì„± ì™„ë£Œ:', newMarker);
      
      // 2. ë™ì˜ìƒì´ ìˆìœ¼ë©´ ì—…ë¡œë“œ
      if (videoFile) {
        try {
          toast.loading('ë™ì˜ìƒ ì—…ë¡œë“œ ì¤‘...', { duration: 1000 });
          
          const videoUpload = await videoService.uploadVideo(newMarker.id, {
            file: videoFile,
            description: `${markerData.title} ê´€ë ¨ ì˜ìƒ`,
            uploaded_by: markerData.created_by
          });
          
          console.log('ë¹„ë””ì˜¤ ì—…ë¡œë“œ ì™„ë£Œ:', videoUpload);
          toast.success(`ë™ì˜ìƒ ì—…ë¡œë“œ ì™„ë£Œ: ${videoUpload.original_filename}`);
          
          // ë§ˆì»¤ ì •ë³´ ì—…ë°ì´íŠ¸ (ë¹„ë””ì˜¤ ìˆ˜ ë°˜ì˜)
          newMarker.video_count = 1;
          
        } catch (videoError) {
          console.error('ë¹„ë””ì˜¤ ì—…ë¡œë“œ ì˜¤ë¥˜:', videoError);
          toast.error('ë§ˆì»¤ëŠ” ìƒì„±ë˜ì—ˆì§€ë§Œ ë™ì˜ìƒ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        }
      }
      
      // 3. ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸
      setMarkers(prev => [newMarker, ...prev]);
      
      // 4. í†µê³„ ë°ì´í„° ìƒˆë¡œê³ ì¹¨
      await refreshData();
      
      const successMessage = videoFile 
        ? `ìƒˆ ë§ˆì»¤ì™€ ë™ì˜ìƒì´ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤: ${newMarker.title}`
        : `ìƒˆ ë§ˆì»¤ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤: ${newMarker.title}`;
      
      toast.success(successMessage);
      
      // 5. ìƒì„±ëœ ë§ˆì»¤ ì„ íƒ
      setSelectedMarker(newMarker);
      
    } catch (error) {
      console.error('ë§ˆì»¤ ìƒì„± ì˜¤ë¥˜:', error);
      const errorMessage = error instanceof Error ? error.message : 'ë§ˆì»¤ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      toast.error(errorMessage);
      throw error;
    } finally {
      setCreatingMarker(false);
    }
  };

  // ë§ˆì»¤ ì¶”ê°€ íŒì—… ë‹«ê¸°
  const handleCloseMarkerAddPopup = () => {
    setShowMarkerAddPopup(false);
    setNewMarkerPosition(null);
  };

  if (loading) {
    return (
      <div className="flex items-center justify-center min-h-[60vh]">
        <LoadingSpinner size="lg" text="ëŒ€ì‹œë³´ë“œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..." />
      </div>
    );
  }

  if (error) {
    return (
      <div className="bg-red-50 border border-red-200 rounded-lg p-6">
        <div className="flex items-center space-x-2">
          <svg className="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span className="text-red-700 font-medium">ì˜¤ë¥˜ ë°œìƒ</span>
        </div>
        <p className="text-red-600 mt-2">{error}</p>
        <button 
          onClick={() => window.location.reload()} 
          className="mt-4 bg-red-100 hover:bg-red-200 text-red-800 px-4 py-2 rounded-lg transition-colors"
        >
          ë‹¤ì‹œ ì‹œë„
        </button>
      </div>
    );
  }

  return (
    <div className="space-y-6">
      {/* Page Header */}
      <div className="bg-white rounded-lg shadow-sm p-6">
        <div className="flex justify-between items-center">
          <div>
            <h1 className="text-2xl font-bold text-gray-900 mb-2">ëŒ€ì‹œë³´ë“œ</h1>
            <p className="text-gray-600">ì „êµ­ ë„ë¡œ ìœ ì§€ë³´ìˆ˜ í˜„í™©ì„ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”</p>
          </div>
          <div className="text-right">
            <div className="text-sm text-gray-500 mb-2">
              <p>ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: {new Date().toLocaleString('ko-KR')}</p>
              <p>ì´ {markers.length}ê°œ ë§ˆì»¤ í‘œì‹œ ì¤‘</p>
            </div>
            <button
              onClick={() => refreshData()}
              className="bg-primary-500 hover:bg-primary-600 text-white px-4 py-2 rounded-lg transition-colors text-sm flex items-center space-x-2"
            >
              <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
              </svg>
              <span>ìƒˆë¡œê³ ì¹¨</span>
            </button>
          </div>
        </div>
      </div>

      {/* Stats Cards */}
      {stats && (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6">
          <StatCard
            title="ì „ì²´ ë§ˆì»¤"
            value={formatNumber(stats.total_markers)}
            icon="ğŸ“"
            color="blue"
          />
          <StatCard
            title="ê¸´ê¸‰ ì´ìŠˆ"
            value={formatNumber(stats.urgent_issues)}
            icon="ğŸš¨"
            color="red"
          />
          <StatCard
            title="ì£¼ê°„ ì™„ë£Œ"
            value={formatNumber(stats.weekly_completed)}
            icon="âœ…"
            color="green"
          />
          <StatCard
            title="ëŒ€ê¸° ì¤‘"
            value={formatNumber(stats.pending_markers)}
            icon="â³"
            color="yellow"
          />
          <StatCard
            title="í™œì„± ë§ˆì»¤"
            value={formatNumber(stats.active_markers)}
            icon="ğŸ‘¤"
            color="purple"
          />
        </div>
      )}

      {/* Main Content Grid */}
      <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
        {/* Map Section */}
        <div className="lg:col-span-2">
          <div className="bg-white rounded-lg shadow-sm overflow-hidden">
            <div className="bg-gray-50 px-6 py-4 border-b">
              <div className="flex justify-between items-center">
                <h2 className="text-lg font-semibold text-gray-900 flex items-center">
                  ğŸ—ºï¸ ì „êµ­ í˜„í™©
                </h2>
                <div className="flex items-center space-x-4 text-sm text-gray-600">
                  <div className="flex items-center space-x-1">
                    <span>ğŸ“ {markers.length}ê°œ ë§ˆì»¤</span>
                  </div>
                  {selectedMarker && (
                    <span className="bg-primary-100 text-primary-800 px-2 py-1 rounded text-xs">
                      ì„ íƒ: {selectedMarker.title}
                    </span>
                  )}
                  <div className="text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded">
                    ğŸ’¡ ìš°í´ë¦­ìœ¼ë¡œ ë§ˆì»¤ ì¶”ê°€ (ë™ì˜ìƒ í¬í•¨ ê°€ëŠ¥)
                  </div>
                </div>
              </div>
            </div>
            
            <div className="p-6">
              {/* ë„¤ì´ë²„ ì§€ë„ */}
              <NaverMap
                markers={markers}
                onMarkerClick={handleMarkerClick}
                onMapClick={handleMapClick}
                onMapRightClick={handleMapRightClick}
                height="500px"
                showControls={true}
                center={{ lat: 37.3595704, lng: 127.105399 }}
                zoom={11}
              />
              
              {/* ì„ íƒëœ ë§ˆì»¤ ì •ë³´ */}
              {selectedMarker && (
                <div className="mt-4 bg-blue-50 border border-blue-200 rounded-lg p-4">
                  <div className="flex justify-between items-start">
                    <div className="flex-1">
                      <h3 className="font-semibold text-blue-900">{selectedMarker.title}</h3>
                      <p className="text-blue-700 text-sm mt-1">{selectedMarker.description}</p>
                      <div className="flex items-center space-x-4 mt-2 text-xs text-blue-600">
                        <span>ğŸ“ {selectedMarker.road_name || selectedMarker.address}</span>
                        <span>ìƒíƒœ: {selectedMarker.status}</span>
                        <span>ìš°ì„ ìˆœìœ„: {selectedMarker.priority}</span>
                        <span>ë‹´ë‹¹ì: {selectedMarker.assigned_to || 'ë¯¸ë°°ì •'}</span>
                      </div>
                      <div className="flex items-center space-x-4 mt-1 text-xs text-blue-500">
                        <span>ìƒì„±ì¼: {new Date(selectedMarker.created_at).toLocaleDateString('ko-KR')}</span>
                        <span>ğŸ¥ ë¹„ë””ì˜¤: {selectedMarker.video_count}ê°œ</span>
                        <span>ğŸ¤– ë¶„ì„: {selectedMarker.analysis_count}ê°œ</span>
                      </div>
                    </div>
                    <button 
                      onClick={() => setSelectedMarker(null)}
                      className="text-blue-400 hover:text-blue-600 p-1"
                      title="ì„ íƒ í•´ì œ"
                    >
                      âœ•
                    </button>
                  </div>
                </div>
              )}
              
              {/* Region Stats */}
              {regions.length > 0 && (
                <div className="mt-6">
                  <h3 className="text-sm font-medium text-gray-900 mb-3">ì§€ì—­ë³„ í†µê³„</h3>
                  <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                    {regions.map((region) => (
                      <div key={region.name} className="bg-gray-50 rounded-lg p-3 text-center hover:bg-gray-100 transition-colors cursor-pointer">
                        <div className="text-sm text-gray-600">{region.name}</div>
                        <div className="text-lg font-semibold text-gray-900">{formatNumber(region.count)}</div>
                      </div>
                    ))}
                  </div>
                </div>
              )}
            </div>
          </div>
        </div>

        {/* Recent Activities */}
        <div className="lg:col-span-1">
          <div className="bg-white rounded-lg shadow-sm overflow-hidden">
            <div className="bg-gray-50 px-6 py-4 border-b">
              <h2 className="text-lg font-semibold text-gray-900 flex items-center">
                ğŸ”„ ì‹¤ì‹œê°„ í™œë™
              </h2>
            </div>
            <ActivityList activities={activities} />
          </div>
        </div>
      </div>

      {/* Quick Actions */}
      <div className="bg-white rounded-lg shadow-sm p-6">
        <h2 className="text-lg font-semibold text-gray-900 mb-4">ë¹ ë¥¸ ì‘ì—…</h2>
        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
          <button 
            onClick={() => {
              const centerPosition = { lat: 37.3595704, lng: 127.105399 };
              handleMapRightClick(centerPosition.lat, centerPosition.lng);
            }}
            className="flex items-center justify-center p-4 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors"
          >
            <div className="text-center">
              <div className="text-2xl mb-2">ğŸ“ğŸ¥</div>
              <div className="text-sm font-medium text-blue-900">ë§ˆì»¤ + ë™ì˜ìƒ ë“±ë¡</div>
            </div>
          </button>
          <button 
            onClick={() => window.location.href = '/markers'}
            className="flex items-center justify-center p-4 bg-green-50 hover:bg-green-100 rounded-lg transition-colors"
          >
            <div className="text-center">
              <div className="text-2xl mb-2">ğŸ“Š</div>
              <div className="text-sm font-medium text-green-900">ë§ˆì»¤ ê´€ë¦¬</div>
            </div>
          </button>
          <button className="flex items-center justify-center p-4 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors">
            <div className="text-center">
              <div className="text-2xl mb-2">ğŸ¥</div>
              <div className="text-sm font-medium text-purple-900">ì˜ìƒ ë¶„ì„</div>
            </div>
          </button>
          <button className="flex items-center justify-center p-4 bg-orange-50 hover:bg-orange-100 rounded-lg transition-colors">
            <div className="text-center">
              <div className="text-2xl mb-2">âš™ï¸</div>
              <div className="text-sm font-medium text-orange-900">ì‹œìŠ¤í…œ ì„¤ì •</div>
            </div>
          </button>
        </div>
      </div>

      {/* ë§ˆì»¤ ì¶”ê°€ íŒì—… (ë™ì˜ìƒ ì—…ë¡œë“œ í¬í•¨) */}
      <MarkerAddPopup
        isOpen={showMarkerAddPopup}
        position={newMarkerPosition}
        onSubmit={handleCreateMarker}
        onClose={handleCloseMarkerAddPopup}
        loading={creatingMarker}
      />
    </div>
  );
};

export default DashboardPage;
```

---

### 59. __init__.py

- **ê²½ë¡œ:** `backend/app/__init__.py`
- **í¬ê¸°:** 0 characters
- **íƒ€ì…:** .py

```python

```

---

### 60. config.py

- **ê²½ë¡œ:** `backend/app/core/config.py`
- **í¬ê¸°:** 1,274 characters
- **íƒ€ì…:** .py

```python
# backend/app/core/config.py
import os
from typing import List
from pydantic_settings import BaseSettings

class Settings(BaseSettings):
    # Database
    DATABASE_URL: str = os.getenv("DATABASE_URL", "postgresql://admin:password@localhost:5432/road_maintenance")
    
    # Security
    SECRET_KEY: str = os.getenv("SECRET_KEY", "your-secret-key-here-change-this-in-production")
    ALGORITHM: str = "HS256"
    ACCESS_TOKEN_EXPIRE_MINUTES: int = 30
    
    # CORS
    CORS_ORIGINS: List[str] = ["http://localhost:3000", "http://127.0.0.1:3000"]
    
    # File Upload
    UPLOAD_FOLDER: str = os.getenv("UPLOAD_FOLDER", "./uploads")
    MAX_UPLOAD_SIZE: int = int(os.getenv("MAX_UPLOAD_SIZE", 104857600))  # 100MB
    ALLOWED_VIDEO_EXTENSIONS: List[str] = [".mp4", ".avi", ".mov", ".mkv"]
    
    # AI Model
    AI_MODEL_PATH: str = os.getenv("AI_MODEL_PATH", "./ai_model/best.pt")
    
    # Naver Maps
    NAVER_MAP_CLIENT_ID: str = os.getenv("NAVER_MAP_CLIENT_ID", "")
    NAVER_MAP_CLIENT_SECRET: str = os.getenv("NAVER_MAP_CLIENT_SECRET", "")
    
    # Application
    PROJECT_NAME: str = "ë„ë¡œ ìœ ì§€ë³´ìˆ˜ ê´€ë¦¬ ì‹œìŠ¤í…œ"
    VERSION: str = "1.0.0"
    DESCRIPTION: str = "YOLO ê¸°ë°˜ AI ê· ì—´ ê²€ì¶œì„ í™œìš©í•œ ë„ë¡œ ìœ ì§€ë³´ìˆ˜ ê´€ë¦¬ ì‹œìŠ¤í…œ"

    class Config:
        env_file = ".env"


settings = Settings()
```

---

### 61. __init__.py

- **ê²½ë¡œ:** `backend/app/core/__init__.py`
- **í¬ê¸°:** 0 characters
- **íƒ€ì…:** .py

```python

```

---

### 62. database.py

- **ê²½ë¡œ:** `backend/app/core/database.py`
- **í¬ê¸°:** 699 characters
- **íƒ€ì…:** .py

```python
# backend/app/core/database.py
from sqlalchemy import create_engine
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker
from .config import settings

# SQLAlchemy ì—”ì§„ ìƒì„±
engine = create_engine(
    settings.DATABASE_URL,
    pool_pre_ping=True,
    pool_recycle=300,
    echo=False  # ê°œë°œ ì‹œ Trueë¡œ ë³€ê²½í•˜ë©´ SQL ì¿¼ë¦¬ ë¡œê·¸ í™•ì¸ ê°€ëŠ¥
)

# ì„¸ì…˜ íŒ©í† ë¦¬ ìƒì„±
SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)

# Base í´ë˜ìŠ¤ ìƒì„±
Base = declarative_base()


# ì˜ì¡´ì„± ì£¼ì…ì„ ìœ„í•œ ë°ì´í„°ë² ì´ìŠ¤ ì„¸ì…˜ í•¨ìˆ˜
def get_db():
    db = SessionLocal()
    try:
        yield db
    finally:
        db.close()


# ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ìƒì„± í•¨ìˆ˜
def create_tables():
    Base.metadata.create_all(bind=engine)
```

---

### 63. __init__.py

- **ê²½ë¡œ:** `backend/app/utils/__init__.py`
- **í¬ê¸°:** 0 characters
- **íƒ€ì…:** .py

```python

```

---

### 64. video_utils.py

- **ê²½ë¡œ:** `backend/app/utils/video_utils.py`
- **í¬ê¸°:** 9,642 characters
- **íƒ€ì…:** .py

```python
# backend/app/utils/video_utils.py
import cv2
import subprocess
import os
import tempfile
from pathlib import Path
from typing import Dict, Optional, Tuple
import logging

logger = logging.getLogger(__name__)

class VideoProcessor:
    """ì›¹ í˜¸í™˜ ë¹„ë””ì˜¤ ì²˜ë¦¬ í´ë˜ìŠ¤"""
    
    def __init__(self):
        self.web_compatible_codec = 'libx264'
        self.web_compatible_format = 'mp4'
        self.target_fps = 30
        self.max_resolution = (1920, 1080)
    
    def convert_to_web_compatible(self, input_path: str, output_path: str) -> Dict[str, any]:
        """
        ë¹„ë””ì˜¤ë¥¼ ì›¹ í˜¸í™˜ í˜•ì‹ìœ¼ë¡œ ë³€í™˜
        
        Args:
            input_path: ì›ë³¸ ë¹„ë””ì˜¤ ê²½ë¡œ
            output_path: ë³€í™˜ëœ ë¹„ë””ì˜¤ ì €ì¥ ê²½ë¡œ
            
        Returns:
            ë³€í™˜ ê²°ê³¼ ë”•ì…”ë„ˆë¦¬
        """
        try:
            logger.info(f"ğŸ¬ ë¹„ë””ì˜¤ ì›¹ í˜¸í™˜ì„± ë³€í™˜ ì‹œì‘: {input_path}")
            
            # FFmpegë¥¼ ì‚¬ìš©í•œ ì›¹ í˜¸í™˜ ë³€í™˜
            cmd = [
                'ffmpeg',
                '-i', input_path,
                '-c:v', 'libx264',          # H.264 ë¹„ë””ì˜¤ ì½”ë±
                '-c:a', 'aac',              # AAC ì˜¤ë””ì˜¤ ì½”ë±
                '-preset', 'fast',          # ë¹ ë¥¸ ì¸ì½”ë”©
                '-crf', '23',               # í’ˆì§ˆ ì„¤ì • (18-28, ë‚®ì„ìˆ˜ë¡ ê³ í’ˆì§ˆ)
                '-movflags', '+faststart',  # ì›¹ ìŠ¤íŠ¸ë¦¬ë° ìµœì í™”
                '-pix_fmt', 'yuv420p',      # í”½ì…€ í˜•ì‹ (ì›¹ í˜¸í™˜)
                '-r', str(self.target_fps), # í”„ë ˆì„ìœ¨ ì„¤ì •
                '-y',                       # ë®ì–´ì“°ê¸° í—ˆìš©
                output_path
            ]
            
            # í•´ìƒë„ ì¡°ì • (ë„ˆë¬´ í° ê²½ìš°)
            width, height = self._get_video_resolution(input_path)
            if width > self.max_resolution[0] or height > self.max_resolution[1]:
                scale = min(self.max_resolution[0]/width, self.max_resolution[1]/height)
                new_width = int(width * scale)
                new_height = int(height * scale)
                # 2ì˜ ë°°ìˆ˜ë¡œ ë§ì¶¤ (ì¸ì½”ë”© í˜¸í™˜ì„±)
                new_width = new_width if new_width % 2 == 0 else new_width - 1
                new_height = new_height if new_height % 2 == 0 else new_height - 1
                
                cmd.insert(-2, '-vf')  # output_path ì•ì— ì¶”ê°€
                cmd.insert(-2, f'scale={new_width}:{new_height}')
            
            logger.info(f"ğŸ”§ FFmpeg ëª…ë ¹ì–´: {' '.join(cmd)}")
            
            # FFmpeg ì‹¤í–‰
            result = subprocess.run(
                cmd,
                capture_output=True,
                text=True,
                timeout=300  # 5ë¶„ íƒ€ì„ì•„ì›ƒ
            )
            
            if result.returncode == 0:
                # ë³€í™˜ ì„±ê³µ
                file_size = os.path.getsize(output_path)
                duration = self._get_video_duration(output_path)
                
                logger.info(f"âœ… ì›¹ í˜¸í™˜ ë³€í™˜ ì™„ë£Œ: {output_path}")
                
                return {
                    "success": True,
                    "output_path": output_path,
                    "file_size": file_size,
                    "duration": duration,
                    "codec": "H.264/AAC",
                    "web_compatible": True
                }
            else:
                logger.error(f"âŒ FFmpeg ë³€í™˜ ì‹¤íŒ¨: {result.stderr}")
                return {
                    "success": False,
                    "error": f"FFmpeg ì˜¤ë¥˜: {result.stderr}"
                }
                
        except subprocess.TimeoutExpired:
            logger.error("â° ë¹„ë””ì˜¤ ë³€í™˜ íƒ€ì„ì•„ì›ƒ")
            return {"success": False, "error": "ë³€í™˜ ì‹œê°„ ì´ˆê³¼"}
        except Exception as e:
            logger.error(f"ğŸ’¥ ë¹„ë””ì˜¤ ë³€í™˜ ì¤‘ ì˜¤ë¥˜: {e}")
            return {"success": False, "error": str(e)}
    
    def process_analysis_video(
        self, 
        original_path: str, 
        analysis_frames: list, 
        output_path: str
    ) -> Dict[str, any]:
        """
        ë¶„ì„ ê²°ê³¼ê°€ í¬í•¨ëœ ì›¹ í˜¸í™˜ ë¹„ë””ì˜¤ ìƒì„±
        
        Args:
            original_path: ì›ë³¸ ë¹„ë””ì˜¤ ê²½ë¡œ
            analysis_frames: ë¶„ì„ëœ í”„ë ˆì„ ë¦¬ìŠ¤íŠ¸
            output_path: ì¶œë ¥ ë¹„ë””ì˜¤ ê²½ë¡œ
        """
        try:
            logger.info(f"ğŸ¯ ë¶„ì„ ê²°ê³¼ ë¹„ë””ì˜¤ ìƒì„± ì‹œì‘")
            
            # ì›ë³¸ ë¹„ë””ì˜¤ ì •ë³´ ì¶”ì¶œ
            cap = cv2.VideoCapture(original_path)
            fps = int(cap.get(cv2.CAP_PROP_FPS))
            width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))
            height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))
            
            # í•´ìƒë„ ì¡°ì • (ì›¹ í˜¸í™˜ì„±)
            if width > self.max_resolution[0] or height > self.max_resolution[1]:
                scale = min(self.max_resolution[0]/width, self.max_resolution[1]/height)
                width = int(width * scale)
                height = int(height * scale)
                # 2ì˜ ë°°ìˆ˜ë¡œ ë§ì¶¤
                width = width if width % 2 == 0 else width - 1
                height = height if height % 2 == 0 else height - 1
            
            # ì›¹ í˜¸í™˜ ë¹„ë””ì˜¤ ë¼ì´í„° ì„¤ì •
            fourcc = cv2.VideoWriter_fourcc(*'mp4v')
            out = cv2.VideoWriter(output_path, fourcc, min(fps, self.target_fps), (width, height))
            
            # í”„ë ˆì„ ì²˜ë¦¬ ë° ì €ì¥
            frame_count = 0
            for frame in analysis_frames:
                if frame is not None:
                    # í•´ìƒë„ ì¡°ì •
                    if frame.shape[:2] != (height, width):
                        frame = cv2.resize(frame, (width, height))
                    
                    out.write(frame)
                    frame_count += 1
            
            cap.release()
            out.release()
            
            if frame_count > 0:
                # OpenCVë¡œ ìƒì„±ëœ íŒŒì¼ì„ ì›¹ í˜¸í™˜ í˜•ì‹ìœ¼ë¡œ ì¬ë³€í™˜
                temp_path = output_path + '_temp.mp4'
                os.rename(output_path, temp_path)
                
                conversion_result = self.convert_to_web_compatible(temp_path, output_path)
                
                # ì„ì‹œ íŒŒì¼ ì‚­ì œ
                if os.path.exists(temp_path):
                    os.remove(temp_path)
                
                if conversion_result["success"]:
                    logger.info(f"âœ… ë¶„ì„ ë¹„ë””ì˜¤ ìƒì„± ì™„ë£Œ: {frame_count} í”„ë ˆì„")
                    return {
                        "success": True,
                        "output_path": output_path,
                        "frame_count": frame_count,
                        "web_compatible": True
                    }
                else:
                    return conversion_result
            else:
                logger.error("âŒ ë¶„ì„ ë¹„ë””ì˜¤ì— í”„ë ˆì„ì´ ì—†ìŒ")
                return {"success": False, "error": "ë¶„ì„ í”„ë ˆì„ ì—†ìŒ"}
                
        except Exception as e:
            logger.error(f"ğŸ’¥ ë¶„ì„ ë¹„ë””ì˜¤ ìƒì„± ì¤‘ ì˜¤ë¥˜: {e}")
            return {"success": False, "error": str(e)}
    
    def _get_video_resolution(self, video_path: str) -> Tuple[int, int]:
        """ë¹„ë””ì˜¤ í•´ìƒë„ ì¶”ì¶œ"""
        try:
            cap = cv2.VideoCapture(video_path)
            width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))
            height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))
            cap.release()
            return width, height
        except:
            return 1280, 720  # ê¸°ë³¸ê°’
    
    def _get_video_duration(self, video_path: str) -> float:
        """ë¹„ë””ì˜¤ ê¸¸ì´ ì¶”ì¶œ"""
        try:
            cap = cv2.VideoCapture(video_path)
            frame_count = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))
            fps = cap.get(cv2.CAP_PROP_FPS)
            duration = frame_count / fps if fps > 0 else 0
            cap.release()
            return duration
        except:
            return 0.0
    
    def validate_web_compatibility(self, video_path: str) -> Dict[str, any]:
        """ë¹„ë””ì˜¤ ì›¹ í˜¸í™˜ì„± ê²€ì‚¬"""
        try:
            # FFprobeë¥¼ ì‚¬ìš©í•œ ìƒì„¸ ì •ë³´ ì¶”ì¶œ
            cmd = [
                'ffprobe',
                '-v', 'quiet',
                '-print_format', 'json',
                '-show_format',
                '-show_streams',
                video_path
            ]
            
            result = subprocess.run(cmd, capture_output=True, text=True)
            
            if result.returncode == 0:
                import json
                info = json.loads(result.stdout)
                
                video_stream = None
                audio_stream = None
                
                for stream in info.get('streams', []):
                    if stream.get('codec_type') == 'video':
                        video_stream = stream
                    elif stream.get('codec_type') == 'audio':
                        audio_stream = stream
                
                # ì›¹ í˜¸í™˜ì„± ì²´í¬
                is_compatible = True
                issues = []
                
                if video_stream:
                    video_codec = video_stream.get('codec_name', '')
                    if video_codec not in ['h264', 'x264']:
                        is_compatible = False
                        issues.append(f"ë¹„ë””ì˜¤ ì½”ë± ë¹„í˜¸í™˜: {video_codec}")
                
                if audio_stream:
                    audio_codec = audio_stream.get('codec_name', '')
                    if audio_codec not in ['aac', 'mp3']:
                        is_compatible = False
                        issues.append(f"ì˜¤ë””ì˜¤ ì½”ë± ë¹„í˜¸í™˜: {audio_codec}")
                
                return {
                    "compatible": is_compatible,
                    "issues": issues,
                    "video_codec": video_stream.get('codec_name') if video_stream else None,
                    "audio_codec": audio_stream.get('codec_name') if audio_stream else None,
                    "format": info.get('format', {}).get('format_name', '')
                }
            else:
                return {"compatible": False, "error": "íŒŒì¼ ë¶„ì„ ì‹¤íŒ¨"}
                
        except Exception as e:
            return {"compatible": False, "error": str(e)}

# ì „ì—­ ë¹„ë””ì˜¤ í”„ë¡œì„¸ì„œ ì¸ìŠ¤í„´ìŠ¤
video_processor = VideoProcessor()
```

---

### 65. file_utils.py

- **ê²½ë¡œ:** `backend/app/utils/file_utils.py`
- **í¬ê¸°:** 1,453 characters
- **íƒ€ì…:** .py

```python
import os
import cv2
from fastapi import UploadFile
from typing import Dict, Optional
from ..core.config import settings


def validate_video_file(file: UploadFile) -> bool:
    """ë¹„ë””ì˜¤ íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬"""
    
    if not file.filename:
        return False
    
    # íŒŒì¼ í™•ì¥ì ì²´í¬
    file_extension = os.path.splitext(file.filename)[1].lower()
    if file_extension not in settings.ALLOWED_VIDEO_EXTENSIONS:
        return False
    
    # MIME íƒ€ì… ì²´í¬ (ì„ íƒì )
    if file.content_type and not file.content_type.startswith('video/'):
        return False
    
    return True


def get_video_metadata(file_path: str) -> Dict[str, Optional[float]]:
    """ë¹„ë””ì˜¤ íŒŒì¼ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ"""
    
    metadata = {
        "duration": None,
        "width": None,
        "height": None,
        "fps": None
    }
    
    try:
        cap = cv2.VideoCapture(file_path)
        
        if cap.isOpened():
            # í”„ë ˆì„ ìˆ˜ì™€ FPSë¡œ ì§€ì†ì‹œê°„ ê³„ì‚°
            frame_count = cap.get(cv2.CAP_PROP_FRAME_COUNT)
            fps = cap.get(cv2.CAP_PROP_FPS)
            
            if fps > 0:
                metadata["duration"] = frame_count / fps
                metadata["fps"] = fps
            
            # í•´ìƒë„ ì •ë³´
            metadata["width"] = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))
            metadata["height"] = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))
        
        cap.release()
        
    except Exception as e:
        print(f"ë¹„ë””ì˜¤ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ ì˜¤ë¥˜: {e}")
    
    return metadata

```

---

### 66. model_loader.py

- **ê²½ë¡œ:** `backend/app/ai_model/model_loader.py`
- **í¬ê¸°:** 2,249 characters
- **íƒ€ì…:** .py

```python
# backend/ai_model/model_loader.py
import os
import torch
from ultralytics import YOLO
from typing import Optional
import logging

logger = logging.getLogger(__name__)

class ModelLoader:
    """YOLO ëª¨ë¸ ë¡œë” ë° ê´€ë¦¬ í´ë˜ìŠ¤"""
    
    def __init__(self, model_path: str = "best.pt"):
        self.model_path = model_path
        self.model: Optional[YOLO] = None
        self.device = 'cuda' if torch.cuda.is_available() else 'cpu'
        
    def load_model(self) -> bool:
        """YOLO ëª¨ë¸ ë¡œë“œ"""
        try:
            # ëª¨ë¸ íŒŒì¼ ì¡´ì¬ í™•ì¸
            if not os.path.exists(self.model_path):
                logger.error(f"ëª¨ë¸ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: {self.model_path}")
                return False
            
            # YOLO ëª¨ë¸ ë¡œë“œ
            self.model = YOLO(self.model_path)
            self.model.to(self.device)
            
            logger.info(f"YOLO ëª¨ë¸ ë¡œë“œ ì™„ë£Œ: {self.model_path} (Device: {self.device})")
            return True
            
        except Exception as e:
            logger.error(f"ëª¨ë¸ ë¡œë“œ ì‹¤íŒ¨: {str(e)}")
            return False
    
    def is_loaded(self) -> bool:
        """ëª¨ë¸ ë¡œë“œ ìƒíƒœ í™•ì¸"""
        return self.model is not None
    
    def get_model(self) -> Optional[YOLO]:
        """ë¡œë“œëœ ëª¨ë¸ ë°˜í™˜"""
        if not self.is_loaded():
            if not self.load_model():
                return None
        return self.model
    
    def get_model_info(self) -> dict:
        """ëª¨ë¸ ì •ë³´ ë°˜í™˜"""
        if not self.is_loaded():
            return {"loaded": False, "error": "ëª¨ë¸ì´ ë¡œë“œë˜ì§€ ì•ŠìŒ"}
        
        return {
            "loaded": True,
            "model_path": self.model_path,
            "device": self.device,
            "model_type": "YOLOv8" if hasattr(self.model, 'model') else "YOLO"
        }

# ì „ì—­ ëª¨ë¸ ì¸ìŠ¤í„´ìŠ¤
_model_loader = None

def get_model_loader() -> ModelLoader:
    """ì‹±ê¸€í†¤ ëª¨ë¸ ë¡œë” ë°˜í™˜"""
    global _model_loader
    if _model_loader is None:
        # ëª¨ë¸ íŒŒì¼ ê²½ë¡œ ì„¤ì •
        model_path = os.path.join(os.path.dirname(__file__), "best.pt")
        _model_loader = ModelLoader(model_path)
    return _model_loader

def preload_model():
    """ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ì‹œ ëª¨ë¸ ë¯¸ë¦¬ ë¡œë“œ"""
    loader = get_model_loader()
    if loader.load_model():
        logger.info("YOLO ëª¨ë¸ ì‚¬ì „ ë¡œë“œ ì™„ë£Œ")
    else:
        logger.warning("YOLO ëª¨ë¸ ì‚¬ì „ ë¡œë“œ ì‹¤íŒ¨")
```

---

### 67. __init__.py

- **ê²½ë¡œ:** `backend/app/ai_model/__init__.py`
- **í¬ê¸°:** 1,298 characters
- **íƒ€ì…:** .py

```python
# backend/app/ai_model/__init__.py
"""
ë„ë¡œ ê· ì—´ ê²€ì¶œ AI ëª¨ë“ˆ

YOLO ê¸°ë°˜ ê· ì—´ ê²€ì¶œ ë° ë¶„ì„ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.
"""

try:
    from .model_loader import ModelLoader, get_model_loader, preload_model
    from .inference import CrackDetector
    
    __all__ = [
        'ModelLoader',
        'get_model_loader', 
        'preload_model',
        'CrackDetector'
    ]
    
    # ëª¨ë“ˆ ë¡œë“œ ìƒíƒœ
    AI_MODULE_AVAILABLE = True
    
except ImportError as e:
    print(f"AI ëª¨ë“ˆ ì˜ì¡´ì„± ëˆ„ë½: {e}")
    print("ultralytics, torch, opencv-python íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ì„¸ìš”.")
    
    # ë”ë¯¸ í´ë˜ìŠ¤ ì •ì˜
    class ModelLoader:
        def __init__(self, *args, **kwargs):
            self.loaded = False
        
        def load_model(self):
            return False
        
        def get_model_info(self):
            return {"loaded": False, "error": "AI íŒ¨í‚¤ì§€ ë¯¸ì„¤ì¹˜"}
    
    class CrackDetector:
        def analyze_video(self, *args, **kwargs):
            raise Exception("AI ëª¨ë“ˆì´ ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. requirements.txtì˜ AI íŒ¨í‚¤ì§€ë“¤ì„ ì„¤ì¹˜í•˜ì„¸ìš”.")
    
    def get_model_loader():
        return ModelLoader()
    
    def preload_model():
        print("AI ëª¨ë“ˆì´ ì„¤ì¹˜ë˜ì§€ ì•Šì•„ ëª¨ë¸ì„ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    
    __all__ = [
        'ModelLoader',
        'get_model_loader', 
        'preload_model',
        'CrackDetector'
    ]
    
    AI_MODULE_AVAILABLE = False

# ë²„ì „ ì •ë³´
__version__ = "1.0.0"
```

---

### 68. inference.py

- **ê²½ë¡œ:** `backend/app/ai_model/inference.py`
- **í¬ê¸°:** 13,846 characters
- **íƒ€ì…:** .py

```python
# backend/ai_model/inference.py
import cv2
import numpy as np
import os
from typing import Dict, List, Tuple, Any, Optional, Callable
from .model_loader import get_model_loader
import logging
from pathlib import Path

logger = logging.getLogger(__name__)

class CrackDetector:
    """ê· ì—´ ê²€ì¶œ ë° ë¶„ì„ í´ë˜ìŠ¤"""
    
    def __init__(self):
        self.model_loader = get_model_loader()
        self.confidence_threshold = 0.5
        self.iou_threshold = 0.45
        
    def analyze_video(
        self, 
        video_path: str, 
        output_path: str, 
        progress_callback: Optional[Callable[[float], None]] = None
    ) -> Dict[str, Any]:
        """
        ë¹„ë””ì˜¤ ë¶„ì„ ë° ì›¹ í˜¸í™˜ ê²°ê³¼ ì˜ìƒ ìƒì„±
        
        Args:
            video_path: ì…ë ¥ ë¹„ë””ì˜¤ ê²½ë¡œ
            output_path: ì¶œë ¥ ë¹„ë””ì˜¤ ê²½ë¡œ
            progress_callback: ì§„í–‰ë¥  ì½œë°± í•¨ìˆ˜
            
        Returns:
            ë¶„ì„ ê²°ê³¼ ë”•ì…”ë„ˆë¦¬
        """
        try:
            # ëª¨ë¸ ë¡œë“œ í™•ì¸
            model = self.model_loader.get_model()
            if model is None:
                raise Exception("YOLO ëª¨ë¸ì„ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
            
            # ë¹„ë””ì˜¤ ìº¡ì²˜ ì´ˆê¸°í™”
            cap = cv2.VideoCapture(video_path)
            if not cap.isOpened():
                raise Exception(f"ë¹„ë””ì˜¤ íŒŒì¼ì„ ì—´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: {video_path}")
            
            # ë¹„ë””ì˜¤ ì •ë³´ ì¶”ì¶œ
            fps = int(cap.get(cv2.CAP_PROP_FPS))
            width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))
            height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))
            total_frames = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))
            
            # ì›¹ í˜¸í™˜ í•´ìƒë„ ì¡°ì •
            max_width, max_height = 1920, 1080
            if width > max_width or height > max_height:
                scale = min(max_width/width, max_height/height)
                width = int(width * scale)
                height = int(height * scale)
                # 2ì˜ ë°°ìˆ˜ë¡œ ë§ì¶¤
                width = width if width % 2 == 0 else width - 1
                height = height if height % 2 == 0 else height - 1
            
            # ì„ì‹œ ì¶œë ¥ íŒŒì¼ (OpenCV ìš©)
            temp_output = output_path.replace('.mp4', '_temp.mp4')
            
            # ë¹„ë””ì˜¤ ë¼ì´í„° ì´ˆê¸°í™” (ì„ì‹œ)
            fourcc = cv2.VideoWriter_fourcc(*'mp4v')
            out = cv2.VideoWriter(temp_output, fourcc, min(fps, 30), (width, height))
            
            # ë¶„ì„ ê²°ê³¼ ì €ì¥ìš©
            all_detections = []
            processed_frames = []
            crack_statistics = {
                'total_frames': total_frames,
                'frames_with_cracks': 0,
                'total_detections': 0,
                'confidence_scores': []
            }
            
            frame_count = 0
            
            logger.info(f"ğŸ¥ ë¹„ë””ì˜¤ ë¶„ì„ ì‹œì‘: {total_frames} í”„ë ˆì„ ({width}x{height})")
            
            while True:
                ret, frame = cap.read()
                if not ret:
                    break
                
                # í•´ìƒë„ ì¡°ì •
                if frame.shape[:2] != (height, width):
                    frame = cv2.resize(frame, (width, height))
                
                # YOLO ì¶”ë¡  ì‹¤í–‰
                results = model(frame, conf=self.confidence_threshold, iou=self.iou_threshold)
                
                # ê²€ì¶œ ê²°ê³¼ ì²˜ë¦¬
                frame_detections = []
                annotated_frame = frame.copy()
                
                for result in results:
                    boxes = result.boxes
                    if boxes is not None:
                        for box in boxes:
                            # ë°”ìš´ë”© ë°•ìŠ¤ ì¢Œí‘œ
                            x1, y1, x2, y2 = box.xyxy[0].cpu().numpy()
                            confidence = box.conf[0].cpu().numpy()
                            class_id = int(box.cls[0].cpu().numpy())
                            
                            # ê²€ì¶œ ì •ë³´ ì €ì¥
                            detection = {
                                'frame': frame_count,
                                'bbox': [int(x1), int(y1), int(x2), int(y2)],
                                'confidence': float(confidence),
                                'class_id': class_id,
                                'area': (x2 - x1) * (y2 - y1)
                            }
                            frame_detections.append(detection)
                            
                            # ì›¹ ì¹œí™”ì  ë°”ìš´ë”© ë°•ìŠ¤ ê·¸ë¦¬ê¸°
                            color = (0, 0, 255)  # ë¹¨ê°„ìƒ‰
                            thickness = max(2, int(min(width, height) / 400))  # í•´ìƒë„ì— ë¹„ë¡€í•œ ë‘ê»˜
                            
                            # ë°•ìŠ¤ ê·¸ë¦¬ê¸°
                            cv2.rectangle(annotated_frame, (int(x1), int(y1)), (int(x2), int(y2)), color, thickness)
                            
                            # ë°°ê²½ì´ ìˆëŠ” í…ìŠ¤íŠ¸ (ê°€ë…ì„± í–¥ìƒ)
                            label = f"Crack: {confidence:.2f}"
                            font_scale = max(0.5, min(width, height) / 1600)  # í•´ìƒë„ì— ë¹„ë¡€í•œ í°íŠ¸ í¬ê¸°
                            text_thickness = max(1, thickness // 2)
                            
                            # í…ìŠ¤íŠ¸ í¬ê¸° ê³„ì‚°
                            (text_width, text_height), baseline = cv2.getTextSize(
                                label, cv2.FONT_HERSHEY_SIMPLEX, font_scale, text_thickness
                            )
                            
                            # í…ìŠ¤íŠ¸ ë°°ê²½
                            cv2.rectangle(
                                annotated_frame, 
                                (int(x1), int(y1) - text_height - baseline - 5),
                                (int(x1) + text_width + 5, int(y1)),
                                color, -1
                            )
                            
                            # í…ìŠ¤íŠ¸
                            cv2.putText(
                                annotated_frame, label, 
                                (int(x1) + 2, int(y1) - baseline - 2), 
                                cv2.FONT_HERSHEY_SIMPLEX, font_scale, (255, 255, 255), text_thickness
                            )
                
                # í”„ë ˆì„ ì €ì¥
                out.write(annotated_frame)
                processed_frames.append(annotated_frame)
                
                # í†µê³„ ì—…ë°ì´íŠ¸
                if frame_detections:
                    crack_statistics['frames_with_cracks'] += 1
                    crack_statistics['total_detections'] += len(frame_detections)
                    crack_statistics['confidence_scores'].extend([d['confidence'] for d in frame_detections])
                    all_detections.extend(frame_detections)
                
                frame_count += 1
                
                # ì§„í–‰ë¥  ì½œë°± í˜¸ì¶œ
                if progress_callback and frame_count % 10 == 0:
                    progress = (frame_count / total_frames) * 80  # 80%ê¹Œì§€ (ë³€í™˜ìš© 20% ë‚¨ê¹€)
                    progress_callback(progress)
            
            # ë¦¬ì†ŒìŠ¤ í•´ì œ
            cap.release()
            out.release()
            
            # ì›¹ í˜¸í™˜ í˜•ì‹ìœ¼ë¡œ ë³€í™˜
            logger.info("ğŸ”„ ì›¹ í˜¸í™˜ í˜•ì‹ìœ¼ë¡œ ë³€í™˜ ì¤‘...")
            if progress_callback:
                progress_callback(85)
            
            # FFmpegë¥¼ ì‚¬ìš©í•œ ì›¹ í˜¸í™˜ ë³€í™˜
            import subprocess
            
            ffmpeg_cmd = [
                'ffmpeg',
                '-i', temp_output,
                '-c:v', 'libx264',
                '-preset', 'fast',
                '-crf', '23',
                '-movflags', '+faststart',
                '-pix_fmt', 'yuv420p',
                '-y',
                output_path
            ]
            
            result = subprocess.run(ffmpeg_cmd, capture_output=True, text=True)
            
            # ì„ì‹œ íŒŒì¼ ì‚­ì œ
            if os.path.exists(temp_output):
                os.remove(temp_output)
            
            if result.returncode != 0:
                logger.warning(f"FFmpeg ë³€í™˜ ì‹¤íŒ¨, ì›ë³¸ ì‚¬ìš©: {result.stderr}")
                # ì›ë³¸ì„ ìµœì¢… ê²°ê³¼ë¡œ ë³µì‚¬
                import shutil
                shutil.move(temp_output, output_path)
            
            if progress_callback:
                progress_callback(100)
            
            # ìµœì¢… ë¶„ì„ ê²°ê³¼ ìƒì„±
            analysis_result = self._generate_analysis_result(crack_statistics, all_detections)
            
            logger.info(f"âœ… ë¹„ë””ì˜¤ ë¶„ì„ ì™„ë£Œ: {frame_count} í”„ë ˆì„ ì²˜ë¦¬, {analysis_result['total_cracks']}ê°œ ê· ì—´ ê²€ì¶œ")
            
            return analysis_result
            
        except Exception as e:
            logger.error(f"ğŸ’¥ ë¹„ë””ì˜¤ ë¶„ì„ ì¤‘ ì˜¤ë¥˜: {str(e)}")
            raise
    
    def _generate_analysis_result(self, statistics: Dict, detections: List[Dict]) -> Dict[str, Any]:
        """ë¶„ì„ ê²°ê³¼ ìƒì„±"""
        
        total_frames = statistics['total_frames']
        frames_with_cracks = statistics['frames_with_cracks']
        total_detections = statistics['total_detections']
        confidence_scores = statistics['confidence_scores']
        
        # ê¸°ë³¸ í†µê³„
        crack_ratio = (frames_with_cracks / total_frames) * 100 if total_frames > 0 else 0
        avg_confidence = np.mean(confidence_scores) if confidence_scores else 0
        
        # ê· ì—´ ì„¸ë¶€ ì •ë³´ ìƒì„±
        crack_details = []
        if detections:
            # í”„ë ˆì„ë³„ë¡œ ê·¸ë£¹í™”í•˜ì—¬ ê· ì—´ ì •ë³´ ìƒì„±
            frame_groups = {}
            for detection in detections:
                frame = detection['frame']
                if frame not in frame_groups:
                    frame_groups[frame] = []
                frame_groups[frame].append(detection)
            
            # ì£¼ìš” ê· ì—´ë“¤ ì„ ë³„ (ì‹ ë¢°ë„ ë†’ì€ ìˆœ)
            sorted_detections = sorted(detections, key=lambda x: x['confidence'], reverse=True)
            
            for i, detection in enumerate(sorted_detections[:10]):  # ìƒìœ„ 10ê°œë§Œ
                area_pixels = detection['area']
                # í”½ì…€ì„ ì‹¤ì œ ë©´ì ìœ¼ë¡œ ë³€í™˜ (ê°€ì •: 1í”½ì…€ = 1mmÂ²)
                area_mm2 = area_pixels
                
                crack_detail = {
                    "crack_id": f"crack_{i+1:03d}",
                    "crack_type": "ë„ë¡œ ê· ì—´",  # YOLO í´ë˜ìŠ¤ì— ë”°ë¼ ë¶„ë¥˜ ê°€ëŠ¥
                    "length": float(np.sqrt(area_mm2)),  # ê·¼ì‚¬ê°’
                    "width": 2.0,  # ê¸°ë³¸ê°’
                    "area": float(area_mm2 / 1000000),  # mÂ² ë³€í™˜
                    "severity": self._determine_severity(detection['confidence'], area_mm2),
                    "confidence": float(detection['confidence']),
                    "frame": detection['frame'],
                    "bbox": detection['bbox']
                }
                crack_details.append(crack_detail)
        
        # ë³´ìˆ˜ì¬ ìš©ëŸ‰ ì‚°ì •
        total_crack_area = sum([detail['area'] for detail in crack_details])
        material_estimation = self._estimate_materials(total_crack_area)
        
        # ì‹¬ê°ë„ ë¶„ì„
        severity_analysis = self._analyze_severity(crack_ratio, avg_confidence, total_crack_area)
        
        return {
            "success": True,
            "total_cracks": total_detections,
            "total_area": total_crack_area,
            "confidence": avg_confidence,
            "crack_ratio": crack_ratio,
            "frames_analyzed": total_frames,
            "frames_with_cracks": frames_with_cracks,
            "crack_details": crack_details,
            "material_estimation": material_estimation,
            "severity_analysis": severity_analysis
        }
    
    def _determine_severity(self, confidence: float, area: float) -> str:
        """ê· ì—´ ì‹¬ê°ë„ íŒì •"""
        if confidence > 0.8 and area > 10000:  # ë†’ì€ ì‹ ë¢°ë„ + í° ë©´ì 
            return "ìœ„í—˜"
        elif confidence > 0.6 and area > 5000:
            return "ë³´í†µ"
        else:
            return "ê²½ë¯¸"
    
    def _estimate_materials(self, total_area: float) -> Dict[str, Any]:
        """ë³´ìˆ˜ì¬ ìš©ëŸ‰ ì‚°ì •"""
        if total_area == 0:
            return {
                "asphalt_concrete": 0,
                "sealer": 0,
                "primer": 0,
                "mesh": None,
                "total_cost": 0
            }
        
        # ë‹¨ìœ„ë‹¹ ì†Œìš”ëŸ‰ (ì˜ˆì‹œê°’)
        asphalt_per_m2 = 0.1  # í†¤/mÂ²
        sealer_per_m2 = 2.0   # ë¦¬í„°/mÂ²
        primer_per_m2 = 0.5   # ë¦¬í„°/mÂ²
        
        # ë‹¨ìœ„ë‹¹ ë¹„ìš© (ì›)
        asphalt_cost = 150000  # ì›/í†¤
        sealer_cost = 5000     # ì›/ë¦¬í„°
        primer_cost = 8000     # ì›/ë¦¬í„°
        
        asphalt_amount = total_area * asphalt_per_m2
        sealer_amount = total_area * sealer_per_m2
        primer_amount = total_area * primer_per_m2
        
        total_cost = (asphalt_amount * asphalt_cost + 
                     sealer_amount * sealer_cost + 
                     primer_amount * primer_cost)
        
        return {
            "asphalt_concrete": round(asphalt_amount, 2),
            "sealer": round(sealer_amount, 1),
            "primer": round(primer_amount, 1),
            "mesh": round(total_area, 2) if total_area > 1.0 else None,
            "total_cost": int(total_cost)
        }
    
    def _analyze_severity(self, crack_ratio: float, avg_confidence: float, total_area: float) -> Dict[str, Any]:
        """ì „ì²´ ì‹¬ê°ë„ ë¶„ì„"""
        
        # ìœ„í—˜ë„ ì ìˆ˜ ê³„ì‚° (0-100)
        ratio_score = min(crack_ratio * 2, 50)  # ìµœëŒ€ 50ì 
        confidence_score = avg_confidence * 30   # ìµœëŒ€ 30ì 
        area_score = min(total_area * 10, 20)    # ìµœëŒ€ 20ì 
        
        risk_score = ratio_score + confidence_score + area_score
        
        # ì „ì²´ ì‹¬ê°ë„ íŒì •
        if risk_score >= 70:
            overall_severity = "ìœ„í—˜"
            urgent_repairs = True
            repair_time = "ì¦‰ì‹œ (1ì¼ ì´ë‚´)"
        elif risk_score >= 40:
            overall_severity = "ë³´í†µ"
            urgent_repairs = False
            repair_time = "1ì£¼ì¼ ì´ë‚´"
        else:
            overall_severity = "ê²½ë¯¸"
            urgent_repairs = False
            repair_time = "1ê°œì›” ì´ë‚´"
        
        return {
            "overall_severity": overall_severity,
            "risk_score": round(risk_score, 1),
            "urgent_repairs_needed": urgent_repairs,
            "estimated_repair_time": repair_time,
            "crack_coverage": f"{crack_ratio:.1f}%"
        }
```

---

### 69. analysis.py

- **ê²½ë¡œ:** `backend/app/models/analysis.py`
- **í¬ê¸°:** 1,690 characters
- **íƒ€ì…:** .py

```python
from sqlalchemy import Column, Integer, String, Text, DateTime, ForeignKey, Float, JSON
from sqlalchemy.sql import func
from sqlalchemy.orm import relationship
import enum
from ..core.database import Base


class AnalysisStatus(str, enum.Enum):
    PENDING = "pending"      # ë¶„ì„ ëŒ€ê¸°
    PROCESSING = "processing" # ë¶„ì„ ì¤‘
    COMPLETED = "completed"   # ë¶„ì„ ì™„ë£Œ
    FAILED = "failed"        # ë¶„ì„ ì‹¤íŒ¨


class Analysis(Base):
    __tablename__ = "analyses"

    id = Column(Integer, primary_key=True, index=True)
    
    # ê´€ê³„ ì„¤ì •
    marker_id = Column(Integer, ForeignKey("markers.id"), nullable=False)
    video_id = Column(Integer, ForeignKey("videos.id"), nullable=False)
    
    # ë¶„ì„ ìƒíƒœ
    status = Column(String(20), default=AnalysisStatus.PENDING)
    progress = Column(Float, default=0.0)  # 0-100 ì§„í–‰ë¥ 
    
    # AI ë¶„ì„ ê²°ê³¼
    total_cracks_detected = Column(Integer, default=0)
    total_crack_area = Column(Float, default=0.0)  # mÂ² ë‹¨ìœ„
    confidence_score = Column(Float, default=0.0)  # 0-1 ì‹ ë¢°ë„
    
    # ìƒì„¸ ë¶„ì„ ë°ì´í„° (JSON)
    crack_details = Column(JSON)  # ê°œë³„ ê· ì—´ ì •ë³´ë“¤
    material_estimation = Column(JSON)  # ë³´ìˆ˜ì¬ ìš©ëŸ‰ ì‚°ì •
    severity_analysis = Column(JSON)  # ì‹¬ê°ë„ ë¶„ì„
    
    # ê²°ê³¼ íŒŒì¼
    result_video_path = Column(String(500))  # AI ë¶„ì„ ê²°ê³¼ ë¹„ë””ì˜¤
    result_data_path = Column(String(500))   # ë¶„ì„ ë°ì´í„° íŒŒì¼
    
    # ì˜¤ë¥˜ ì •ë³´
    error_message = Column(Text)
    
    # ì‹œê°„ ì •ë³´
    started_at = Column(DateTime(timezone=True))
    completed_at = Column(DateTime(timezone=True))
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    
    # ê´€ê³„ ì„¤ì •
    marker = relationship("Marker", back_populates="analyses")
    video = relationship("Video", back_populates="analyses")

```

---

### 70. video.py

- **ê²½ë¡œ:** `backend/app/models/video.py`
- **í¬ê¸°:** 1,098 characters
- **íƒ€ì…:** .py

```python
from sqlalchemy import Column, Integer, String, DateTime, ForeignKey, BigInteger, Float
from sqlalchemy.sql import func
from sqlalchemy.orm import relationship
from ..core.database import Base


class Video(Base):
    __tablename__ = "videos"

    id = Column(Integer, primary_key=True, index=True)
    filename = Column(String(255), nullable=False)
    original_filename = Column(String(255), nullable=False)
    file_path = Column(String(500), nullable=False)
    file_size = Column(BigInteger)  # ë°”ì´íŠ¸ ë‹¨ìœ„
    
    # ë¹„ë””ì˜¤ ë©”íƒ€ë°ì´í„°
    duration = Column(Float)  # ì´ˆ ë‹¨ìœ„
    width = Column(Integer)
    height = Column(Integer)
    fps = Column(Float)
    
    # ë§ˆì»¤ì™€ì˜ ê´€ê³„
    marker_id = Column(Integer, ForeignKey("markers.id"), nullable=False)
    
    # ì—…ë¡œë“œ ì •ë³´
    uploaded_by = Column(String(100))
    description = Column(String(500))
    
    # ì‹œê°„ ì •ë³´
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    
    # ê´€ê³„ ì„¤ì •
    marker = relationship("Marker", back_populates="videos")
    analyses = relationship("Analysis", back_populates="video", cascade="all, delete-orphan")

```

---

### 71. marker.py

- **ê²½ë¡œ:** `backend/app/models/marker.py`
- **í¬ê¸°:** 1,738 characters
- **íƒ€ì…:** .py

```python
# backend/app/models/marker.py
from sqlalchemy import Column, Integer, String, Text, DateTime, Float, Enum
from sqlalchemy.sql import func
from sqlalchemy.orm import relationship
import enum
from ..core.database import Base


class MarkerStatus(str, enum.Enum):
    PENDING = "pending"      # ì²˜ë¦¬ ëŒ€ê¸°
    PROGRESS = "progress"    # ì‘ì—… ì¤‘  
    COMPLETED = "completed"  # ì™„ë£Œ


class MarkerPriority(str, enum.Enum):
    URGENT = "urgent"        # ê¸´ê¸‰
    HIGH = "high"           # ë†’ìŒ
    NORMAL = "normal"       # ë³´í†µ


class IssueType(str, enum.Enum):
    POTHOLE = "pothole"           # ë°©ì‚¬ ê· ì—´
    CRACK = "crack"               # ë„ë¡œ ê· ì—´
    SIGN_DAMAGE = "sign_damage"   # í‘œì§€íŒ ì†ìƒ


class Marker(Base):
    __tablename__ = "markers"

    id = Column(Integer, primary_key=True, index=True)
    title = Column(String(255), nullable=False, index=True)
    description = Column(Text)
    
    # ìœ„ì¹˜ ì •ë³´
    latitude = Column(Float, nullable=False)
    longitude = Column(Float, nullable=False)
    address = Column(String(500))
    road_name = Column(String(255))
    
    # ë¶„ë¥˜ ì •ë³´
    issue_type = Column(Enum(IssueType), default=IssueType.CRACK)
    status = Column(Enum(MarkerStatus), default=MarkerStatus.PENDING)
    priority = Column(Enum(MarkerPriority), default=MarkerPriority.NORMAL)
    
    # ë‹´ë‹¹ì ë° ë“±ë¡ì
    assigned_to = Column(String(100))
    created_by = Column(String(100))
    
    # ì‹œê°„ ì •ë³´
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), onupdate=func.now())
    
    # ê´€ê³„ ì„¤ì •
    videos = relationship("Video", back_populates="marker", cascade="all, delete-orphan")
    analyses = relationship("Analysis", back_populates="marker", cascade="all, delete-orphan")
```

---

### 72. __init__.py

- **ê²½ë¡œ:** `backend/app/models/__init__.py`
- **í¬ê¸°:** 335 characters
- **íƒ€ì…:** .py

```python
from .marker import Marker, MarkerStatus, MarkerPriority, IssueType
from .video import Video  
from .analysis import Analysis, AnalysisStatus

# SQLAlchemy Base import
from ..core.database import Base

__all__ = [
    "Base",
    "Marker", "MarkerStatus", "MarkerPriority", "IssueType",
    "Video",
    "Analysis", "AnalysisStatus"
]

```

---

### 73. analysis.py

- **ê²½ë¡œ:** `backend/app/schemas/analysis.py`
- **í¬ê¸°:** 2,121 characters
- **íƒ€ì…:** .py

```python
from pydantic import BaseModel, Field
from datetime import datetime
from typing import Optional, Dict, Any, List
from ..models.analysis import AnalysisStatus


class CrackDetail(BaseModel):
    crack_id: str
    crack_type: str  # "íš¡ë°©í–¥", "ì¢…ë°©í–¥", "ë§ìƒ" ë“±
    length: float    # ë¯¸í„°
    width: float     # ë°€ë¦¬ë¯¸í„°
    area: float      # ì œê³±ë¯¸í„°
    severity: str    # "ìœ„í—˜", "ë³´í†µ", "ê²½ë¯¸"
    confidence: float # 0-1


class MaterialEstimation(BaseModel):
    asphalt_concrete: float  # í†¤
    sealer: float           # ë¦¬í„°
    primer: float           # ë¦¬í„°
    mesh: Optional[float] = None  # ì œê³±ë¯¸í„°
    total_cost: float       # ì›


class SeverityAnalysis(BaseModel):
    overall_severity: str   # "ìœ„í—˜", "ë³´í†µ", "ê²½ë¯¸"
    risk_score: float      # 0-100
    urgent_repairs_needed: bool
    estimated_repair_time: str  # "1ì¼", "3ì¼" ë“±


class AnalysisBase(BaseModel):
    marker_id: int
    video_id: int


class AnalysisCreate(AnalysisBase):
    pass


class AnalysisUpdate(BaseModel):
    status: Optional[AnalysisStatus] = None
    progress: Optional[float] = Field(None, ge=0, le=100)
    total_cracks_detected: Optional[int] = None
    total_crack_area: Optional[float] = None
    confidence_score: Optional[float] = Field(None, ge=0, le=1)
    crack_details: Optional[List[CrackDetail]] = None
    material_estimation: Optional[MaterialEstimation] = None
    severity_analysis: Optional[SeverityAnalysis] = None
    result_video_path: Optional[str] = None
    result_data_path: Optional[str] = None
    error_message: Optional[str] = None


class AnalysisResponse(AnalysisBase):
    id: int
    status: AnalysisStatus
    progress: float
    total_cracks_detected: int
    total_crack_area: float
    confidence_score: float
    crack_details: Optional[List[Dict[str, Any]]] = None
    material_estimation: Optional[Dict[str, Any]] = None
    severity_analysis: Optional[Dict[str, Any]] = None
    result_video_path: Optional[str] = None
    error_message: Optional[str] = None
    started_at: Optional[datetime] = None
    completed_at: Optional[datetime] = None
    created_at: datetime

    class Config:
        from_attributes = True

```

---

### 74. video.py

- **ê²½ë¡œ:** `backend/app/schemas/video.py`
- **í¬ê¸°:** 788 characters
- **íƒ€ì…:** .py

```python
from pydantic import BaseModel, Field
from datetime import datetime
from typing import Optional


class VideoBase(BaseModel):
    original_filename: str
    description: Optional[str] = None


class VideoCreate(VideoBase):
    filename: str
    file_path: str
    file_size: int
    marker_id: int
    uploaded_by: str
    duration: Optional[float] = None
    width: Optional[int] = None
    height: Optional[int] = None
    fps: Optional[float] = None


class VideoResponse(VideoBase):
    id: int
    filename: str
    file_size: int
    duration: Optional[float]
    width: Optional[int]
    height: Optional[int]
    fps: Optional[float]
    marker_id: int
    uploaded_by: str
    created_at: datetime
    has_analysis: bool = False

    class Config:
        from_attributes = True

```

---

### 75. marker.py

- **ê²½ë¡œ:** `backend/app/schemas/marker.py`
- **í¬ê¸°:** 2,031 characters
- **íƒ€ì…:** .py

```python
# backend/app/schemas/marker.py
from pydantic import BaseModel, Field
from datetime import datetime
from typing import Optional, List
from ..models.marker import MarkerStatus, MarkerPriority, IssueType


class MarkerBase(BaseModel):
    title: str = Field(..., min_length=1, max_length=255)
    description: Optional[str] = None
    latitude: float = Field(..., ge=-90, le=90)
    longitude: float = Field(..., ge=-180, le=180)
    address: Optional[str] = None
    road_name: Optional[str] = None
    issue_type: IssueType = IssueType.CRACK
    priority: MarkerPriority = MarkerPriority.NORMAL
    assigned_to: Optional[str] = None


class MarkerCreate(MarkerBase):
    created_by: str


class MarkerUpdate(BaseModel):
    title: Optional[str] = Field(None, min_length=1, max_length=255)
    description: Optional[str] = None
    status: Optional[MarkerStatus] = None
    priority: Optional[MarkerPriority] = None
    assigned_to: Optional[str] = None


class MarkerResponse(MarkerBase):
    id: int
    status: MarkerStatus
    created_by: str
    created_at: datetime
    updated_at: Optional[datetime]
    video_count: int = 0
    analysis_count: int = 0

    class Config:
        from_attributes = True


# backend/app/schemas/video.py
from pydantic import BaseModel, Field
from datetime import datetime
from typing import Optional


class VideoBase(BaseModel):
    original_filename: str
    description: Optional[str] = None


class VideoCreate(VideoBase):
    filename: str
    file_path: str
    file_size: int
    marker_id: int
    uploaded_by: str
    duration: Optional[float] = None
    width: Optional[int] = None
    height: Optional[int] = None
    fps: Optional[float] = None


class VideoResponse(VideoBase):
    id: int
    filename: str
    file_size: int
    duration: Optional[float]
    width: Optional[int]
    height: Optional[int]
    fps: Optional[float]
    marker_id: int
    uploaded_by: str
    created_at: datetime
    has_analysis: bool = False

    class Config:
        from_attributes = True


```

---

### 76. __init__.py

- **ê²½ë¡œ:** `backend/app/schemas/__init__.py`
- **í¬ê¸°:** 345 characters
- **íƒ€ì…:** .py

```python
from .marker import MarkerCreate, MarkerUpdate, MarkerResponse
from .video import VideoCreate, VideoResponse
from .analysis import AnalysisCreate, AnalysisUpdate, AnalysisResponse

__all__ = [
    "MarkerCreate", "MarkerUpdate", "MarkerResponse",
    "VideoCreate", "VideoResponse", 
    "AnalysisCreate", "AnalysisUpdate", "AnalysisResponse"
]

```

---

### 77. tsconfig.json

- **ê²½ë¡œ:** `frontend/tsconfig.json`
- **í¬ê¸°:** 627 characters
- **íƒ€ì…:** .json

```json
{
  "compilerOptions": {
    "target": "es5",
    "lib": [
      "dom",
      "dom.iterable",
      "es6"
    ],
    "allowJs": true,
    "skipLibCheck": true,
    "esModuleInterop": true,
    "allowSyntheticDefaultImports": true,
    "strict": true,
    "forceConsistentCasingInFileNames": true,
    "noFallthroughCasesInSwitch": true,
    "module": "esnext",
    "moduleResolution": "node",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "react-jsx",
    "baseUrl": "src",
    "paths": {
      "@/*": ["*"]
    }
  },
  "include": [
    "src",
    "src/types/naver-maps.d.ts"
  ]
}
```

---

### 78. sample_data.sql

- **ê²½ë¡œ:** `database/sample_data.sql`
- **í¬ê¸°:** 0 characters
- **íƒ€ì…:** .sql

```sql

```

---

### 79. init.sql

- **ê²½ë¡œ:** `database/init.sql`
- **í¬ê¸°:** 0 characters
- **íƒ€ì…:** .sql

```sql

```

---

### 80. README.md

- **ê²½ë¡œ:** `README.md`
- **í¬ê¸°:** 865 characters
- **íƒ€ì…:** .md

```markdown
# ë„ë¡œ ìœ ì§€ë³´ìˆ˜ ê´€ë¦¬ ì‹œìŠ¤í…œ

YOLO ê¸°ë°˜ AI ê· ì—´ ê²€ì¶œì„ í™œìš©í•œ ë„ë¡œ ìœ ì§€ë³´ìˆ˜ ê´€ë¦¬ ì‹œìŠ¤í…œ

## ê¸°ìˆ  ìŠ¤íƒ
- Frontend: React + TypeScript + Tailwind CSS
- Backend: FastAPI + SQLAlchemy + PostgreSQL
- AI: YOLO (Ultralytics)
- Map: Naver Maps API

## ì‹œì‘í•˜ê¸°

### 1. í™˜ê²½ë³€ìˆ˜ ì„¤ì •
```bash
# Backend í™˜ê²½ë³€ìˆ˜
cp backend/.env.example backend/.env
# Frontend í™˜ê²½ë³€ìˆ˜  
cp frontend/.env.local.example frontend/.env.local
```

### 2. Dockerë¡œ ì‹¤í–‰
```bash
docker-compose up --build
```

### 3. ê°œë³„ ì‹¤í–‰
```bash
# Backend
cd backend
source venv/bin/activate
uvicorn app.main:app --reload

# Frontend
cd frontend
npm start
```

## API ë¬¸ì„œ
- Backend API: http://localhost:8000/docs
- Frontend: http://localhost:3000

## ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
road-maintenance-system/
â”œâ”€â”€ frontend/          # React í”„ë¡ íŠ¸ì—”ë“œ
â”œâ”€â”€ backend/           # FastAPI ë°±ì—”ë“œ
â”œâ”€â”€ database/          # DB ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ ai_model/          # AI ëª¨ë¸ íŒŒì¼
â””â”€â”€ uploads/           # ì—…ë¡œë“œëœ íŒŒì¼ë“¤
```

```

---

### 81. README.md

- **ê²½ë¡œ:** `frontend/README.md`
- **í¬ê¸°:** 2,103 characters
- **íƒ€ì…:** .md

```markdown
# Getting Started with Create React App

This project was bootstrapped with [Create React App](https://github.com/facebook/create-react-app).

## Available Scripts

In the project directory, you can run:

### `npm start`

Runs the app in the development mode.\
Open [http://localhost:3000](http://localhost:3000) to view it in the browser.

The page will reload if you make edits.\
You will also see any lint errors in the console.

### `npm test`

Launches the test runner in the interactive watch mode.\
See the section about [running tests](https://facebook.github.io/create-react-app/docs/running-tests) for more information.

### `npm run build`

Builds the app for production to the `build` folder.\
It correctly bundles React in production mode and optimizes the build for the best performance.

The build is minified and the filenames include the hashes.\
Your app is ready to be deployed!

See the section about [deployment](https://facebook.github.io/create-react-app/docs/deployment) for more information.

### `npm run eject`

**Note: this is a one-way operation. Once you `eject`, you canâ€™t go back!**

If you arenâ€™t satisfied with the build tool and configuration choices, you can `eject` at any time. This command will remove the single build dependency from your project.

Instead, it will copy all the configuration files and the transitive dependencies (webpack, Babel, ESLint, etc) right into your project so you have full control over them. All of the commands except `eject` will still work, but they will point to the copied scripts so you can tweak them. At this point youâ€™re on your own.

You donâ€™t have to ever use `eject`. The curated feature set is suitable for small and middle deployments, and you shouldnâ€™t feel obligated to use this feature. However we understand that this tool wouldnâ€™t be useful if you couldnâ€™t customize it when you are ready for it.

## Learn More

You can learn more in the [Create React App documentation](https://facebook.github.io/create-react-app/docs/getting-started).

To learn React, check out the [React documentation](https://reactjs.org/).

```

---

